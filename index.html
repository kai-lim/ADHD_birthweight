<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Kai Lim" />
    
        <meta name="date" content="2021-01-07" />
    
    <title>The role of birth weight on the causal pathway to child and adolescent ADHD symptomatology</title>

        <script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
        <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <script src="site_libs/navigation-1.1/codefolding.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("show" === "show");
	        });
    </script>
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
      <div class="btn-group pull-right">
     <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
     <ul class="dropdown-menu" style="min-width: 50px;">
	    	    <li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
	    <li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
	    	    	         </ul>
   </div>
   
        
      <h1 class="title">The role of birth weight on the causal pathway to child and adolescent ADHD symptomatology</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">The role of birth weight on the causal pathway to child and adolescent ADHD symptomatology</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#housekeeping">Housekeeping</a></li>
      <li><a href="#descriptive-statistics">Descriptive statistics</a>
      <ul>
      <li><a href="#table-s3">Table S3</a></li>
      <li><a href="#total-n-of-twins">Total N of twins</a></li>
      <li><a href="#more-descriptive-stats">More descriptive stats</a></li>
      <li><a href="#table-s1">Table S1</a></li>
      <li><a href="#n-of-twins-in-each-scale">N of twins in each scale</a></li>
      </ul></li>
      <li><a href="#twin-differences-analyses">Twin differences analyses</a>
      <ul>
      <li><a href="#main-twin-difference-syntax">Main twin difference syntax</a></li>
      <li><a href="#unstandardised-estimates-1kg-to-x-symptoms">Unstandardised estimates (1kg to x symptoms)</a></li>
      </ul></li>
      <li><a href="#latent-growth-models-lgm">Latent growth models (LGM)</a>
      <ul>
      <li><a href="#split-twins">Split twins</a></li>
      <li><a href="#development-of-lgm-syntax">Development of LGM Syntax</a>
      <ul>
      <li><a href="#linear-model">Linear Model</a></li>
      <li><a href="#quadratic-model">Quadratic Model</a></li>
      <li><a href="#constrained-quadratic-model">Constrained Quadratic Model</a></li>
      <li><a href="#inversed-slope-model">Inversed Slope Model</a></li>
      <li><a href="#model-for-end-intercept">Model for End Intercept</a></li>
      <li><a href="#plot-graph">Plot Graph</a></li>
      <li><a href="#constraining-slopes">Constraining Slopes</a></li>
      </ul></li>
      <li><a href="#final-lgm-syntax-used">Final LGM Syntax Used</a></li>
      </ul></li>
      <li><a href="#sensitivity-analyses">Sensitivity analyses</a>
      <ul>
      <li><a href="#satorra-bentler-test">Satorra-Bentler Test</a></li>
      <li><a href="#sex-moderation-analyses">Sex moderation analyses</a></li>
      <li><a href="#gestational-age-moderation">Gestational age moderation</a></li>
      <li><a href="#lbw-moderation">LBW moderation</a></li>
      <li><a href="#vlbw-exclusion">VLBW exclusion</a></li>
      </ul></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Kai Lim</p>
                        <p class="date"><span class="glyphicon glyphicon-calendar"></span> 01/07/2021</p>
          </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<p>This document contains scripts used for <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6175300/pdf/JCPP-59-1036.pdf">this paper</a> that investigates the role of birth weight in ADHD development using twin data.</p>
<div id="housekeeping" class="section level1">
<h1>Housekeeping</h1>
<p>Loading the libraries, read the data, recode zygosity.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prettyR)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(polycor)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GPArotation)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psy)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(base)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print=</span><span class="dv">100000</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="co">#set pseudo-random number generation to ensure bootstrapping results (confidence intervals can be reproduced)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>adhddata<span class="ot">=</span><span class="fu">read.spss</span>(filepath ,<span class="at">use.value.labels=</span>F, <span class="at">to.data.frame=</span>T)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#recode zygosity</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>zygosL<span class="ot">=</span><span class="cn">NA</span>; </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>zygosL <span class="ot">&lt;-</span> <span class="fu">factor</span>(adhddata<span class="sc">$</span>zygos, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;MZ&quot;</span>, <span class="st">&quot;DZ&quot;</span>))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#check numbers after recode</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(adhddata<span class="sc">$</span>zygos,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>);<span class="fu">table</span>(adhddata<span class="sc">$</span>zygosL,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>);</span></code></pre></div>
<p>For SDQ measures with &lt; 3000 twin pairs (teacher’s ratings and self-report), to increase the statistical power, we decided to pool the SDQ measures across different ages and get a mean value.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### &gt;&gt; 0. mean sdq to pool sdq with data points &lt;3000 twin pairs#######</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#create mean values for SDQ (teacher-rated) at age 7,9 and 12 - newtsdq1/2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>newtsdq1<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sdqt1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;gtshypt1&quot;</span>,<span class="st">&quot;itshypt1&quot;</span>,<span class="st">&quot;ltshypt1&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>newtsdq1<span class="ot">=</span><span class="fu">rowMeans</span>(adhddata[,sdqt1],<span class="at">na.rm=</span>T)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>((adhddata<span class="sc">$</span>newtsdq1)),<span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.nan</span>((adhddata<span class="sc">$</span>newtsdq1)),<span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>newtsdq2<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>sdqt2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;gtshypt2&quot;</span>,<span class="st">&quot;itshypt2&quot;</span>,<span class="st">&quot;ltshypt2&quot;</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>newtsdq2<span class="ot">=</span><span class="fu">rowMeans</span>(adhddata[,sdqt2],<span class="at">na.rm=</span>T)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>((adhddata<span class="sc">$</span>newtsdq2)),<span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.nan</span>((adhddata<span class="sc">$</span>newtsdq2)),<span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#create mean values for SDQ (self-rated) at age 9, 12 and 16 - newcsdq1/2</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>newcsdq1<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>sdqc1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;icshypt1&quot;</span>,<span class="st">&quot;lcshypt1&quot;</span>,<span class="st">&quot;pcbhsdqhypt1&quot;</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>newcsdq1<span class="ot">=</span><span class="fu">rowMeans</span>(adhddata[,sdqc1],<span class="at">na.rm=</span>T)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>((adhddata<span class="sc">$</span>newcsdq1)),<span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.nan</span>((adhddata<span class="sc">$</span>newcsdq1)),<span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>newcsdq2<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>sdqc2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;icshypt2&quot;</span>,<span class="st">&quot;lcshypt2&quot;</span>,<span class="st">&quot;pcbhsdqhypt2&quot;</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>newcsdq2<span class="ot">=</span><span class="fu">rowMeans</span>(adhddata[,sdqc2],<span class="at">na.rm=</span>T)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>((adhddata<span class="sc">$</span>newcsdq2)),<span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.nan</span>((adhddata<span class="sc">$</span>newcsdq2)),<span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<p>Create a vector to store all the variables we used. The first two variables were birthweight of twin 1 and twin 2, whereas the rest of the variables were ADHD measures at different time points by different raters. As a rule of thumb, the first alphabet refers to the age in alphabetical order, e.g. a = age 1 years, b = age 2 years.</p>
<p><a href="https://www.teds.ac.uk/datadictionary/home.htm">TEDS data dictionary</a> will have more information about these variables. You can navigate the left panel to different ages, and click on “Measures used in the booklets” to see the details.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>VecOutcomes<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;arkidgr1&quot;</span>,<span class="st">&quot;arkidgr2&quot;</span>, <span class="co"># birthweight</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;bbhhypt1&quot;</span>, <span class="st">&quot;bbhhypt2&quot;</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;cbhhypt1&quot;</span>,<span class="st">&quot;cbhhypt2&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;dbhhypt1&quot;</span>,<span class="st">&quot;dbhhypt2&quot;</span>,                      </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;dsdhypt1&quot;</span>,<span class="st">&quot;dsdhypt2&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;gpshypt1&quot;</span>,<span class="st">&quot;gpshypt2&quot;</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;hconnt1&quot;</span>,<span class="st">&quot;hconnt2&quot;</span>, <span class="st">&quot;hconhit1&quot;</span>, <span class="st">&quot;hconhit2&quot;</span>,<span class="st">&quot;hconint1&quot;</span>,<span class="st">&quot;hconint2&quot;</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;ipshypt1&quot;</span>,<span class="st">&quot;ipshypt2&quot;</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;lpshypt1&quot;</span>,<span class="st">&quot;lpshypt2&quot;</span>, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;lpconnt1&quot;</span>,<span class="st">&quot;lpconnt2&quot;</span>,<span class="st">&quot;lpconhit1&quot;</span>,<span class="st">&quot;lpconhit2&quot;</span>,<span class="st">&quot;lpconint1&quot;</span>,<span class="st">&quot;lpconint2&quot;</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;npconnt1&quot;</span>,<span class="st">&quot;npconnt2&quot;</span>,<span class="st">&quot;npconhit1&quot;</span>, <span class="st">&quot;npconhit2&quot;</span>, <span class="st">&quot;npconint1&quot;</span>, <span class="st">&quot;npconint2&quot;</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;ppbhsdqhypt1&quot;</span>,<span class="st">&quot;ppbhsdqhypt2&quot;</span>, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;ppbhconnt1&quot;</span>, <span class="st">&quot;ppbhconnt2&quot;</span>, <span class="st">&quot;ppbhconnimpt1&quot;</span>, <span class="st">&quot;ppbhconnimpt2&quot;</span>, <span class="st">&quot;ppbhconninat1&quot;</span>, <span class="st">&quot;ppbhconninat2&quot;</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;newcsdq1&quot;</span>,<span class="st">&quot;newcsdq2&quot;</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;newtsdq1&quot;</span>,<span class="st">&quot;newtsdq2&quot;</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># newtsdq1/2 = mean of teacher-rated sdq at 3 ages </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># newcsdq1/2 = mean of chid-rated sdq at 3 ages</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#create new name for dataframe</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>adhddatal<span class="ot">=</span>adhddata</span></code></pre></div>
</div>
<div id="descriptive-statistics" class="section level1">
<h1>Descriptive statistics</h1>
<div id="table-s3" class="section level2">
<h2>Table S3</h2>
<p>The code chunk below produces the descriptive statistics (Table S3)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">################### &gt;&gt;&gt;&gt;&gt; 1. Descriptive statistics ################</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>DesLoop<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(VecOutcomes),<span class="at">ncol=</span><span class="dv">20</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes),<span class="at">by=</span><span class="dv">2</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define outcomes</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  adhddatal[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>;</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  adhddatal[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>adhddatal[,<span class="fu">c</span>(VecOutcomes[i],VecOutcomes[i<span class="sc">+</span><span class="dv">1</span>])]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  adhddatalc<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>XD2)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a> <span class="co"># adhddatalc = all MZ and DZ twins excluding those with medical conditions, without BW or ADHD data, unknown sex and unknown zygosity.  </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select random</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  adhddatalrc<span class="ot">=</span>adhddatalc[adhddatalc<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">table</span>(adhddatalrc<span class="sc">$</span>sexzyg, <span class="at">useNA=</span><span class="st">&quot;always&quot;</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  wholesample<span class="ot">=</span>a[<span class="dv">1</span>]<span class="sc">+</span>a[<span class="dv">2</span>]<span class="sc">+</span>a[<span class="dv">3</span>]<span class="sc">+</span>a[<span class="dv">4</span>]<span class="sc">+</span>a[<span class="dv">5</span>]</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  DZsample<span class="ot">=</span>a[<span class="dv">2</span>]<span class="sc">+</span>a[<span class="dv">4</span>]<span class="sc">+</span>a[<span class="dv">5</span>]</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  DZsamesex<span class="ot">=</span>a[<span class="dv">2</span>]<span class="sc">+</span>a[<span class="dv">4</span>]</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  MZsample<span class="ot">=</span>a[<span class="dv">1</span>]<span class="sc">+</span>a[<span class="dv">3</span>]</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#whole sample</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  wholemean<span class="ot">=</span><span class="fu">mean</span>(adhddatalc<span class="sc">$</span>XD1)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  wholemean</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  wholesd<span class="ot">=</span><span class="fu">sd</span>(adhddatalc<span class="sc">$</span>XD1)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  wholeskew<span class="ot">=</span><span class="fu">skewness</span>(adhddatalc<span class="sc">$</span>XD1)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  wholekurtosis<span class="ot">=</span><span class="fu">kurtosis</span>(adhddatalc<span class="sc">$</span>XD1)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>   <span class="co">#DZ sample</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  adhddataDZ<span class="ot">=</span>adhddatalc[adhddatalc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;DZ&quot;</span>,]</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  DZmean<span class="ot">=</span><span class="fu">mean</span>(adhddataDZ<span class="sc">$</span>XD1)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  DZsd<span class="ot">=</span><span class="fu">sd</span>(adhddataDZ<span class="sc">$</span>XD1)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  DZskew<span class="ot">=</span><span class="fu">skewness</span>(adhddataDZ<span class="sc">$</span>XD1)</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  DZkurtosis<span class="ot">=</span><span class="fu">kurtosis</span>(adhddataDZ<span class="sc">$</span>XD1)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#DZ same sex</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  adhddataDZsame<span class="ot">=</span>adhddataDZ[adhddataDZ<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddataDZ<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span>,]</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  DZsamemean<span class="ot">=</span><span class="fu">mean</span>(adhddataDZsame<span class="sc">$</span>XD1)</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  DZsamesd<span class="ot">=</span><span class="fu">sd</span>(adhddataDZsame<span class="sc">$</span>XD1)</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  DZsameskew<span class="ot">=</span><span class="fu">skewness</span>(adhddataDZsame<span class="sc">$</span>XD2)</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  DZsamekurtosis<span class="ot">=</span><span class="fu">kurtosis</span>(adhddataDZsame<span class="sc">$</span>XD2)</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#MZ sample</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  adhddataMZ<span class="ot">=</span>adhddatalc[adhddatalc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,]</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  MZmean<span class="ot">=</span><span class="fu">mean</span>(adhddataMZ<span class="sc">$</span>XD1)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  MZsd<span class="ot">=</span><span class="fu">sd</span>(adhddataMZ<span class="sc">$</span>XD1)</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  MZskew<span class="ot">=</span><span class="fu">skewness</span>(adhddataMZ<span class="sc">$</span>XD2)</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  MZkurtosis<span class="ot">=</span><span class="fu">kurtosis</span>(adhddataMZ<span class="sc">$</span>XD2)</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Mean, SD, Kurtosis and Skew for all twins,  MZ twins , DZ twins and DZ same-sex twins</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  VecRes<span class="ot">=</span><span class="fu">c</span>(wholemean,wholesd,wholeskew,wholekurtosis,DZmean,DZsd,DZskew,DZkurtosis,</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>           DZsamemean,DZsamesd, DZsameskew,DZsamekurtosis,</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>           MZmean,MZsd,MZskew,MZkurtosis,wholesample,DZsample,DZsamesex,MZsample)</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>  DesLoop[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]<span class="ot">=</span>VecRes</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(DesLoop)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;wholemean&quot;</span>,<span class="st">&quot;wholesd&quot;</span>,<span class="st">&quot;wholeskew&quot;</span>,<span class="st">&quot;wholekurtosis&quot;</span>,<span class="st">&quot;DZmean&quot;</span>,<span class="st">&quot;DZsd&quot;</span>,<span class="st">&quot;DZskew&quot;</span>,<span class="st">&quot;DZkurtosis&quot;</span>,</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;DZsamemean&quot;</span>,<span class="st">&quot;DZsamesd&quot;</span>,<span class="st">&quot;DZsameskew&quot;</span>,<span class="st">&quot;DZsamekurtosis&quot;</span>,<span class="st">&quot;MZmean&quot;</span>,<span class="st">&quot;MZsd&quot;</span>, <span class="st">&quot;MZskew&quot;</span>,<span class="st">&quot;MZkurtosis&quot;</span>,</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;wholesample&quot;</span>,<span class="st">&quot;DZsample&quot;</span>,<span class="st">&quot;DZsamesex&quot;</span>,<span class="st">&quot;MZsample&quot;</span>)</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(DesLoop)<span class="ot">=</span>VecOutcomes</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>DesLoop<span class="ot">=</span><span class="fu">round</span>(DesLoop[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes),<span class="at">by=</span><span class="dv">2</span>),],<span class="dv">2</span>)</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>DesLoop</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="co">#export to excel file</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(DesLoop,<span class="st">&quot;Revision-Newdataset descriptive statistics.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="total-n-of-twins" class="section level2">
<h2>Total N of twins</h2>
<p>This code chunk calculates the total number of twins involved to report in the Methods section: The final sample included 10,197 twin pairs (6,698 DZ pairs, 3,499 MZ pairs, 51.2% females).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################### 1.1 To calculate total number of twins involved ###################################</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#previous loop cannot calculate total number of twins in all analyses, only number of twins in each analysis. </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#this step is to calculate total number of twin pairs involved.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>totaltwins<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                         ((<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconnt2))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit2))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint2))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>bbhhypt1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>bbhhypt2))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>cbhhypt1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>cbhhypt2))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>dbhhypt1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>dbhhypt2))  </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconnt2))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit2))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint2))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>dsdhypt1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>dsdhypt2))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>gpshypt1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>gpshypt2))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ipshypt1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ipshypt2))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpshypt1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpshypt2))</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhsdqhypt1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhsdqhypt2))</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconnt2))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit2))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint2))</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnt2))</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt2))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat2))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>newcsdq1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>newcsdq2))</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>newtsdq1)<span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>newtsdq2)))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">&amp;</span> adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span> <span class="co">#0= not excluded</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co">#sexzyg 1=MZ male, 2=DZ male, 3=MZ female, 4=DZ female, 5= opposite sexes DZ, 7=unknown.</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co">#try changing exlude=&quot;1&quot;, get total twins excluded from analysis due to medical condition. Number = 689 twin pairs. </span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co">#arkiddr1/2 and akidgr1/2 difference = 28 individuals = 14 twin pairs. </span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>totaltwinsr<span class="ot">=</span>totaltwins[totaltwins<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,] <span class="co">#10,197 twin pairs, 3499 MZ, 6698 DZ</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(totaltwinsr<span class="sc">$</span>zygosL)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(totaltwinsr<span class="sc">$</span>sexzyg, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(totaltwins<span class="sc">$</span>sexzyg,<span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
</div>
<div id="more-descriptive-stats" class="section level2">
<h2>More descriptive stats</h2>
<p>Some check on the mean birth weight and within-twin pair correlation, and mean difference in birth weight.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">####### 1.2 mean birth weight and within-twin pair correlation and mean difference in birth weight ################</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#mean birth weights of boys and girls</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>boys<span class="ot">=</span>totaltwins[totaltwins<span class="sc">$</span>sex1<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>girls<span class="ot">=</span>totaltwins[totaltwins<span class="sc">$</span>sex1<span class="sc">==</span><span class="dv">0</span>,]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(boys<span class="sc">$</span>sex1)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(girls<span class="sc">$</span>sex1)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(boys<span class="sc">$</span>arkidgr1, <span class="at">na.rm =</span> T)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(girls<span class="sc">$</span>arkidgr1, <span class="at">na.rm =</span> T)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#double check using sex2 column. </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>boys2<span class="ot">=</span>totaltwins[totaltwins<span class="sc">$</span>sex2<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>girls2<span class="ot">=</span>totaltwins[totaltwins<span class="sc">$</span>sex2<span class="sc">==</span><span class="dv">0</span>,]</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(boys2<span class="sc">$</span>arkidgr2, <span class="at">na.rm =</span> T)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(girls2<span class="sc">$</span>arkidgr2, <span class="at">na.rm=</span>T)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># BW within-twin correlations for MZ and DZ same-sex twins. </span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>totalmz<span class="ot">=</span>totaltwinsr[totaltwinsr<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,]</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(totalmz<span class="sc">$</span>zygosL)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(totalmz<span class="sc">$</span>arkidgr1, totalmz<span class="sc">$</span>arkidgr2)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(totalmz<span class="sc">$</span>arkidgr1, totalmz<span class="sc">$</span>arkidgr2, <span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>totaldzss<span class="ot">=</span>totaltwinsr[(totaltwinsr<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="dv">2</span><span class="sc">|</span>totaltwinsr<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="dv">4</span>),] <span class="co">#DZ same sex twins</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(totaldzss<span class="sc">$</span>sexzyg)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(totaldzss<span class="sc">$</span>arkidgr1, totaldzss<span class="sc">$</span>arkidgr2)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(totaldzss<span class="sc">$</span>arkidgr1, totaldzss<span class="sc">$</span>arkidgr2, <span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(totalmz<span class="sc">$</span>arkidgr1);<span class="fu">mean</span>(totalmz<span class="sc">$</span>arkidgr2)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(totalmz<span class="sc">$</span>arkidgr1<span class="sc">-</span>totalmz<span class="sc">$</span>arkidgr2))</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(totaldzss<span class="sc">$</span>arkidgr1);<span class="fu">mean</span>(totaldzss<span class="sc">$</span>arkidgr2) <span class="co"># DZ twins slightly heavier, but may be due to sex composition</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(totaldzss<span class="sc">$</span>arkidgr1<span class="sc">-</span>totaldzss<span class="sc">$</span>arkidgr2))</span></code></pre></div>
</div>
<div id="table-s1" class="section level2">
<h2>Table S1</h2>
<p>This code chunk was used to produce Table S1</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">####################### 1.3 Study sample description########################</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#read job and maternal educ variable</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>ajob<span class="ot">=</span><span class="fu">read.spss</span>(<span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Kai Xiang Lim</span><span class="sc">\\</span><span class="st">2016-2017 Psychology</span><span class="sc">\\</span><span class="st">Dissertation</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">ajob.sav&quot;</span>,<span class="at">use.value.labels=</span>F, <span class="at">to.data.frame=</span>T)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>ajob<span class="ot">=</span>ajob[,<span class="fu">c</span>(<span class="st">&quot;id_twin&quot;</span>,<span class="st">&quot;amojob&quot;</span>,<span class="st">&quot;afajob&quot;</span>)]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>totaltwins<span class="ot">=</span><span class="fu">merge</span>(totaltwins,ajob,<span class="at">by=</span><span class="st">&quot;id_twin&quot;</span>,<span class="at">all.x=</span>T)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>maternaleduc<span class="ot">=</span><span class="fu">read.spss</span>(<span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Kai Xiang Lim</span><span class="sc">\\</span><span class="st">Google Drive</span><span class="sc">\\</span><span class="st">2016-2017 Psychology</span><span class="sc">\\</span><span class="st">Dissertation</span><span class="sc">\\</span><span class="st">data</span><span class="sc">\\</span><span class="st">maternaleduc.sav&quot;</span>,<span class="at">use.value.labels=</span>F, <span class="at">to.data.frame=</span>T)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>maternaleduc<span class="ot">=</span>maternaleduc[,<span class="fu">c</span>(<span class="st">&quot;id_twin&quot;</span>,<span class="st">&quot;amohqual&quot;</span>,<span class="st">&quot;afahqual&quot;</span>)]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>totaltwins<span class="ot">=</span><span class="fu">merge</span>(totaltwins,maternaleduc,<span class="at">by=</span><span class="st">&quot;id_twin&quot;</span>,<span class="at">all.x=</span>T)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(totaltwins<span class="sc">$</span>amohqual.x,totaltwins<span class="sc">$</span>amohqual.y)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#DESCRIPTION</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(totaltwins<span class="sc">$</span>aethnic)) <span class="co">#1=white, 0=other, 92.9% white</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(totaltwins<span class="sc">$</span>amohqual.x))<span class="co">#eductation description in 8 categories</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(totaltwins<span class="sc">$</span>amohqual.y))<span class="co">#eductation description in 8 categories</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(totaltwins<span class="sc">$</span>amohqual.x))[<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>])<span class="co">#A-levels or higher for women, 37.7%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(totaltwins<span class="sc">$</span>amohqual.y))[<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>])<span class="co">#A-levels or higher for women, 37.7%</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(totaltwins<span class="sc">$</span>amojob)) <span class="co">#0=no, 1=yes, 2= caring at home 44.3%</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(totaltwins<span class="sc">$</span>afajob)) <span class="co">#0=no, 1=yes, 2= caring at home 92.4%</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(totaltwins<span class="sc">$</span>sex1))  <span class="co">#0=female, 1=male, female 51.2%</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(totaltwins<span class="sc">$</span>zygos)) <span class="co">#1=MZ, 2=DZ, MZ 34.3%</span></span></code></pre></div>
</div>
<div id="n-of-twins-in-each-scale" class="section level2">
<h2>N of twins in each scale</h2>
<p>This code chunk was used to calculate the number of twins in each scale. Reported in Table 1 and Table S3.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">######## 1.4 Loop for number of twins in each scale/age ########</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#This loop will return a table of number of twins (Total, MZ, DZ Same sex) in each scale at each time point.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#VecOutcomes were defined above, but printing here again to ease readability.</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>VecOutcomes<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;arkidgr1&quot;</span>,<span class="st">&quot;arkidgr2&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;bbhhypt1&quot;</span>, <span class="st">&quot;bbhhypt2&quot;</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;cbhhypt1&quot;</span>,<span class="st">&quot;cbhhypt2&quot;</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;dbhhypt1&quot;</span>,<span class="st">&quot;dbhhypt2&quot;</span>,                      </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;dsdhypt1&quot;</span>,<span class="st">&quot;dsdhypt2&quot;</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;gpshypt1&quot;</span>,<span class="st">&quot;gpshypt2&quot;</span>, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;hconnt1&quot;</span>,<span class="st">&quot;hconnt2&quot;</span>, <span class="st">&quot;hconhit1&quot;</span>, <span class="st">&quot;hconhit2&quot;</span>,<span class="st">&quot;hconint1&quot;</span>,<span class="st">&quot;hconint2&quot;</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;ipshypt1&quot;</span>,<span class="st">&quot;ipshypt2&quot;</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;lpshypt1&quot;</span>,<span class="st">&quot;lpshypt2&quot;</span>, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;lpconnt1&quot;</span>,<span class="st">&quot;lpconnt2&quot;</span>,<span class="st">&quot;lpconhit1&quot;</span>,<span class="st">&quot;lpconhit2&quot;</span>,<span class="st">&quot;lpconint1&quot;</span>,<span class="st">&quot;lpconint2&quot;</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;npconnt1&quot;</span>,<span class="st">&quot;npconnt2&quot;</span>,<span class="st">&quot;npconhit1&quot;</span>, <span class="st">&quot;npconhit2&quot;</span>, <span class="st">&quot;npconint1&quot;</span>, <span class="st">&quot;npconint2&quot;</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;ppbhsdqhypt1&quot;</span>,<span class="st">&quot;ppbhsdqhypt2&quot;</span>, </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;ppbhconnt1&quot;</span>, <span class="st">&quot;ppbhconnt2&quot;</span>, <span class="st">&quot;ppbhconnimpt1&quot;</span>, <span class="st">&quot;ppbhconnimpt2&quot;</span>, <span class="st">&quot;ppbhconninat1&quot;</span>, <span class="st">&quot;ppbhconninat2&quot;</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;newcsdq1&quot;</span>,<span class="st">&quot;newcsdq2&quot;</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;newtsdq1&quot;</span>,<span class="st">&quot;newtsdq2&quot;</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(VecOutcomes),<span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes),<span class="at">by=</span><span class="dv">2</span>))</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  adhddatal<span class="ot">=</span>adhddata</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define outcomes</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  adhddatal[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>;</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  adhddatal[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>adhddatal[,<span class="fu">c</span>(VecOutcomes[i],VecOutcomes[i<span class="sc">+</span><span class="dv">1</span>])]</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  adhddatalc<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>XD2)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select random</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  adhddatalrc<span class="ot">=</span>adhddatalc[adhddatalc<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">table</span>(adhddatalrc<span class="sc">$</span>sexzyg, <span class="at">useNA=</span><span class="st">&quot;always&quot;</span>)</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  wholesample<span class="ot">=</span>a[<span class="dv">1</span>]<span class="sc">+</span>a[<span class="dv">2</span>]<span class="sc">+</span>a[<span class="dv">3</span>]<span class="sc">+</span>a[<span class="dv">4</span>]<span class="sc">+</span>a[<span class="dv">5</span>]</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  DZsample<span class="ot">=</span>a[<span class="dv">2</span>]<span class="sc">+</span>a[<span class="dv">4</span>]<span class="sc">+</span>a[<span class="dv">5</span>]</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  DZsamesex<span class="ot">=</span>a[<span class="dv">2</span>]<span class="sc">+</span>a[<span class="dv">4</span>]</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  MZsample<span class="ot">=</span>a[<span class="dv">1</span>]<span class="sc">+</span>a[<span class="dv">3</span>]</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(prettyR)</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#whole sample</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  wholemean<span class="ot">=</span><span class="fu">mean</span>(adhddatalrc<span class="sc">$</span>XD1)</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  wholemean</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  wholesd<span class="ot">=</span><span class="fu">sd</span>(adhddatalrc<span class="sc">$</span>XD1)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>  <span class="co">#DZ sample</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  adhddataDZ<span class="ot">=</span>adhddatalrc[adhddatalrc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;DZ&quot;</span>,]</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  DZmean<span class="ot">=</span><span class="fu">mean</span>(adhddataDZ<span class="sc">$</span>XD1)</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  DZsd<span class="ot">=</span><span class="fu">sd</span>(adhddataDZ<span class="sc">$</span>XD1)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#DZ same sex</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  adhddataDZsame<span class="ot">=</span>adhddataDZ[adhddataDZ<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddataDZ<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span>,]</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>  DZsamemean<span class="ot">=</span><span class="fu">mean</span>(adhddataDZsame<span class="sc">$</span>XD1)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  DZsamesd<span class="ot">=</span><span class="fu">sd</span>(adhddataDZsame<span class="sc">$</span>XD1)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>  <span class="co">#MZ sample</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  adhddataMZ<span class="ot">=</span>adhddatalrc[adhddatalrc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,]</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>  MZmean<span class="ot">=</span><span class="fu">mean</span>(adhddataMZ<span class="sc">$</span>XD1)</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>  MZsd<span class="ot">=</span><span class="fu">sd</span>(adhddataMZ<span class="sc">$</span>XD1)</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>  VecRes<span class="ot">=</span><span class="fu">c</span>(wholesample,DZsample,DZsamesex,MZsample)</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>  ResultsLoop[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]<span class="ot">=</span>VecRes</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ResultsLoop)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;wholesample&quot;</span>,<span class="st">&quot;DZsample&quot;</span>,<span class="st">&quot;DZsamesex&quot;</span>,<span class="st">&quot;MZsample&quot;</span>)</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ResultsLoop)<span class="ot">=</span>VecOutcomes</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">round</span>(ResultsLoop[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes),<span class="at">by=</span><span class="dv">2</span>),],<span class="dv">2</span>)</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(ResultsLoop,<span class="st">&quot;number of twins in each scale.xlsx&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="twin-differences-analyses" class="section level1">
<h1>Twin differences analyses</h1>
<div id="main-twin-difference-syntax" class="section level2">
<h2>Main twin difference syntax</h2>
<p>I think this is the more exciting part, the code chunks in this section will produce the phenotypic, DZ and MZ estimates reported in Table 1 and Figure 2.</p>
<p>Some commands which are commented out in the loop were used to inspect what happened line-by-line inside the loop when I developed the syntax.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">######## &gt;&gt;&gt;&gt;&gt; 2.0 Phenotypic, MZ and DZ estimates ##################</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">#####  2.1 Standardised estimates (diff in 1 sd of BW predicts diff in sd of ADHD ratings) #######</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#list of outcomes. Same as defined above, printed here again to ease readability.</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>VecOutcomes<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;arkidgr1&quot;</span>,<span class="st">&quot;arkidgr2&quot;</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;bbhhypt1&quot;</span>, <span class="st">&quot;bbhhypt2&quot;</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;cbhhypt1&quot;</span>,<span class="st">&quot;cbhhypt2&quot;</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;dbhhypt1&quot;</span>,<span class="st">&quot;dbhhypt2&quot;</span>,                      </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;dsdhypt1&quot;</span>,<span class="st">&quot;dsdhypt2&quot;</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;gpshypt1&quot;</span>,<span class="st">&quot;gpshypt2&quot;</span>, </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;hconnt1&quot;</span>,<span class="st">&quot;hconnt2&quot;</span>, <span class="st">&quot;hconhit1&quot;</span>, <span class="st">&quot;hconhit2&quot;</span>,<span class="st">&quot;hconint1&quot;</span>,<span class="st">&quot;hconint2&quot;</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;ipshypt1&quot;</span>,<span class="st">&quot;ipshypt2&quot;</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;lpshypt1&quot;</span>,<span class="st">&quot;lpshypt2&quot;</span>, </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;lpconnt1&quot;</span>,<span class="st">&quot;lpconnt2&quot;</span>,<span class="st">&quot;lpconhit1&quot;</span>,<span class="st">&quot;lpconhit2&quot;</span>,<span class="st">&quot;lpconint1&quot;</span>,<span class="st">&quot;lpconint2&quot;</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;npconnt1&quot;</span>,<span class="st">&quot;npconnt2&quot;</span>,<span class="st">&quot;npconhit1&quot;</span>, <span class="st">&quot;npconhit2&quot;</span>, <span class="st">&quot;npconint1&quot;</span>, <span class="st">&quot;npconint2&quot;</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;ppbhsdqhypt1&quot;</span>,<span class="st">&quot;ppbhsdqhypt2&quot;</span>, </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;ppbhconnt1&quot;</span>, <span class="st">&quot;ppbhconnt2&quot;</span>, <span class="st">&quot;ppbhconnimpt1&quot;</span>, <span class="st">&quot;ppbhconnimpt2&quot;</span>, <span class="st">&quot;ppbhconninat1&quot;</span>, <span class="st">&quot;ppbhconninat2&quot;</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;newcsdq1&quot;</span>,<span class="st">&quot;newcsdq2&quot;</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;newtsdq1&quot;</span>,<span class="st">&quot;newtsdq2&quot;</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#define boostrapping function</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  bs <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, data, indices) {</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices,] <span class="co"># allows boot to select sample</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data=</span>d) <span class="co">#type of formula, but formula itself is left to the boot call, which is better as we can used this generic boostrapp</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">coef</span>(fit))}</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop for run the analyses for each scale. </span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(VecOutcomes),<span class="at">ncol=</span><span class="dv">9</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes),<span class="at">by=</span><span class="dv">2</span>))</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  adhddata2<span class="ot">=</span>adhddata</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define outcomes</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  adhddata2[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>;</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  adhddata2[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>adhddata2[,<span class="fu">c</span>(VecOutcomes[i],VecOutcomes[i<span class="sc">+</span><span class="dv">1</span>])]</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for phenotypic estimate, inlcude opposite sex twins!</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  adhddata2c<span class="ot">=</span> adhddata2[ <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>arkidgr2) </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD2)</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scaling is done for each outcome, importantly this is done before selecting a twin at random, because if we do that separately for twin 1 and twin 2 we get rid of some differences </span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#(e.g. if mean difference between twin 1 and twin 2 is 0.2, then the within-twin pair difference for a pair which would have exact mean value would be 0.2 but if we standardize separately this would be 0)</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  adhddata2c[,<span class="st">&quot;arkidgr1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata2c[,<span class="st">&quot;arkidgr1&quot;</span>]);adhddata2c[,<span class="st">&quot;arkidgr2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata2c[,<span class="st">&quot;arkidgr2&quot;</span>]);</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  adhddata2c[,<span class="st">&quot;XD1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata2c[,<span class="st">&quot;XD1&quot;</span>]);adhddata2c[,<span class="st">&quot;XD2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata2c[,<span class="st">&quot;XD2&quot;</span>]) </span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select random</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  adhddata2rc<span class="ot">=</span>adhddata2c[adhddata2c<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for phenotypic estimates</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  modelCorrelatedRegression<span class="ot">=</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="st">&#39; XD1~rc*arkidgr1 #regression coeff for twin 1 </span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="st">  XD2~rc*arkidgr2 #equal for twin 2 because twin selected at random</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="st">  arkidgr1~~pv*arkidgr1 #predictor variance, same for twin 1 and 2, produces warning in lavaan but ok and enables the standardized estimates of rv to be the same</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="st">  arkidgr2~~pv*arkidgr2 </span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a><span class="st">  XD1~~rv*XD1 #residual var for twin 1</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="st">  XD2~~rv*XD2 #same twin 2</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a><span class="st">  XD1+XD2~id*1    # intercept</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="st">  arkidgr1+arkidgr2~ia*1    # intercept</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="st">  XD1~~XD2 #correlated residual variance, try comment out to see what it does when we omit it: i.e. increase in estimate</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="st">  &#39;</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>  modelCorrelatedRegressionFit<span class="ot">=</span> <span class="fu">sem</span>(modelCorrelatedRegression, <span class="at">data=</span>adhddata2rc, <span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>  Estimates<span class="ot">=</span><span class="fu">parameterEstimates</span>(modelCorrelatedRegressionFit,<span class="at">standardized=</span>T);Estimates</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>  fit.boot <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(modelCorrelatedRegression, <span class="at">data =</span> adhddata2rc,<span class="at">estimator =</span><span class="st">&quot;ML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>  conint<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>  lower.ci<span class="ot">=</span>conint<span class="sc">$</span>ci.lower[<span class="dv">1</span>]</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>  upper.ci<span class="ot">=</span>conint<span class="sc">$</span>ci.upper[<span class="dv">1</span>]</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>  Phe_est<span class="ot">=</span>Estimates<span class="sc">$</span>est[<span class="dv">1</span>]</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select same sex twins</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>  adhddata3c<span class="ot">=</span> adhddata2[ <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD2) <span class="sc">&amp;</span> (adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span>),]</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>  adhddata3c[,<span class="st">&quot;arkidgr1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata3c[,<span class="st">&quot;arkidgr1&quot;</span>]);adhddata3c[,<span class="st">&quot;arkidgr2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata3c[,<span class="st">&quot;arkidgr2&quot;</span>]);</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>  adhddata3c[,<span class="st">&quot;XD1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata3c[,<span class="st">&quot;XD1&quot;</span>]);adhddata3c[,<span class="st">&quot;XD2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata3c[,<span class="st">&quot;XD2&quot;</span>])</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select random</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>  adhddata3rc<span class="ot">=</span>adhddata3c[adhddata3c<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>  <span class="co">#simple differences</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>  adhddata3rc<span class="sc">$</span>BWdif<span class="ot">=</span><span class="cn">NA</span>;adhddata3rc<span class="sc">$</span>BWdif<span class="ot">=</span>adhddata3rc<span class="sc">$</span>arkidgr1<span class="sc">-</span>adhddata3rc<span class="sc">$</span>arkidgr2 </span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>  adhddata3rc<span class="sc">$</span>XDdif<span class="ot">=</span><span class="cn">NA</span>;adhddata3rc<span class="sc">$</span>XDdif<span class="ot">=</span>adhddata3rc<span class="sc">$</span>XD1<span class="sc">-</span>adhddata3rc<span class="sc">$</span>XD2</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>  <span class="co">#DZ</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for DZ estimates OLS through origin</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>  modelWIDZ<span class="ot">=</span><span class="fu">lm</span>(XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif,<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;DZ&quot;</span>,]) </span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>  <span class="co">#MZ</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for MZ estimates, OLS through origin</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>  modelWIMZ<span class="ot">=</span><span class="fu">lm</span>(XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif,<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,]) </span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bootstrapping with 10000 replications (even with 10000 replications there is still some variation in the results, so maybe worth doing more if very close to 0)</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>  resultsMZ <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">statistic=</span>bs,<span class="at">R=</span><span class="dv">10000</span>, <span class="at">formula=</span>XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif) <span class="co">#if the number of repetition is too small, i.e. 1000, might fail</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>  (<span class="at">CIresMZ=</span><span class="fu">boot.ci</span>(resultsMZ, <span class="at">type=</span><span class="st">&quot;bca&quot;</span>, <span class="at">index=</span><span class="dv">1</span>)) <span class="co"># bias corrected CI, index is 1 because there is no intercept so first coeff is the regression coef</span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>  CIMZ<span class="ot">=</span>CIresMZ<span class="sc">$</span>bca[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)]</span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>  resultsDZ <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;DZ&quot;</span>,], <span class="at">statistic=</span>bs,<span class="at">R=</span><span class="dv">10000</span>, <span class="at">formula=</span>XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif) <span class="co">#if the number of repetition is too small, i.e. 1000, might fail</span></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>  (<span class="at">CIresDZ=</span><span class="fu">boot.ci</span>(resultsDZ, <span class="at">type=</span><span class="st">&quot;bca&quot;</span>, <span class="at">index=</span><span class="dv">1</span>)) <span class="co"># bias corrected CI, index is 1 because there is no intercept so first coeff is the regression coef</span></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>  CIDZ<span class="ot">=</span>CIresDZ<span class="sc">$</span>bca[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)]</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>  VecRes<span class="ot">=</span><span class="fu">c</span>(Phe_est, lower.ci, upper.ci, <span class="fu">coef</span>(modelWIDZ),CIDZ,<span class="fu">coef</span>(modelWIMZ),CIMZ)</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>  ResultsLoop[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]<span class="ot">=</span>VecRes</span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ResultsLoop)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;PheEst&quot;</span>,<span class="st">&quot;Plow.ci&quot;</span>,<span class="st">&quot;Pup.ci&quot;</span>,<span class="st">&quot;DZest&quot;</span>,<span class="st">&quot;DZlow.ci&quot;</span>,<span class="st">&quot;DZup.ci&quot;</span>,<span class="st">&quot;MZest&quot;</span>,<span class="st">&quot;MZlow.ci&quot;</span>,<span class="st">&quot;MZup.ci&quot;</span>)</span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ResultsLoop)<span class="ot">=</span>VecOutcomes</span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">round</span>(ResultsLoop[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes),<span class="at">by=</span><span class="dv">2</span>),],<span class="dv">4</span>)</span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(ResultsLoop,<span class="st">&quot;Review Analysis Pheno, DZ, MZ Estimates.xlsx&quot;</span>)</span></code></pre></div>
<p>Figure 2 will be shown below</p>
<div class="figure">
<img src="MZ%20estimates.jpeg" alt="" />
<p class="caption">Figure2</p>
</div>
</div>
<div id="unstandardised-estimates-1kg-to-x-symptoms" class="section level2">
<h2>Unstandardised estimates (1kg to x symptoms)</h2>
<p>The reviewers also requested us to get the estimates where how change in birth weight in 1kg will result in change in symptoms. We firstly had to recode the Conner’s rating data into symptoms under a clinician’s suggestions. We then run a similar analysis as above but in unstandardised form, such that the estimates are interpreted as change in symptoms for each change of birthweight in 1kg. Results are in Table S8.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">######### 2.3 Change in BW in kg predicts change in symptoms ######</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#the first part is to recode CPRS ratings, so that the rating of 0,1--&gt;0 and 2,3--&gt;1, following diagnostic suggestion given by a clinician in our lab.</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#recoding for age 8,11,14,16#</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#do it once, save the new dataframe as ADHD_recode.dta</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#columns within category 1</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="do">###### recode for twin 1</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>Conner_8_HI_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hcon011&quot;</span>,<span class="st">&quot;hcon051&quot;</span>,<span class="st">&quot;hcon081&quot;</span>,<span class="st">&quot;hcon101&quot;</span>,<span class="st">&quot;hcon111&quot;</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;hcon131&quot;</span>,<span class="st">&quot;hcon141&quot;</span>,<span class="st">&quot;hcon161&quot;</span>,<span class="st">&quot;hcon181&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>Conner_8_IA_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hcon021&quot;</span>,<span class="st">&quot;hcon031&quot;</span>,<span class="st">&quot;hcon041&quot;</span>,<span class="st">&quot;hcon061&quot;</span>,<span class="st">&quot;hcon071&quot;</span>,<span class="st">&quot;hcon091&quot;</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;hcon121&quot;</span>,<span class="st">&quot;hcon151&quot;</span>,<span class="st">&quot;hcon171&quot;</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>Conner_12_HI_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;lpcon011&quot;</span>,<span class="st">&quot;lpcon051&quot;</span>,<span class="st">&quot;lpcon081&quot;</span>,<span class="st">&quot;lpcon101&quot;</span>,<span class="st">&quot;lpcon111&quot;</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;lpcon131&quot;</span>,<span class="st">&quot;lpcon141&quot;</span>,<span class="st">&quot;lpcon161&quot;</span>,<span class="st">&quot;lpcon181&quot;</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>Conner_12_IA_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;lpcon021&quot;</span>,<span class="st">&quot;lpcon031&quot;</span>,<span class="st">&quot;lpcon041&quot;</span>,<span class="st">&quot;lpcon061&quot;</span>,<span class="st">&quot;lpcon071&quot;</span>,<span class="st">&quot;lpcon091&quot;</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;lpcon121&quot;</span>,<span class="st">&quot;lpcon151&quot;</span>,<span class="st">&quot;lpcon171&quot;</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>Conner_14_HI_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;npcon011&quot;</span>,<span class="st">&quot;npcon051&quot;</span>,<span class="st">&quot;npcon081&quot;</span>,<span class="st">&quot;npcon101&quot;</span>,<span class="st">&quot;npcon111&quot;</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;npcon131&quot;</span>,<span class="st">&quot;npcon141&quot;</span>,<span class="st">&quot;npcon161&quot;</span>,<span class="st">&quot;npcon181&quot;</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>Conner_14_IA_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;npcon021&quot;</span>,<span class="st">&quot;npcon031&quot;</span>,<span class="st">&quot;npcon041&quot;</span>,<span class="st">&quot;npcon061&quot;</span>,<span class="st">&quot;npcon071&quot;</span>,<span class="st">&quot;npcon091&quot;</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;npcon121&quot;</span>,<span class="st">&quot;npcon151&quot;</span>,<span class="st">&quot;npcon171&quot;</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>Conner_16_HI_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;ppbhconn011&quot;</span>,<span class="st">&quot;ppbhconn051&quot;</span>,<span class="st">&quot;ppbhconn081&quot;</span>,<span class="st">&quot;ppbhconn101&quot;</span>,<span class="st">&quot;ppbhconn111&quot;</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;ppbhconn131&quot;</span>,<span class="st">&quot;ppbhconn141&quot;</span>,<span class="st">&quot;ppbhconn161&quot;</span>,<span class="st">&quot;ppbhconn181&quot;</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>Conner_16_IA_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;ppbhconn021&quot;</span>,<span class="st">&quot;ppbhconn031&quot;</span>,<span class="st">&quot;ppbhconn041&quot;</span>,<span class="st">&quot;ppbhconn061&quot;</span>,<span class="st">&quot;ppbhconn071&quot;</span>,<span class="st">&quot;ppbhconn091&quot;</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;ppbhconn121&quot;</span>,<span class="st">&quot;ppbhconn151&quot;</span>,<span class="st">&quot;ppbhconn171&quot;</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#create new columns for the recoded variables</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>Conner_8_HIr_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hcon011r&quot;</span>,<span class="st">&quot;hcon051r&quot;</span>,<span class="st">&quot;hcon081r&quot;</span>,<span class="st">&quot;hcon101r&quot;</span>,<span class="st">&quot;hcon111r&quot;</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;hcon131r&quot;</span>,<span class="st">&quot;hcon141r&quot;</span>,<span class="st">&quot;hcon161r&quot;</span>,<span class="st">&quot;hcon181r&quot;</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>Conner_8_IAr_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hcon021r&quot;</span>,<span class="st">&quot;hcon031r&quot;</span>,<span class="st">&quot;hcon041r&quot;</span>,<span class="st">&quot;hcon061r&quot;</span>,<span class="st">&quot;hcon071r&quot;</span>,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;hcon091r&quot;</span>,<span class="st">&quot;hcon121r&quot;</span>,<span class="st">&quot;hcon151r&quot;</span>,<span class="st">&quot;hcon171r&quot;</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>Conner_12_HIr_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;lpcon011r&quot;</span>,<span class="st">&quot;lpcon051r&quot;</span>,<span class="st">&quot;lpcon081r&quot;</span>,<span class="st">&quot;lpcon101r&quot;</span>,<span class="st">&quot;lpcon111r&quot;</span>,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lpcon131r&quot;</span>,<span class="st">&quot;lpcon141r&quot;</span>,<span class="st">&quot;lpcon161r&quot;</span>,<span class="st">&quot;lpcon181r&quot;</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>Conner_12_IAr_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;lpcon021r&quot;</span>,<span class="st">&quot;lpcon031r&quot;</span>,<span class="st">&quot;lpcon041r&quot;</span>,<span class="st">&quot;lpcon061r&quot;</span>,<span class="st">&quot;lpcon071r&quot;</span>,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lpcon091r&quot;</span>,<span class="st">&quot;lpcon121r&quot;</span>,<span class="st">&quot;lpcon151r&quot;</span>,<span class="st">&quot;lpcon171r&quot;</span>)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>Conner_14_HIr_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;npcon011r&quot;</span>,<span class="st">&quot;npcon051r&quot;</span>,<span class="st">&quot;npcon081r&quot;</span>,<span class="st">&quot;npcon101r&quot;</span>,<span class="st">&quot;npcon111r&quot;</span>,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;npcon131r&quot;</span>,<span class="st">&quot;npcon141r&quot;</span>,<span class="st">&quot;npcon161r&quot;</span>,<span class="st">&quot;npcon181r&quot;</span>)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>Conner_14_IAr_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;npcon021r&quot;</span>,<span class="st">&quot;npcon031r&quot;</span>,<span class="st">&quot;npcon041r&quot;</span>,<span class="st">&quot;npcon061r&quot;</span>,<span class="st">&quot;npcon071r&quot;</span>,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;npcon091r&quot;</span>,<span class="st">&quot;npcon121r&quot;</span>,<span class="st">&quot;npcon151r&quot;</span>,<span class="st">&quot;npcon171r&quot;</span>)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>Conner_16_HIr_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;ppbhconn011r&quot;</span>,<span class="st">&quot;ppbhconn051r&quot;</span>,<span class="st">&quot;ppbhconn081r&quot;</span>,<span class="st">&quot;ppbhconn101r&quot;</span>,<span class="st">&quot;ppbhconn111r&quot;</span>,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;ppbhconn131r&quot;</span>,<span class="st">&quot;ppbhconn141r&quot;</span>,<span class="st">&quot;ppbhconn161r&quot;</span>,<span class="st">&quot;ppbhconn181r&quot;</span>)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>Conner_16_IAr_1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;ppbhconn021r&quot;</span>,<span class="st">&quot;ppbhconn031r&quot;</span>,<span class="st">&quot;ppbhconn041r&quot;</span>,<span class="st">&quot;ppbhconn061r&quot;</span>,<span class="st">&quot;ppbhconn071r&quot;</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;ppbhconn091r&quot;</span>,<span class="st">&quot;ppbhconn121r&quot;</span>,<span class="st">&quot;ppbhconn151r&quot;</span>,<span class="st">&quot;ppbhconn171r&quot;</span>)</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co">#create several columns at a time</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_8_IAr_1]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_8_HIr_1]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_12_IAr_1]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_12_HIr_1]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_14_IAr_1]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_14_HIr_1]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_16_IAr_1]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_16_HIr_1]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co">#recode CPRS score 0,1=0; 2,3=1</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co">#if elevate the threshold, less than 100 cases would remain</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Conner_8_IAr_1))</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>{ADHD_recode[,Conner_8_IAr_1[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_8_IA_1[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>(ADHD_recode[,Conner_12_IAr_1[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_12_IA_1[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>(ADHD_recode[,Conner_14_IAr_1[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_14_IA_1[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>(ADHD_recode[,Conner_16_IAr_1[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_16_IA_1[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Conner_8_HIr_1))</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>{(ADHD_recode[,Conner_8_HIr_1[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_8_HI_1[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>  (ADHD_recode[,Conner_12_HIr_1[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_12_HI_1[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>  (ADHD_recode[,Conner_14_HIr_1[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_14_HI_1[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>  (ADHD_recode[,Conner_16_HIr_1[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_16_HI_1[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="do">#### then counting the sum of IA or HI</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate sum score from the recoded columns </span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="co">#after calculation, exclude the rows with &gt;4 NA values (assign the new value as NA)</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="co">#entry ending with 1: </span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_8_1<span class="ot">=</span><span class="cn">NA</span>; ADHD_recode<span class="sc">$</span>HIsum_8_1<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_12_1<span class="ot">=</span><span class="cn">NA</span>; ADHD_recode<span class="sc">$</span>HIsum_12_1<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_14_1<span class="ot">=</span><span class="cn">NA</span>; ADHD_recode<span class="sc">$</span>HIsum_14_1<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_16_1<span class="ot">=</span><span class="cn">NA</span>; ADHD_recode<span class="sc">$</span>HIsum_16_1<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_8_1<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_8_IAr_1],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>) <span class="co">#sum Score of the inattention symptoms</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_8_1[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon021r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon031r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon041r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon061r)</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon071r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon091r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon121r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon151r)</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon171r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>IAsum_8_1,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_8_1<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_8_HIr_1],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_8_1[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon011r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon051r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon081r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon101r)</span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon111r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon131r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon141r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon161r)</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon181r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>HIsum_8_1,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_12_1<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_12_IAr_1],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_12_1[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon021r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon031r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon041r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon061r)</span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon071r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon091r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon121r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon151r)</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon171r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>IAsum_12_1,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_12_1<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_12_HIr_1],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_12_1[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon011r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon051r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon081r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon101r)</span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon111r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon131r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon141r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon161r)</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon181r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>HIsum_12_1,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_14_1<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_14_IAr_1],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_14_1[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon021r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon031r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon041r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon061r)</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon071r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon091r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon121r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon151r)</span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon171r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span>   <span class="co">#exclude rows with too many NA</span></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>IAsum_14_1,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_14_1<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_14_HIr_1],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_14_1[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon011r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon051r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon081r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon101r)</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon111r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon131r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon141r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon161r)</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon181r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>HIsum_14_1,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_16_1<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_16_IAr_1],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_16_1[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn021r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn031r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn041r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn061r)</span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn071r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn091r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn121r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn151r)</span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn171r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span>   <span class="co">#exclude rows with too many NA</span></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>IAsum_16_1,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_16_1<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_16_HIr_1],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_16_1[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn011r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn051r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn081r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn101r)</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn111r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn131r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn141r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn161r)</span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn181r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>HIsum_16_1,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a><span class="do">## recode for twin 2 </span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>Conner_8_HI_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hcon012&quot;</span>,<span class="st">&quot;hcon052&quot;</span>,<span class="st">&quot;hcon082&quot;</span>,<span class="st">&quot;hcon102&quot;</span>,<span class="st">&quot;hcon112&quot;</span>,</span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;hcon132&quot;</span>,<span class="st">&quot;hcon142&quot;</span>,<span class="st">&quot;hcon162&quot;</span>,<span class="st">&quot;hcon182&quot;</span>)</span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>Conner_8_IA_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hcon022&quot;</span>,<span class="st">&quot;hcon032&quot;</span>,<span class="st">&quot;hcon042&quot;</span>,<span class="st">&quot;hcon062&quot;</span>,<span class="st">&quot;hcon072&quot;</span>,<span class="st">&quot;hcon092&quot;</span>,</span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;hcon122&quot;</span>,<span class="st">&quot;hcon152&quot;</span>,<span class="st">&quot;hcon172&quot;</span>)</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>Conner_12_HI_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;lpcon012&quot;</span>,<span class="st">&quot;lpcon052&quot;</span>,<span class="st">&quot;lpcon082&quot;</span>,<span class="st">&quot;lpcon102&quot;</span>,<span class="st">&quot;lpcon112&quot;</span>,</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;lpcon132&quot;</span>,<span class="st">&quot;lpcon142&quot;</span>,<span class="st">&quot;lpcon162&quot;</span>,<span class="st">&quot;lpcon182&quot;</span>)</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>Conner_12_IA_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;lpcon022&quot;</span>,<span class="st">&quot;lpcon032&quot;</span>,<span class="st">&quot;lpcon042&quot;</span>,<span class="st">&quot;lpcon062&quot;</span>,<span class="st">&quot;lpcon072&quot;</span>,<span class="st">&quot;lpcon092&quot;</span>,</span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;lpcon122&quot;</span>,<span class="st">&quot;lpcon152&quot;</span>,<span class="st">&quot;lpcon172&quot;</span>)</span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>Conner_14_HI_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;npcon012&quot;</span>,<span class="st">&quot;npcon052&quot;</span>,<span class="st">&quot;npcon082&quot;</span>,<span class="st">&quot;npcon102&quot;</span>,<span class="st">&quot;npcon112&quot;</span>,</span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;npcon132&quot;</span>,<span class="st">&quot;npcon142&quot;</span>,<span class="st">&quot;npcon162&quot;</span>,<span class="st">&quot;npcon182&quot;</span>)</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>Conner_14_IA_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;npcon022&quot;</span>,<span class="st">&quot;npcon032&quot;</span>,<span class="st">&quot;npcon042&quot;</span>,<span class="st">&quot;npcon062&quot;</span>,<span class="st">&quot;npcon072&quot;</span>,<span class="st">&quot;npcon092&quot;</span>,</span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;npcon122&quot;</span>,<span class="st">&quot;npcon152&quot;</span>,<span class="st">&quot;npcon172&quot;</span>)</span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>Conner_16_HI_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;ppbhconn012&quot;</span>,<span class="st">&quot;ppbhconn052&quot;</span>,<span class="st">&quot;ppbhconn082&quot;</span>,<span class="st">&quot;ppbhconn102&quot;</span>,<span class="st">&quot;ppbhconn112&quot;</span>,</span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;ppbhconn132&quot;</span>,<span class="st">&quot;ppbhconn142&quot;</span>,<span class="st">&quot;ppbhconn162&quot;</span>,<span class="st">&quot;ppbhconn182&quot;</span>)</span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>Conner_16_IA_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;ppbhconn022&quot;</span>,<span class="st">&quot;ppbhconn032&quot;</span>,<span class="st">&quot;ppbhconn042&quot;</span>,<span class="st">&quot;ppbhconn062&quot;</span>,<span class="st">&quot;ppbhconn072&quot;</span>,<span class="st">&quot;ppbhconn092&quot;</span>,</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;ppbhconn122&quot;</span>,<span class="st">&quot;ppbhconn152&quot;</span>,<span class="st">&quot;ppbhconn172&quot;</span>)</span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a><span class="co">#create new columns for the recoded variables</span></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>Conner_8_HIr_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hcon012r&quot;</span>,<span class="st">&quot;hcon052r&quot;</span>,<span class="st">&quot;hcon082r&quot;</span>,<span class="st">&quot;hcon102r&quot;</span>,<span class="st">&quot;hcon112r&quot;</span>,</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;hcon132r&quot;</span>,<span class="st">&quot;hcon142r&quot;</span>,<span class="st">&quot;hcon162r&quot;</span>,<span class="st">&quot;hcon182r&quot;</span>)</span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>Conner_8_IAr_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hcon022r&quot;</span>,<span class="st">&quot;hcon032r&quot;</span>,<span class="st">&quot;hcon042r&quot;</span>,<span class="st">&quot;hcon062r&quot;</span>,<span class="st">&quot;hcon072r&quot;</span>,</span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;hcon092r&quot;</span>,<span class="st">&quot;hcon122r&quot;</span>,<span class="st">&quot;hcon152r&quot;</span>,<span class="st">&quot;hcon172r&quot;</span>)</span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>Conner_12_HIr_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;lpcon012r&quot;</span>,<span class="st">&quot;lpcon052r&quot;</span>,<span class="st">&quot;lpcon082r&quot;</span>,<span class="st">&quot;lpcon102r&quot;</span>,<span class="st">&quot;lpcon112r&quot;</span>,</span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lpcon132r&quot;</span>,<span class="st">&quot;lpcon142r&quot;</span>,<span class="st">&quot;lpcon162r&quot;</span>,<span class="st">&quot;lpcon182r&quot;</span>)</span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>Conner_12_IAr_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;lpcon022r&quot;</span>,<span class="st">&quot;lpcon032r&quot;</span>,<span class="st">&quot;lpcon042r&quot;</span>,<span class="st">&quot;lpcon062r&quot;</span>,<span class="st">&quot;lpcon072r&quot;</span>,</span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lpcon092r&quot;</span>,<span class="st">&quot;lpcon122r&quot;</span>,<span class="st">&quot;lpcon152r&quot;</span>,<span class="st">&quot;lpcon172r&quot;</span>)</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>Conner_14_HIr_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;npcon012r&quot;</span>,<span class="st">&quot;npcon052r&quot;</span>,<span class="st">&quot;npcon082r&quot;</span>,<span class="st">&quot;npcon102r&quot;</span>,<span class="st">&quot;npcon112r&quot;</span>,</span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;npcon132r&quot;</span>,<span class="st">&quot;npcon142r&quot;</span>,<span class="st">&quot;npcon162r&quot;</span>,<span class="st">&quot;npcon182r&quot;</span>)</span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>Conner_14_IAr_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;npcon022r&quot;</span>,<span class="st">&quot;npcon032r&quot;</span>,<span class="st">&quot;npcon042r&quot;</span>,<span class="st">&quot;npcon062r&quot;</span>,<span class="st">&quot;npcon072r&quot;</span>,</span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;npcon092r&quot;</span>,<span class="st">&quot;npcon122r&quot;</span>,<span class="st">&quot;npcon152r&quot;</span>,<span class="st">&quot;npcon172r&quot;</span>)</span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>Conner_16_HIr_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;ppbhconn012r&quot;</span>,<span class="st">&quot;ppbhconn052r&quot;</span>,<span class="st">&quot;ppbhconn082r&quot;</span>,<span class="st">&quot;ppbhconn102r&quot;</span>,<span class="st">&quot;ppbhconn112r&quot;</span>,</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;ppbhconn132r&quot;</span>,<span class="st">&quot;ppbhconn142r&quot;</span>,<span class="st">&quot;ppbhconn162r&quot;</span>,<span class="st">&quot;ppbhconn182r&quot;</span>)</span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>Conner_16_IAr_2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;ppbhconn022r&quot;</span>,<span class="st">&quot;ppbhconn032r&quot;</span>,<span class="st">&quot;ppbhconn042r&quot;</span>,<span class="st">&quot;ppbhconn062r&quot;</span>,<span class="st">&quot;ppbhconn072r&quot;</span>,</span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;ppbhconn092r&quot;</span>,<span class="st">&quot;ppbhconn122r&quot;</span>,<span class="st">&quot;ppbhconn152r&quot;</span>,<span class="st">&quot;ppbhconn172r&quot;</span>)</span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a><span class="co">#create several columns at a time</span></span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_8_IAr_2]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_8_HIr_2]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_12_IAr_2]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_12_HIr_2]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_14_IAr_2]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_14_HIr_2]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_16_IAr_2]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>ADHD_recode[,Conner_16_HIr_2]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a><span class="co">#recode CPRS score 0,1=0; 2,3=1</span></span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a><span class="co">#if elevate the threshold, less than 100 cases would remain</span></span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Conner_8_IAr_2))</span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a>{ADHD_recode[,Conner_8_IAr_2[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_8_IA_2[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>)</span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a>(ADHD_recode[,Conner_12_IAr_2[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_12_IA_2[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a>(ADHD_recode[,Conner_14_IAr_2[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_14_IA_2[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a>(ADHD_recode[,Conner_16_IAr_2[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_16_IA_2[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Conner_8_HIr_2))</span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a>{(ADHD_recode[,Conner_8_HIr_2[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_8_HI_2[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a>  (ADHD_recode[,Conner_12_HIr_2[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_12_HI_2[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a>  (ADHD_recode[,Conner_14_HIr_2[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_14_HI_2[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a>  (ADHD_recode[,Conner_16_HIr_2[i]]<span class="ot">=</span><span class="fu">recode</span>(ADHD_recode[,Conner_16_HI_2[i]],<span class="st">&quot;0:1=0;2:3=1;else=NA&quot;</span>))</span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a><span class="co">#then counting the sum of IA or HI</span></span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate sum score from the recoded columns#</span></span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a><span class="co">#after calculation, exclude the rows with &gt;4 NA values (assign the new value as NA)</span></span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a><span class="co">#entry ending with 1: </span></span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_8_2<span class="ot">=</span><span class="cn">NA</span>; ADHD_recode<span class="sc">$</span>HIsum_8_2<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_12_2<span class="ot">=</span><span class="cn">NA</span>; ADHD_recode<span class="sc">$</span>HIsum_12_2<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_14_2<span class="ot">=</span><span class="cn">NA</span>; ADHD_recode<span class="sc">$</span>HIsum_14_2<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_16_2<span class="ot">=</span><span class="cn">NA</span>; ADHD_recode<span class="sc">$</span>HIsum_16_2<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_8_2<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_8_IAr_2],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>) <span class="co">#sum Score of the inattention symptoms</span></span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_8_2[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon022r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon032r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon042r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon062r)</span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon072r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon092r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon122r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon152r)</span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon172r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span> </span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>IAsum_8_2,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_8_2<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_8_HIr_2],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_8_2[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon012r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon052r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon082r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon102r)</span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon112r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon132r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon142r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon162r)</span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>hcon182r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>HIsum_8_2,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_12_2<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_12_IAr_2],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_12_2[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon022r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon032r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon042r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon062r)</span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon072r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon092r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon122r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon152r)</span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon172r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span>   </span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>IAsum_12_2,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_12_2<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_12_HIr_2],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_12_2[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon012r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon052r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon082r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon102r)</span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon112r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon132r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon142r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon162r)</span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>lpcon182r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>HIsum_12_2,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_14_2<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_14_IAr_2],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_14_2[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon022r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon032r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon042r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon062r)</span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon072r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon092r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon122r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon152r)</span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon172r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span>   <span class="co">#exclude rows with too many NA</span></span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>IAsum_14_2,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_14_2<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_14_HIr_2],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_14_2[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon012r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon052r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon082r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon102r)</span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon112r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon132r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon142r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon162r)</span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>npcon182r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>HIsum_14_2,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_16_2<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_16_IAr_2],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>IAsum_16_2[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn022r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn032r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn042r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn062r)</span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn072r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn092r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn122r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn152r)</span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn172r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span>   <span class="co">#exclude rows with too many NA</span></span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>IAsum_16_2,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_16_2<span class="ot">=</span><span class="fu">round</span>(<span class="fu">rowMeans</span>(ADHD_recode[,Conner_16_HIr_2],<span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">9</span>)</span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>HIsum_16_2[(<span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn012r) <span class="sc">+</span> <span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn052r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn082r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn102r)</span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn112r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn132r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn142r)<span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn162r)</span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">+</span><span class="fu">is.na</span>(ADHD_recode<span class="sc">$</span>ppbhconn182r)) <span class="sc">&gt;</span><span class="dv">4</span>]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ADHD_recode<span class="sc">$</span>HIsum_16_2,<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>,<span class="at">deparse.level=</span><span class="dv">2</span>)</span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a><span class="do">##### phenotypic, MZ, DZ analyses using unstandardised symptoms </span></span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a>VecOutcomes<span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;IAsum_8_1&quot;</span>, <span class="st">&quot;IAsum_8_2&quot;</span>, <span class="st">&quot;IAsum_12_1&quot;</span>,<span class="st">&quot;IAsum_12_2&quot;</span>,</span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;IAsum_14_1&quot;</span>,<span class="st">&quot;IAsum_14_2&quot;</span>,<span class="st">&quot;IAsum_16_1&quot;</span>,<span class="st">&quot;IAsum_16_2&quot;</span>,</span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;HIsum_8_1&quot;</span>,<span class="st">&quot;HIsum_8_2&quot;</span>, <span class="st">&quot;HIsum_12_1&quot;</span>, <span class="st">&quot;HIsum_12_2&quot;</span>,</span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;HIsum_14_1&quot;</span>,<span class="st">&quot;HIsum_14_2&quot;</span>,<span class="st">&quot;HIsum_16_1&quot;</span>,<span class="st">&quot;HIsum_16_2&quot;</span>)</span>
<span id="cb10-260"><a href="#cb10-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-261"><a href="#cb10-261" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(VecOutcomes),<span class="at">ncol=</span><span class="dv">9</span>)</span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, data, indices) {</span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices,] <span class="co"># allows boot to select sample</span></span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data=</span>d) <span class="co">#type of formula, but formula itself is left to the boot call, which is better as we can used this generic boostrapp</span></span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">coef</span>(fit))</span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(VecOutcomes),<span class="at">ncol=</span><span class="dv">9</span>)</span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a><span class="co">#convert grams into kg</span></span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>BWkg1<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>BWkg2<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>BWkg1<span class="ot">=</span>ADHD_recode<span class="sc">$</span>arkidgr1<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a>ADHD_recode<span class="sc">$</span>BWkg2<span class="ot">=</span>ADHD_recode<span class="sc">$</span>arkidgr2<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes),<span class="at">by=</span><span class="dv">2</span>))</span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a>  adhddata2<span class="ot">=</span>ADHD_recode</span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define outcomes</span></span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a>  adhddata2[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>;</span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a>  adhddata2[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>adhddata2[,<span class="fu">c</span>(VecOutcomes[i],VecOutcomes[i<span class="sc">+</span><span class="dv">1</span>])]</span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for phenotypic estimate, inlcude opposite sex twins!</span></span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a>  adhddata2c<span class="ot">=</span> adhddata2[ <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>BWkg1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>BWkg2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD2)</span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> adhddata2<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a>  <span class="co">#be careful when you standardize when you have several outcomes with different Ns, </span></span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a>  <span class="co">#it might be better to standardized before even you define your complete cases.</span></span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a>  <span class="co"># no scaling because we want to see unstandardised estimates</span></span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select random</span></span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a>  adhddata2rc<span class="ot">=</span>adhddata2c[adhddata2c<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for phenotypic estimates</span></span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a>  modelCorrelatedRegression<span class="ot">=</span></span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;XD1~rc*BWkg1 #regression coeff for twin 1 </span></span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a><span class="st">  XD2~rc*BWkg2 #equal for twin 2 because twin selected at random</span></span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a><span class="st">  BWkg1~~pv*BWkg1 #predictor variance, same for twin 1 and 2, produces warning in lavaan but ok and enables the standardized estimates of rv to be the same</span></span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a><span class="st">  BWkg2~~pv*BWkg2 #</span></span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a><span class="st">  XD1~~rv*XD1 #residual var for twin 1</span></span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a><span class="st">  XD2~~rv*XD2 #same twin 2</span></span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a><span class="st">  XD1+XD2~id*1    # intercept</span></span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a><span class="st">  BWkg1+BWkg2~ia*1    # intercept</span></span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a><span class="st">  XD1~~XD2 #correlated residual variance, try comment out to see what it does when we omit it: i.e. increase in estimate</span></span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a><span class="st">  &#39;</span></span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a>  modelCorrelatedRegressionFit<span class="ot">=</span> <span class="fu">sem</span>(modelCorrelatedRegression, <span class="at">data=</span>adhddata2rc, <span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a>  Estimates<span class="ot">=</span><span class="fu">parameterEstimates</span>(modelCorrelatedRegressionFit,<span class="at">standardized=</span>T);Estimates</span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a>  fit.boot <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(modelCorrelatedRegression, <span class="at">data =</span> adhddata2rc,<span class="at">estimator =</span><span class="st">&quot;ML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a>  conint<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>)  <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a>  lower.ci<span class="ot">=</span>conint<span class="sc">$</span>ci.lower[<span class="dv">1</span>]</span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a>  upper.ci<span class="ot">=</span>conint<span class="sc">$</span>ci.upper[<span class="dv">1</span>]</span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a>  Phe_est<span class="ot">=</span>Estimates<span class="sc">$</span>est[<span class="dv">1</span>];</span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select same sex twins</span></span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a>  adhddata3c<span class="ot">=</span> adhddata2[ <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>BWkg1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>BWkg2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD2)</span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> adhddata2<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span>),]</span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select random</span></span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a>  adhddata3rc<span class="ot">=</span>adhddata3c[adhddata3c<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a>  <span class="co">#simple differences</span></span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a>  adhddata3rc<span class="sc">$</span>BWdif<span class="ot">=</span><span class="cn">NA</span>;adhddata3rc<span class="sc">$</span>BWdif<span class="ot">=</span>adhddata3rc<span class="sc">$</span>BWkg1<span class="sc">-</span>adhddata3rc<span class="sc">$</span>BWkg2 </span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a>  adhddata3rc<span class="sc">$</span>XDdif<span class="ot">=</span><span class="cn">NA</span>;adhddata3rc<span class="sc">$</span>XDdif<span class="ot">=</span>adhddata3rc<span class="sc">$</span>XD1<span class="sc">-</span>adhddata3rc<span class="sc">$</span>XD2</span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a>  <span class="co">#DZ</span></span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for DZ estimates OLS through origin</span></span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a>  modelWIDZ<span class="ot">=</span><span class="fu">lm</span>(XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif,<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;DZ&quot;</span>,]) </span>
<span id="cb10-342"><a href="#cb10-342" aria-hidden="true" tabindex="-1"></a>  dzest<span class="ot">=</span><span class="fu">confint</span>(modelWIDZ, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb10-343"><a href="#cb10-343" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a>  <span class="co">#MZ</span></span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for MZ estimates, OLS through origin</span></span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a>  modelWIMZ<span class="ot">=</span><span class="fu">lm</span>(XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif,<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,]) </span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a>  mzest<span class="ot">=</span><span class="fu">confint</span>(modelWIMZ, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bootstrapping with 10000 replications (even with 10000 replications there is still some variation in the results, so maybe worth doing more if very close to 0)</span></span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a>  resultsMZ <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">statistic=</span>bs,<span class="at">R=</span><span class="dv">10000</span>, <span class="at">formula=</span>XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif) <span class="co">#if the number of repetition is too small, i.e. 1000, might fail</span></span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a>  (<span class="at">CIresMZ=</span><span class="fu">boot.ci</span>(resultsMZ, <span class="at">type=</span><span class="st">&quot;bca&quot;</span>, <span class="at">index=</span><span class="dv">1</span>)) <span class="co"># bias corrected CI, index is 1 because there is no intercept so first coeff is the regression coef</span></span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a>  CIMZ<span class="ot">=</span>CIresMZ<span class="sc">$</span>bca[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)]</span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a>  resultsDZ <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;DZ&quot;</span>,], <span class="at">statistic=</span>bs,<span class="at">R=</span><span class="dv">10000</span>, <span class="at">formula=</span>XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif) <span class="co">#if the number of repetition is too small, i.e. 1000, might fail</span></span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a>  (<span class="at">CIresDZ=</span><span class="fu">boot.ci</span>(resultsDZ, <span class="at">type=</span><span class="st">&quot;bca&quot;</span>, <span class="at">index=</span><span class="dv">1</span>)) <span class="co"># bias corrected CI, index is 1 because there is no intercept so first coeff is the regression coef</span></span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a>  CIDZ<span class="ot">=</span>CIresDZ<span class="sc">$</span>bca[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)]</span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a>  VecRes<span class="ot">=</span><span class="fu">c</span>(Phe_est, lower.ci, upper.ci, <span class="fu">coef</span>(modelWIDZ),CIDZ,<span class="fu">coef</span>(modelWIMZ),CIMZ)</span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a>  ResultsLoop[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]<span class="ot">=</span>VecRes</span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ResultsLoop)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;PheEst&quot;</span>,<span class="st">&quot;lower.ci&quot;</span>,<span class="st">&quot;upper.ci&quot;</span>,<span class="st">&quot;DZest&quot;</span>,<span class="st">&quot;DZlow.ci&quot;</span>,<span class="st">&quot;DZup.ci&quot;</span>,<span class="st">&quot;MZest&quot;</span>,<span class="st">&quot;MZlow.ci&quot;</span>,<span class="st">&quot;MZup.ci&quot;</span>)</span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ResultsLoop)<span class="ot">=</span>VecOutcomes</span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">round</span>(ResultsLoop[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes),<span class="at">by=</span><span class="dv">2</span>),],<span class="dv">4</span>)</span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(ResultsLoop, <span class="st">&quot;Symptoms - Bootstrapped Unstandardised estimates in kilogram and symptoms unit.xlsx&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="latent-growth-models-lgm" class="section level1">
<h1>Latent growth models (LGM)</h1>
<p>The first section of the syntax (split twins) is to split the twins - heavier twin as twin 1 and lighter twin as twin 2.</p>
<div id="split-twins" class="section level2">
<h2>Split twins</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>adhddatal<span class="ot">=</span>adhddata</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#select MZ twins who at least have one adhd measure at any point of life, and have birth weight data. </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#for CPRS total at ages 8, 12, 14 and 16. </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#arkidgr1/2 = birth weight</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#hconnt1/2= cprs measure at age 8</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#lpconnt1/2 = age 12</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#npconnt1/2 = age 14</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#ppbhconnt1/2 = age 16</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>adhddatamz<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                         ((<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconnt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint2))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconnt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint2))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconnt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint2))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat2))) <span class="sc">&amp;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                         adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span>(adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span>),]</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#have to first divide the twins into 2 groups.</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>highBW<span class="ot">=</span>adhddatamz[adhddatamz<span class="sc">$</span>arkidgr1<span class="sc">&gt;</span>adhddatamz<span class="sc">$</span>arkidgr2,]</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>lowBW<span class="ot">=</span>adhddatamz[adhddatamz<span class="sc">$</span>arkidgr2<span class="sc">&gt;</span>adhddatamz<span class="sc">$</span>arkidgr1,]</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>equalBW<span class="ot">=</span>adhddatamz[adhddatamz<span class="sc">$</span>arkidgr2<span class="sc">==</span>adhddatamz<span class="sc">$</span>arkidgr1,]</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#check if bwt1&gt;bwt2</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>((highBW<span class="sc">$</span>arkidgr1),(highBW<span class="sc">$</span>arkidgr2)))</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#rename twin 1 in low 1 as twin 2 and twin 2 =twin 1</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co">#hence twin 1 will always have higher birthweight</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>lowBW<span class="ot">=</span><span class="fu">rename</span>(lowBW, <span class="fu">c</span>(<span class="st">&quot;arkidgr1&quot;</span><span class="ot">=</span><span class="st">&quot;arkidgr2&quot;</span>, <span class="st">&quot;arkidgr2&quot;</span><span class="ot">=</span><span class="st">&quot;arkidgr1&quot;</span>, <span class="st">&quot;hconnt1&quot;</span><span class="ot">=</span><span class="st">&quot;hconnt2&quot;</span>,<span class="st">&quot;hconnt2&quot;</span><span class="ot">=</span><span class="st">&quot;hconnt1&quot;</span>, <span class="st">&quot;lpconnt1&quot;</span><span class="ot">=</span><span class="st">&quot;lpconnt2&quot;</span>, </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lpconnt2&quot;</span><span class="ot">=</span><span class="st">&quot;lpconnt1&quot;</span>, <span class="st">&quot;npconnt1&quot;</span><span class="ot">=</span><span class="st">&quot;npconnt2&quot;</span>,<span class="st">&quot;npconnt2&quot;</span><span class="ot">=</span><span class="st">&quot;npconnt1&quot;</span>,<span class="st">&quot;ppbhconnt1&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconnt2&quot;</span>,<span class="st">&quot;ppbhconnt2&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconnt1&quot;</span>,</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;hconhit1&quot;</span><span class="ot">=</span><span class="st">&quot;hconhit2&quot;</span>,<span class="st">&quot;hconhit2&quot;</span><span class="ot">=</span><span class="st">&quot;hconhit1&quot;</span>, <span class="st">&quot;lpconhit1&quot;</span><span class="ot">=</span><span class="st">&quot;lpconhit2&quot;</span>, </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lpconhit2&quot;</span><span class="ot">=</span><span class="st">&quot;lpconhit1&quot;</span>, <span class="st">&quot;npconhit1&quot;</span><span class="ot">=</span><span class="st">&quot;npconhit2&quot;</span>,<span class="st">&quot;npconhit2&quot;</span><span class="ot">=</span><span class="st">&quot;npconhit1&quot;</span>,<span class="st">&quot;ppbhconnimpt1&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconnimpt2&quot;</span>,<span class="st">&quot;ppbhconnimpt2&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconnimpt1&quot;</span>,</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;hconint1&quot;</span><span class="ot">=</span><span class="st">&quot;hconint2&quot;</span>,<span class="st">&quot;hconint2&quot;</span><span class="ot">=</span><span class="st">&quot;hconint1&quot;</span>, <span class="st">&quot;lpconint1&quot;</span><span class="ot">=</span><span class="st">&quot;lpconint2&quot;</span>, </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lpconint2&quot;</span><span class="ot">=</span><span class="st">&quot;lpconint1&quot;</span>, <span class="st">&quot;npconint1&quot;</span><span class="ot">=</span><span class="st">&quot;npconint2&quot;</span>,<span class="st">&quot;npconint2&quot;</span><span class="ot">=</span><span class="st">&quot;npconint1&quot;</span>,<span class="st">&quot;ppbhconninat1&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconninat2&quot;</span>,<span class="st">&quot;ppbhconninat2&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconninat1&quot;</span>))</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="co">#check if bwt1&gt;bwt2 in new lowBW data</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>((lowBW<span class="sc">$</span>arkidgr1),(lowBW<span class="sc">$</span>arkidgr2)))</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="co">#merged twin= twin 1 birth weight is always heavier</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>mergedtwin<span class="ot">=</span><span class="fu">rbind</span>(highBW,lowBW, equalBW)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(highBW);<span class="fu">dim</span>(lowBW);<span class="fu">dim</span>(mergedtwin);<span class="fu">dim</span>(adhddatamz)</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>((equalBW<span class="sc">$</span>arkidgr1),(equalBW<span class="sc">$</span>arkidgr2)))<span class="co"># we excluded 171 MZ twin pairs with equal birth weight</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a><span class="co">#check if correct. If BW of T1 always &gt; T2, then all signs will be positive, which is =1. Table will show all signs as 1.</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">sign</span>(mergedtwin<span class="sc">$</span>arkidgr1<span class="sc">-</span>mergedtwin<span class="sc">$</span>arkidgr2),<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>) <span class="co">#twin1 is always heavier than twin2</span></span></code></pre></div>
</div>
<div id="development-of-lgm-syntax" class="section level2">
<h2>Development of LGM Syntax</h2>
<p>This section shows the syntax we used to develop the latent growth model. The final syntax that we used was a quadratic model which will be shown in the next section, but I wanted to include the syntax with comments we made just in case you may need them too.</p>
<p>We did the same thing for hyperactivity and inattention subscales, but they are the same as the following steps:</p>
<div id="linear-model" class="section level3">
<h3>Linear Model</h3>
<p>Fit the LGFitis model (a linear model)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">###3.2. ============  Double latent growth model (for total ADHD)==================</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#based on the OLSEN, 2006, Structural Equation Modeling with Interchangeable dyads, Psychological Methods, Vol. 11, No. 2, 127-141</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ObsVarTwin1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hconnt1&quot;</span>,<span class="st">&quot;lpconnt1&quot;</span>,<span class="st">&quot;npconnt1&quot;</span>,<span class="st">&quot;ppbhconnt1&quot;</span>)  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>ObsVarTwin2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hconnt2&quot;</span>,<span class="st">&quot;lpconnt2&quot;</span>,<span class="st">&quot;npconnt2&quot;</span>,<span class="st">&quot;ppbhconnt2&quot;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XB1&quot;</span>,<span class="st">&quot;XC1&quot;</span>,<span class="st">&quot;XD1&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>; mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XB1&quot;</span>,<span class="st">&quot;XC1&quot;</span>,<span class="st">&quot;XD1&quot;</span>)]<span class="ot">=</span>mergedtwin[,ObsVarTwin1]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA2&quot;</span>,<span class="st">&quot;XB2&quot;</span>,<span class="st">&quot;XC2&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>; mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA2&quot;</span>,<span class="st">&quot;XB2&quot;</span>,<span class="st">&quot;XC2&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>mergedtwin[,ObsVarTwin2]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#twin 1 is the heavier twin, twin 2 is the lighter twin</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#that&#39;s good as twin2 as higher intercept as expected and also steeper slope as could be seen on the plot you made</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#sometimes big loading are a problem as variances get bigger, try dividing the loading by ten, i.e. 0, 0.34, 0.61, 0.85 and then their square version</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="do">##### Total ADHD: linear model ####</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#build a linear model (without quadratic component for ADHD latent growth curve)</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>LGModis <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="st">#GROWTH Twin 1 and 2</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="st">i1 =~ 1*XA1 + 1*XB1 + 1*XC1 + 1*XD1  </span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ 0*XA1 + 3.4*XB1 + 6.1*XC1 + 8.5*XD1 </span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="st">i2 =~ 1*XA2 + 1*XB2 + 1*XC2 + 1*XD2  </span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ 0*XA2 + 3.4*XB2 + 6.1*XC2 + 8.5*XD2 </span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="st"># #MEANS OF LATENT FACTORS/intercepts</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="st">i1~m1*1  #twins are different and not random, hence different parameters for i1 amd i2, s1 and s2 etc.</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="st">s1~n1*1</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="st">i2~m2*1</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="st">s2~n2*1</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="st">#VAR LATENT FACTORS</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~a1*i1 #intercept and slope for each twin</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~b1*s1</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~a2*i2</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="st">s2~~b2*s2</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="st">#COVARIANCES LATENT FACTORS</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="st">#intra twin</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~d1*s1 #covariance intercept-slope</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~d2*s2</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="st">#between twin</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~g*i2 #between intercepts</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~h*s2 #between slopes</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~j*s2 #intercept slope one way</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~k*s1 #intercept slope the other way</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="st">#RESIDUAL VARIANCES</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~p1*XA1 #residual variances are different for Twin1 and 2 at each time</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~q1*XB1</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~r1*XC1</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~s1*XD1</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="st">XA2~~p2*XA2</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="st">XB2~~q2*XB2</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a><span class="st">XC2~~r2*XC2</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a><span class="st">XD2~~s2*XD2</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="st">#MEANS OF OBSERVED VARIABLES FIXED TO 0 (captured by i and s)</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a><span class="st">XA1 + XB1 + XC1+ XD1~0*1</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a><span class="st">XA2 + XB2 + XC2+ XD2~0*1</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a><span class="st">#CORRELATED CROSS TWINS RESIDUAL ERRORS</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~XA2</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~XB2</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~XC2</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~XD2 </span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="st">#define quantities of interest</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a><span class="st">diffint :=  m1-m2</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a><span class="st">diffslope := n1-n2</span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>LGFitis <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModis, <span class="at">data=</span>mergedtwin,<span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitis,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>estimates1<span class="ot">&lt;-</span><span class="fu">parameterestimates</span>(LGFitis)</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>fit.boot <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModis, <span class="at">data =</span> mergedtwin, <span class="at">missing =</span><span class="st">&quot;FIML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>conint<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">standardized =</span> T) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conint)</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a><span class="co">#diffint:  -0.851   -0.556</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a><span class="co">#diffslope: 0.012    0.062</span></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a><span class="co">#when interpreting data, twin1 =heavier, twin2=lighter</span></span></code></pre></div>
</div>
<div id="quadratic-model" class="section level3">
<h3>Quadratic Model</h3>
<p>Fit the LGFitisq model (a quadratic model, note the q components in the lavaan script) and compared with LGFitis model (the previous linear model fitted)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">###################### Total ADHD: quadratic model for comparison####################################</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>LGModisq <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">#GROWTH Twin 1 and 2</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="st">i1 =~ 1*XA1 + 1*XB1 + 1*XC1 + 1*XD1  </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ 0*XA1 + 3.4*XB1 + 6.1*XC1 + 8.5*XD1 </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="st">q1 =~ 0*XA1 + 11.56*XB1+ 37.21*XC1 + 72.25*XD1   </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="st">i2 =~ 1*XA2 + 1*XB2 + 1*XC2 + 1*XD2  </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ 0*XA2 + 3.4*XB2 + 6.1*XC2 + 8.5*XD2 </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="st">q2 =~ 0*XA2 + 11.56*XB2+ 37.21*XC2 + 72.25*XD2  </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="st"># #MEANS OF LATENT FACTORS/intercepts</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="st">i1~m1*1  #twins are different and not random, hence different parameters for i1 amd i2, s1 and s2 etc.</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="st">s1~n1*1</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="st">q1~v1*1</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="st">i2~m2*1</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="st">s2~n2*1</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="st">q2~v2*1</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="st">#VAR LATENT FACTORS</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~a1*i1 #intercept and slope for each twin</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~b1*s1</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="st">#q1~~c1*q1</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~a2*i2</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="st">s2~~b2*s2</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="st">#q2~~c2*q2</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="st">#COVARIANCES LATENT FACTORS</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="st">#intra twin</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~d1*s1 #covariance intercept-slope</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="st">#i1~~e1*q1 #covariance between intercept and quadratic component</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="st">#q1~~f1*s1 #covariance between linear and quadratic component is needed</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~d2*s2</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="st">#i2~~e2*q2</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="st">#q2~~f2*s2</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="st">#between twin</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~g*i2 #between intercepts</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~h*s2 #between slopes</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="st">#q1~~i*q2 #between slopes with quadratic component</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~j*s2 #intercept slope one way</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~k*s1 #intercept slope the other way</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="st">#i1~~l*q2</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="st">#i2~~t*q1</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="st">#RESIDUAL VARIANCES</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~p1*XA1 #residual variances are different for Twin1 and 2 at each time</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~q1*XB1</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~r1*XC1</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~s1*XD1</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="st">XA2~~p2*XA2</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="st">XB2~~q2*XB2</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="st">XC2~~r2*XC2</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="st">XD2~~s2*XD2</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="st">#MEANS OF OBSERVED VARIABLES FIXED TO 0 (captured by i and s)</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a><span class="st">XA1 + XB1 + XC1+ XD1~0*1</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="st">XA2 + XB2 + XC2+ XD2~0*1</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a><span class="st">#CORRELATED CROSS TWINS RESIDUAL ERRORS</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~XA2</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~XB2</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~XC2</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~XD2 </span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a><span class="st">#define quantities of interest</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a><span class="st">diffint :=  m1-m2</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a><span class="st">diffslope := n1-n2</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>LGFitisq <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisq, <span class="at">data=</span>mergedtwin,<span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisq,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="co">#compare the fitness between linear and quadratic models</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(LGFitis,LGFitisq) <span class="co">#makes an important difference to add the quadratic component</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>estimates2<span class="ot">&lt;-</span><span class="fu">parameterestimates</span>(LGFitisq)</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>fit.boot2 <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisq, <span class="at">data =</span> mergedtwin, <span class="at">missing =</span><span class="st">&quot;FIML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>conint2<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot2,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">standardized =</span> T) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>lower.ci.int2<span class="ot">=</span>conint2<span class="sc">$</span>ci.lower[<span class="dv">51</span>]</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>upper.ci.int2<span class="ot">=</span>conint2<span class="sc">$</span>ci.upper[<span class="dv">51</span>]</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>lower.ci.slope2<span class="ot">=</span>conint2<span class="sc">$</span>ci.lower[<span class="dv">52</span>]</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>upper.ci.slope2<span class="ot">=</span>conint2<span class="sc">$</span>ci.upper[<span class="dv">52</span>]</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a><span class="co">#diffint: -0.843   -0.545</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a><span class="co">#diffslope: -0.008    0.123</span></span></code></pre></div>
</div>
<div id="constrained-quadratic-model" class="section level3">
<h3>Constrained Quadratic Model</h3>
<p>Fit the LGFitisq2 model (constrained quadratic model, note the fixed q components in lavaan script) and compared with LGFitisq model (prevuously fitted quadratic model without constraints)</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">############# Total ADHD: quadratic model with quadratic parameters constrained to be equal for twin one and twin 2 ###### </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#labels for both twins is v1 instead of v1 and v2 (as compared to the previous model)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>LGModisq2 <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="st">#GROWTH Twin 1 and 2</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="st">i1 =~ 1*XA1 + 1*XB1 + 1*XC1 + 1*XD1  </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ 0*XA1 + 3.4*XB1 + 6.1*XC1 + 8.5*XD1 </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="st">q1 =~ 0*XA1 + 11.56*XB1+ 37.21*XC1 + 72.25*XD1   </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="st">i2 =~ 1*XA2 + 1*XB2 + 1*XC2 + 1*XD2  </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ 0*XA2 + 3.4*XB2 + 6.1*XC2 + 8.5*XD2 </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="st">q2 =~ 0*XA2 + 11.56*XB2+ 37.21*XC2 + 72.25*XD2 </span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="st"># #MEANS OF LATENT FACTORS/intercepts</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="st">i1~m1*1  #twins are different and not random, hence different parameters for i1 amd i2, s1 and s2 etc.</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="st">s1~n1*1</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="st">q1~v1*1 #note v1 for both q1 and q2</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="st">i2~m2*1</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="st">s2~n2*1</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="st">q2~v1*1 #note v1 for both q1 and q2</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="st">#VAR LATENT FACTORS</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~a1*i1 #intercept and slope for each twin</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~b1*s1</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~a2*i2</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="st">s2~~b2*s2</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="st">#COVARIANCES LATENT FACTORS</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="st">#intra twin</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~d1*s1 #covariance intercept-slope</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~d2*s2</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="st">#between twin</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~g*i2 #between intercepts</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~h*s2 #between slopes</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~j*s2 #intercept slope one way</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~k*s1 #intercept slope the other way</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="st">#RESIDUAL VARIANCES</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~p1*XA1 #residual variances are different for Twin1 and 2 at each time</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~q1*XB1</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~r1*XC1</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~s1*XD1</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="st">XA2~~p2*XA2</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="st">XB2~~q2*XB2</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="st">XC2~~r2*XC2</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="st">XD2~~s2*XD2</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a><span class="st">#MEANS OF OBSERVED VARIABLES FIXED TO 0 (captured by i and s)</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="st">XA1 + XB1 + XC1+ XD1~0*1</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a><span class="st">XA2 + XB2 + XC2+ XD2~0*1</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a><span class="st">#CORRELATED CROSS TWINS RESIDUAL ERRORS</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~XA2</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~XB2</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~XC2</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~XD2 </span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a><span class="st">#define quantities of interest</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a><span class="st">diffint :=  m1-m2</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a><span class="st">diffslope := n1-n2</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>LGFitisq2 <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisq2, <span class="at">data=</span>mergedtwin,<span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisq2,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(LGFitisq,LGFitisq2) <span class="co">#when constraining variances of the quadratic parameters to be equal, the fit worsens but just a bit</span></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>fit.boot3 <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisq2, <span class="at">data =</span> mergedtwin, <span class="at">missing =</span><span class="st">&quot;FIML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>conint3<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot3,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">standardized =</span> T) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a><span class="co">#Bootstrapped 95% CIs:</span></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a><span class="co">#diffint: -0.825   -0.539</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a><span class="co">#diffslope: 0.012    0.060</span></span></code></pre></div>
</div>
<div id="inversed-slope-model" class="section level3">
<h3>Inversed Slope Model</h3>
<p>Fit the LGFitisqI model (inversed slope model) to test significance of intercept at the final time point, the slopes in the model were inversed, i.e. slope at age 16 were used for age 8, such that the intercept (the beginning) is age 16, then age 14, 12 and 8.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">########################  Total ADHD: Model with inversed slope to test significance of intercept at XD ########################################</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>LGModisqI <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="st">#GROWTH Twin 1 and 2</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">i1 =~ 1*XA1 + 1*XB1 + 1*XC1 + 1*XD1  </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ 8.5*XA1 + 6.1*XB1 + 3.4*XC1 + 0*XD1 </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="st">q1 =~ 72.25*XA1 + 37.21*XB1+ 11.56*XC1 + 0*XD1   </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="st">i2 =~ 1*XA2 + 1*XB2 + 1*XC2 + 1*XD2  </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ 8.5*XA2 + 6.1*XB2 + 3.4*XC2 + 0*XD2 </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="st">q2 =~ 72.25*XA2 + 37.21*XB2+ 11.56*XC2 + 0*XD2  </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="st"># #MEANS OF LATENT FACTORS/intercepts</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="st">i1~m1*1  #twins are different and not random, hence different parameters for i1 amd i2, s1 and s2 etc.</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="st">s1~n1*1</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="st">q1~v1*1</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="st">i2~m2*1</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="st">s2~n2*1</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="st">q2~v2*1</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="st">#VAR LATENT FACTORS</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~a1*i1 #intercept and slope for each twin</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~b1*s1</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~a2*i2</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="st">s2~~b2*s2</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="st">#COVARIANCES LATENT FACTORS</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="st">#intra twin</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~d1*s1 #covariance intercept-slope</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~d2*s2</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="st">#between twin</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~g*i2 #between intercepts</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~h*s2 #between slopes</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~j*s2 #intercept slope one way</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~k*s1 #intercept slope the other way</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="st">#RESIDUAL VARIANCES</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~p1*XA1 #residual variances are different for Twin1 and 2 at each time</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~q1*XB1</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~r1*XC1</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~s1*XD1</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="st">XA2~~p2*XA2</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="st">XB2~~q2*XB2</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="st">XC2~~r2*XC2</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="st">XD2~~s2*XD2</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="st">#MEANS OF OBSERVED VARIABLES FIXED TO 0 (captured by i and s)</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="st">XA1 + XB1 + XC1+ XD1~0*1</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a><span class="st">XA2 + XB2 + XC2+ XD2~0*1</span></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="st">#CORRELATED CROSS TWINS RESIDUAL ERRORS</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~XA2</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~XB2</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~XC2</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~XD2 </span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="st">#define quantities of interest</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="st">diffint :=  m1-m2</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a><span class="st">diffslope := n1-n2</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>LGFitisqI <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqI, <span class="at">data=</span>mergedtwin,<span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisqI,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>fit.boot4 <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqI, <span class="at">data =</span> mergedtwin, <span class="at">missing =</span><span class="st">&quot;FIML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>conint4<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot4,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">standardized =</span> T) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a><span class="do">##as you can see, the effect is still significant at the end but about 40% smaller. </span></span></code></pre></div>
</div>
<div id="model-for-end-intercept" class="section level3">
<h3>Model for End Intercept</h3>
<p>This model recovers the intercept at age 16 to get the 95 CIs using diffint16, technically we don’t need the inversed slope model anymore because we figured out using diffint16 to get the CIs. The model specified here is the final model we use.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">######### Total ADHD: Model trying to recover the end intercept parameter######</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mean at age 16 becomes the intercept</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>LGModisqf <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="st">#GROWTH Twin 1 and 2</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="st">i1 =~ 1*XA1 + 1*XB1 + 1*XC1 + 1*XD1  </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ 0*XA1 + 3.4*XB1 + 6.1*XC1 + 8.5*XD1 </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="st">q1 =~ 0*XA1 + 11.56*XB1+ 37.21*XC1 + 72.25*XD1  </span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="st">i2 =~ 1*XA2 + 1*XB2 + 1*XC2 + 1*XD2  </span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ 0*XA2 + 3.4*XB2 + 6.1*XC2 + 8.5*XD2 </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="st">q2 =~ 0*XA2 + 11.56*XB2+ 37.21*XC2 + 72.25*XD2  </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="st"># #MEANS OF LATENT FACTORS/intercepts</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="st">i1~m1*1  #twins are different and not random, hence different parameters for i1 amd i2, s1 and s2 etc.</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="st">s1~n1*1</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="st">q1~v1*1</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="st">i2~m2*1</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="st">s2~n2*1</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="st">q2~v2*1</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="st">#VAR LATENT FACTORS</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~a1*i1 #intercept and slope for each twin</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~b1*s1</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~a2*i2</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="st">s2~~b2*s2</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="st">#COVARIANCES LATENT FACTORS</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="st">#intra twin</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~d1*s1 #covariance intercept-slope</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~d2*s2</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="st">#between twin</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~g*i2 #between intercepts</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~h*s2 #between slopes</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~j*s2 #intercept slope one way</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~k*s1 #intercept slope the other way</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="st">#RESIDUAL VARIANCES</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~p1*XA1 #residual variances are different for Twin1 and 2 at each time</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~q1*XB1</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~r1*XC1</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~s1*XD1</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="st">XA2~~p2*XA2</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="st">XB2~~q2*XB2</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="st">XC2~~r2*XC2</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="st">XD2~~s2*XD2</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a><span class="st">#MEANS OF OBSERVED VARIABLES FIXED TO 0 (captured by i and s)</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="st">XA1 + XB1 + XC1+ XD1~0*1</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a><span class="st">XA2 + XB2 + XC2+ XD2~0*1</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a><span class="st">#CORRELATED CROSS TWINS RESIDUAL ERRORS</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~XA2</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~XB2</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~XC2</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~XD2 </span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a><span class="st">#define quantities of interest</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a><span class="st">diffint :=  m1-m2</span></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a><span class="st">diffslope := n1-n2</span></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="st">i16t1 := m1+ 8.5*n1+72.25*v1 #intercept at 16 for twin 1</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a><span class="st">i16t2 := m2+ 8.5*n2+72.25*v2 #intercept at 16 for twin 2</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a><span class="st">diffint16:=i16t1 -i16t2 #difference in intercept at age 16</span></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a><span class="st">diffdiff:= diffint -diffint16 #difference of the differences, i.e. is the decrease in the distance between twin is significant, be careful to do the proper operation here so that the sign and the magnitude of this difference makes sense, </span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>LGFitisqf <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqf, <span class="at">data=</span>mergedtwin,<span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisqf,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>fit.boot5 <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqf, <span class="at">data =</span> mergedtwin, <span class="at">missing =</span><span class="st">&quot;FIML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>conint5<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot5,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">standardized =</span> T) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>xlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(conint5, <span class="at">file=</span><span class="st">&quot;total ADHD.xlsx&quot;</span>,<span class="at">sheetName=</span><span class="st">&quot;Sheet1&quot;</span>)</span></code></pre></div>
</div>
<div id="plot-graph" class="section level3">
<h3>Plot Graph</h3>
<p>This code chunk shows the syntax we used to plot Figure 1, but instead of using solid vs dash lines, they were in different colours (red and blue). I think we changed the lines at the last minute due to printing cost issue, but I can’t find the script used for solid vs dash lines.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## Total ADHD: plot a new graph -- real and expected data points.#######</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#predicted data at ages 7.9,11.3,14.0 and 16.4: </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#rename twin1 and twin2 --&gt; these are empirical data</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#add predicted data into two new columns</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>twin1_pred<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">4</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>twin2_pred<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">4</span>))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisq,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>estimates.LGFitisq<span class="ot">&lt;-</span><span class="fu">parameterestimates</span>(LGFitisq)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>estimate_t1<span class="ot">&lt;-</span>estimates.LGFitisq<span class="sc">$</span>est[<span class="dv">25</span>]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>slope_t1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">3.4</span>,<span class="fl">6.1</span>,<span class="fl">8.5</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>sloading_t1<span class="ot">&lt;-</span>estimates.LGFitisq<span class="sc">$</span>est[<span class="dv">26</span>]</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>qslope_t1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">11.56</span>,<span class="fl">37.21</span>,<span class="fl">72.25</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>qloading_t1<span class="ot">&lt;-</span>estimates.LGFitisq<span class="sc">$</span>est[<span class="dv">27</span>]</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#twin1 predicted data</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>twin1_pred<span class="ot">=</span>estimate_t1<span class="sc">+</span>(slope_t1<span class="sc">*</span>sloading_t1)<span class="sc">+</span>(qslope_t1<span class="sc">*</span>qloading_t1)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>twin1_pred_ci_upper<span class="ot">=</span><span class="fl">11.07</span><span class="sc">+</span>(slope_t1<span class="sc">*-</span><span class="fl">0.0798</span>)<span class="sc">+</span>(qslope_t1<span class="sc">*-</span><span class="fl">0.0325</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>twin1_pred_ci_lower<span class="ot">=</span><span class="fl">10.55</span><span class="sc">+</span>(slope_t1<span class="sc">*-</span><span class="fl">0.2530</span>)<span class="sc">+</span>(qslope_t1<span class="sc">*-</span><span class="fl">0.0513</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co">#twin2 predicted data</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>estimate_t2<span class="ot">&lt;-</span>estimates.LGFitisq<span class="sc">$</span>est[<span class="dv">28</span>]</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>slope_t2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">3.4</span>,<span class="fl">6.1</span>,<span class="fl">8.5</span>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>sloading_t2<span class="ot">&lt;-</span>estimates.LGFitisq<span class="sc">$</span>est[<span class="dv">29</span>]</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>qslope_t2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">11.56</span>,<span class="fl">37.21</span>,<span class="fl">72.25</span>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>qloading_t2<span class="ot">&lt;-</span>estimates.LGFitisq<span class="sc">$</span>est[<span class="dv">30</span>]</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>twin2_pred<span class="ot">=</span>estimate_t2<span class="sc">+</span>(slope_t2<span class="sc">*</span>sloading_t2)<span class="sc">+</span>(qslope_t2<span class="sc">*</span>qloading_t2)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>twin2_pred_ci_upper<span class="ot">=</span><span class="fl">11.78</span><span class="sc">+</span>(slope_t2<span class="sc">*-</span><span class="fl">0.129</span>)<span class="sc">+</span>(qslope_t2<span class="sc">*-</span><span class="fl">0.0295</span>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>twin2_pred_ci_lower<span class="ot">=</span><span class="fl">11.23</span><span class="sc">+</span>(slope_t2<span class="sc">*-</span><span class="fl">0.314</span>)<span class="sc">+</span>(qslope_t2<span class="sc">*-</span><span class="fl">0.0495</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>twin1_b<span class="ot">=</span><span class="fu">cbind</span>(mergedtwin<span class="sc">$</span>hconnt1,mergedtwin<span class="sc">$</span>lpconnt1,mergedtwin<span class="sc">$</span>npconnt1,mergedtwin<span class="sc">$</span>ppbhconnt1)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>twin2_b<span class="ot">=</span><span class="fu">cbind</span>(mergedtwin<span class="sc">$</span>hconnt2,mergedtwin<span class="sc">$</span>lpconnt2,mergedtwin<span class="sc">$</span>npconnt2,mergedtwin<span class="sc">$</span>ppbhconnt2)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>twin1_emp<span class="ot">=</span><span class="fu">colMeans</span>(twin1_b,<span class="at">na.rm=</span>T)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>twin2_emp<span class="ot">=</span><span class="fu">colMeans</span>(twin2_b,<span class="at">na.rm=</span>T)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>twin1_imputed <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(twin1_b), <span class="fu">colMeans</span>(twin1_b, <span class="at">na.rm=</span><span class="cn">TRUE</span>), twin1_b))</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>twin2_imputed <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(twin2_b), <span class="fu">colMeans</span>(twin2_b, <span class="at">na.rm=</span><span class="cn">TRUE</span>), twin2_b))</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>twin1_imputedm <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(twin1_b), <span class="fu">colMedians</span>(twin1_b, <span class="at">na.rm=</span><span class="cn">TRUE</span>), twin1_b))</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>twin2_imputedm <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(twin2_b), <span class="fu">colMedians</span>(twin2_b, <span class="at">na.rm=</span><span class="cn">TRUE</span>), twin2_b))</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>estimateddata<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">AGE=</span><span class="fu">c</span>(<span class="fl">7.9</span>,<span class="fl">11.3</span>,<span class="fl">14.0</span>,<span class="fl">16.4</span>),</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>                         twin1_emp,</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>                         twin2_emp,</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>                         twin1_pred,</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>                         twin2_pred,</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>                         twin1_pred_ci_upper,</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>                         twin1_pred_ci_lower,</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>                         twin2_pred_ci_upper,</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>                         twin2_pred_ci_lower)</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>estimateddata</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>phyp2 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(estimateddata, <span class="fu">aes</span>(AGE,<span class="fu">c</span>(twin1_emp,twin2_emp,twin1_pred,twin2_pred)))<span class="sc">+</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> twin1_pred, <span class="at">colour =</span> <span class="st">&quot;Heavier Twins&quot;</span>))<span class="sc">+</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> twin2_pred, <span class="at">colour =</span> <span class="st">&quot;Lighter Twins&quot;</span>))<span class="sc">+</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;&quot;</span>,<span class="at">x =</span> <span class="st">&quot;Age in Years&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Parent ADHD ratings&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">&quot;&quot;</span>, </span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Heavier Twins&quot;</span>, <span class="st">&quot;Lighter Twins&quot;</span>),</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>),</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>),</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>),</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">7.5</span>,<span class="fl">16.5</span>), <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">13</span>))</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>phyp2<span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">7.9</span>,<span class="fl">11.3</span>,<span class="fl">14.0</span>,<span class="fl">16.4</span>), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;longdash&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="Total%20ADHD%20Big.jpeg" alt="" />
<p class="caption">Figure 1</p>
</div>
<p>We also plotted similar graphs for inattention and hyperactivity/impulsivity symptoms, which are Figure S1 and S2 in supplementary materials:</p>
<p>Figure S1:</p>
<div class="figure">
<img src="Inattention%20Big.jpeg" alt="" />
<p class="caption">FigureS1</p>
</div>
<p>Figure S2:</p>
<div class="figure">
<img src="Hyperactivity%20Big.jpeg" alt="" />
<p class="caption">FigureS2</p>
</div>
</div>
<div id="constraining-slopes" class="section level3">
<h3>Constraining Slopes</h3>
<p>In this code chunk we constrain the slopes of t1 and t2 to be the same, i.e. same variance. We then compared these constrained models with non-constrained models. The results were not reported in the paper.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## Total ADHD: testing the significance of difference between constrained and unconstrained models for slopes ######</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with constrained slopes. This model will be compared with the previous quadratic model for chi-square difference</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>LGModisq_constrained <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">#GROWTH Twin 1 and 2</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="st">i1 =~ 1*XA1 + 1*XB1 + 1*XC1 + 1*XD1  </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ 0*XA1 + 3.4*XB1 + 6.1*XC1 + 8.5*XD1 </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="st">q1 =~ 0*XA1 + 11.56*XB1+ 37.21*XC1 + 72.25*XD1  </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="st">i2 =~ 1*XA2 + 1*XB2 + 1*XC2 + 1*XD2  </span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ 0*XA2 + 3.4*XB2 + 6.1*XC2 + 8.5*XD2 </span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="st">q2 =~ 0*XA2 + 11.56*XB2+ 37.21*XC2 + 72.25*XD2  </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st"># #MEANS OF LATENT FACTORS/intercepts</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">i1~m1*1  #twins are different and not random, hence different parameters for i1 amd i2, s1 and s2 etc.</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="st">s1~n*1</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="st">q1~v*1 </span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="st">i2~m2*1</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="st">s2~n*1</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="st">q2~v*1</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="st">#VAR LATENT FACTORS</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~a1*i1 #intercept and slope for each twin</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~b*s1 # slopes constrained to be the same</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~a2*i2</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="st">s2~~b*s2 # slopes constrained to be the same</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="st">#COVARIANCES LATENT FACTORS</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="st">#intra twin</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~d1*s1 #covariance intercept-slope</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~d2*s2</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="st">#between twin</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~g*i2 #between intercepts</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~h*s2 #between slopes</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~j*s2 #intercept slope one way</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~k*s1 #intercept slope the other way</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a><span class="st">#RESIDUAL VARIANCES</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~p1*XA1 #residual variances are different for Twin1 and 2 at each time</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~q1*XB1</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~r1*XC1</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~s1*XD1</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a><span class="st">XA2~~p2*XA2</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a><span class="st">XB2~~q2*XB2</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a><span class="st">XC2~~r2*XC2</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a><span class="st">XD2~~s2*XD2</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a><span class="st">#MEANS OF OBSERVED VARIABLES FIXED TO 0 (captured by i and s)</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a><span class="st">XA1 + XB1 + XC1+ XD1~0*1</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a><span class="st">XA2 + XB2 + XC2+ XD2~0*1</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a><span class="st">#CORRELATED CROSS TWINS RESIDUAL ERRORS</span></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~XA2</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~XB2</span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~XC2</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~XD2 </span></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>LGFitisq_constrained <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisq_constrained, <span class="at">data=</span>mergedtwin,<span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisq_constrained,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisq,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(LGFitisq_constrained,LGFitisq) <span class="co">#makes an important difference to add the quadratic component</span></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a><span class="do">#### results of chi sq test for total ADHD, Inattention and Impulsivity ####</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi Square Difference Test</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a><span class="co">#                      Df    AIC    BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)  </span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="co"># LGFitisq             16 161543 161726 212.75                                </span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a><span class="co"># LGFitisq_constrained 19 161548 161711 223.39     10.636       3    0.01387 *</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a><span class="co">#   ---</span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a><span class="co">#   Signif. codes:  0 ?**?0.001 ?*?0.01 ??0.05 ??0.1 ??1</span></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a><span class="co"># effect of growth paraneters</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a><span class="do">###   Inattention</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi Square Difference Test</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a><span class="co">#                      Df    AIC    BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)  </span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a><span class="co"># LGFitisq             16 138613 138796 215.98                                </span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a><span class="co"># LGFitisq_constrained 19 138615 138778 223.74     7.7556       3    0.05134 .</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a><span class="co">#   Signif. codes:  0 ?**?0.001 ?*?0.01 ??0.05 ??0.1 ??1</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a><span class="do">###  Hyperactivity/impulsivity</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi Square Difference Test</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a><span class="co">#                      Df    AIC    BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)   </span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a><span class="co"># LGFitisq             16 125590 125773 170.03                                 </span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a><span class="co"># LGFitisq_constrained 19 125597 125760 183.53     13.504       3   0.003664 **</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a><span class="co">#   ---</span></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a><span class="co">#   Signif. codes:  0 ?**?0.001 ?*?0.01 ??0.05 ??0.1 ??1</span></span></code></pre></div>
</div>
</div>
<div id="final-lgm-syntax-used" class="section level2">
<h2>Final LGM Syntax Used</h2>
<p>This code chunk was used to generate the results in the paper: Table 2 and Table S10</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select MZ twins who at least have one adhd measure at any point of life, and have birth weight data. </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#for CPRS total at ages 8, 12, 14 and 16. </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#arkidgr1/2 = birth weight</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#hconnt1/2= cprs measure at age 8</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#lpconnt1/2 = age 12</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#npconnt1/2 = age 14</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#ppbhconnt1/2 = age 16</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#select MZ twins only</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>adhddatamz<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                         ((<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconnt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint2))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconnt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint2))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconnt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint2))</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                          <span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt2))<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat2))) <span class="sc">&amp;</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                         adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span>(adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span>),]</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">#select MZ twins with  complete data at all time points</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>adhddatamz2<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>                          ((<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconnt2))<span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit2))<span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint2))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconnt2))<span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit2))<span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint2))</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconnt2))<span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit2))<span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint2))</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnt2))<span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt2))<span class="sc">&amp;</span>(<span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat2))) </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">&amp;</span> adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">&amp;</span>(adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span>),]</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="co">#have to first divide the twins into 2 groups.</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>highBW<span class="ot">=</span>adhddatamz[adhddatamz<span class="sc">$</span>arkidgr1<span class="sc">&gt;</span>adhddatamz<span class="sc">$</span>arkidgr2,]</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>lowBW<span class="ot">=</span>adhddatamz[adhddatamz<span class="sc">$</span>arkidgr2<span class="sc">&gt;</span>adhddatamz<span class="sc">$</span>arkidgr1,]</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="co">#check if bwt1&gt;bwt2</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>((highBW<span class="sc">$</span>arkidgr1),(highBW<span class="sc">$</span>arkidgr2)))</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="co">#rename twin 1 in low 1 as twin 2 and twin 2 =twin 1</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="co">#hence twin 1 will always have higher birthweight</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>lowBW<span class="ot">=</span><span class="fu">rename</span>(lowBW, <span class="fu">c</span>(<span class="st">&quot;arkidgr1&quot;</span><span class="ot">=</span><span class="st">&quot;arkidgr2&quot;</span>, <span class="st">&quot;arkidgr2&quot;</span><span class="ot">=</span><span class="st">&quot;arkidgr1&quot;</span>, <span class="st">&quot;hconnt1&quot;</span><span class="ot">=</span><span class="st">&quot;hconnt2&quot;</span>,<span class="st">&quot;hconnt2&quot;</span><span class="ot">=</span><span class="st">&quot;hconnt1&quot;</span>, <span class="st">&quot;lpconnt1&quot;</span><span class="ot">=</span><span class="st">&quot;lpconnt2&quot;</span>, </span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lpconnt2&quot;</span><span class="ot">=</span><span class="st">&quot;lpconnt1&quot;</span>, <span class="st">&quot;npconnt1&quot;</span><span class="ot">=</span><span class="st">&quot;npconnt2&quot;</span>,<span class="st">&quot;npconnt2&quot;</span><span class="ot">=</span><span class="st">&quot;npconnt1&quot;</span>,<span class="st">&quot;ppbhconnt1&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconnt2&quot;</span>,<span class="st">&quot;ppbhconnt2&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconnt1&quot;</span>,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;hconhit1&quot;</span><span class="ot">=</span><span class="st">&quot;hconhit2&quot;</span>,<span class="st">&quot;hconhit2&quot;</span><span class="ot">=</span><span class="st">&quot;hconhit1&quot;</span>, <span class="st">&quot;lpconhit1&quot;</span><span class="ot">=</span><span class="st">&quot;lpconhit2&quot;</span>, </span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lpconhit2&quot;</span><span class="ot">=</span><span class="st">&quot;lpconhit1&quot;</span>, <span class="st">&quot;npconhit1&quot;</span><span class="ot">=</span><span class="st">&quot;npconhit2&quot;</span>,<span class="st">&quot;npconhit2&quot;</span><span class="ot">=</span><span class="st">&quot;npconhit1&quot;</span>,<span class="st">&quot;ppbhconnimpt1&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconnimpt2&quot;</span>,<span class="st">&quot;ppbhconnimpt2&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconnimpt1&quot;</span>,</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;hconint1&quot;</span><span class="ot">=</span><span class="st">&quot;hconint2&quot;</span>,<span class="st">&quot;hconint2&quot;</span><span class="ot">=</span><span class="st">&quot;hconint1&quot;</span>, <span class="st">&quot;lpconint1&quot;</span><span class="ot">=</span><span class="st">&quot;lpconint2&quot;</span>, </span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;lpconint2&quot;</span><span class="ot">=</span><span class="st">&quot;lpconint1&quot;</span>, <span class="st">&quot;npconint1&quot;</span><span class="ot">=</span><span class="st">&quot;npconint2&quot;</span>,<span class="st">&quot;npconint2&quot;</span><span class="ot">=</span><span class="st">&quot;npconint1&quot;</span>,<span class="st">&quot;ppbhconninat1&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconninat2&quot;</span>,<span class="st">&quot;ppbhconninat2&quot;</span><span class="ot">=</span><span class="st">&quot;ppbhconninat1&quot;</span>))</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="co">#check if bwt1&gt;bwt2 in new lowBW data</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>((lowBW<span class="sc">$</span>arkidgr1),(lowBW<span class="sc">$</span>arkidgr2)))</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="co">#merged twin= twin 1 birth weight is always heavier</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>mergedtwin<span class="ot">=</span><span class="fu">rbind</span>(highBW,lowBW)</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a><span class="co">#check if correct. If BW of T1 always &gt; T2, then all signs will be positive, which is =1. Table will show all signs as 1.</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">sign</span>(mergedtwin<span class="sc">$</span>arkidgr1<span class="sc">-</span>mergedtwin<span class="sc">$</span>arkidgr2),<span class="at">useNA=</span><span class="st">&quot;always&quot;</span>) <span class="co">#twin1 is always heavier than twin2</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a><span class="co">#mean age of twins at 8, 12, 14 and 16 time points</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mergedtwin<span class="sc">$</span>hage,<span class="at">na.rm=</span>T) <span class="co">#7.9</span></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mergedtwin<span class="sc">$</span>lpqage,<span class="at">na.rm=</span>T) <span class="co">#11.3</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mergedtwin<span class="sc">$</span>npqage,<span class="at">na.rm=</span>T) <span class="co">#14.0</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mergedtwin<span class="sc">$</span>ppbhage,<span class="at">na.rm=</span>T) <span class="co">#16.4</span></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="co">#twin 1 = high birth weight</span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>hypdataplot<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">AGE=</span><span class="fu">c</span>(<span class="fl">7.9</span>,<span class="fl">11.3</span>,<span class="fl">14.0</span>,<span class="fl">16.4</span>),</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>                       <span class="at">twin1=</span><span class="fu">colMeans</span>(mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;hconnt1&quot;</span>,<span class="st">&quot;lpconnt1&quot;</span>,<span class="st">&quot;npconnt1&quot;</span>,<span class="st">&quot;ppbhconnt1&quot;</span>)],<span class="at">na.rm=</span>T),</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>                       <span class="at">twin2=</span><span class="fu">colMeans</span>(mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;hconnt2&quot;</span>,<span class="st">&quot;lpconnt2&quot;</span>,<span class="st">&quot;npconnt2&quot;</span>,<span class="st">&quot;ppbhconnt2&quot;</span>)],<span class="at">na.rm=</span>T))</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>    <span class="do">##### Bootstrapped Estimates for Total ADHD ######</span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>ObsVarTwin1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hconnt1&quot;</span>,<span class="st">&quot;lpconnt1&quot;</span>,<span class="st">&quot;npconnt1&quot;</span>,<span class="st">&quot;ppbhconnt1&quot;</span>)  </span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>ObsVarTwin2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hconnt2&quot;</span>,<span class="st">&quot;lpconnt2&quot;</span>,<span class="st">&quot;npconnt2&quot;</span>,<span class="st">&quot;ppbhconnt2&quot;</span>)</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XB1&quot;</span>,<span class="st">&quot;XC1&quot;</span>,<span class="st">&quot;XD1&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>; mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XB1&quot;</span>,<span class="st">&quot;XC1&quot;</span>,<span class="st">&quot;XD1&quot;</span>)]<span class="ot">=</span>mergedtwin[,ObsVarTwin1]</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA2&quot;</span>,<span class="st">&quot;XB2&quot;</span>,<span class="st">&quot;XC2&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>; mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA2&quot;</span>,<span class="st">&quot;XB2&quot;</span>,<span class="st">&quot;XC2&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>mergedtwin[,ObsVarTwin2]</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>LGModisqf <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a><span class="st">#GROWTH Twin 1 and 2</span></span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a><span class="st">i1 =~ 1*XA1 + 1*XB1 + 1*XC1 + 1*XD1  </span></span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ 0*XA1 + 3.4*XB1 + 6.1*XC1 + 8.5*XD1 </span></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a><span class="st">q1 =~ 0*XA1 + 11.56*XB1+ 37.21*XC1 + 72.25*XD1   #quadratic component, silenced if it returns NaNs.</span></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a><span class="st">i2 =~ 1*XA2 + 1*XB2 + 1*XC2 + 1*XD2  </span></span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ 0*XA2 + 3.4*XB2 + 6.1*XC2 + 8.5*XD2 </span></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a><span class="st">q2 =~ 0*XA2 + 11.56*XB2+ 37.21*XC2 + 72.25*XD2  #quadratic component, silenced if it returns NaNs.</span></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a><span class="st"># #MEANS OF LATENT FACTORS/intercepts</span></span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a><span class="st">i1~m1*1  #twins are different and not random, hence different parameters for i1 amd i2, s1 and s2 etc.</span></span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a><span class="st">s1~n1*1</span></span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a><span class="st">q1~v1*1</span></span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a><span class="st">i2~m2*1</span></span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a><span class="st">s2~n2*1</span></span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a><span class="st">q2~v2*1</span></span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a><span class="st">#VAR LATENT FACTORS</span></span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~a1*i1 #intercept and slope for each twin</span></span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~b1*s1</span></span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~a2*i2</span></span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a><span class="st">s2~~b2*s2</span></span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a><span class="st">#COVARIANCES LATENT FACTORS</span></span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a><span class="st">#intra twin</span></span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~d1*s1 #covariance intercept-slope</span></span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~d2*s2</span></span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a><span class="st">#between twin</span></span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~g*i2 #between intercepts</span></span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~h*s2 #between slopes</span></span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~j*s2 #intercept slope one way</span></span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~k*s1 #intercept slope the other way</span></span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a><span class="st">#RESIDUAL VARIANCES</span></span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~p1*XA1 #residual variances are different for Twin1 and 2 at each time</span></span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~q1*XB1</span></span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~r1*XC1</span></span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~s1*XD1</span></span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a><span class="st">XA2~~p2*XA2</span></span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a><span class="st">XB2~~q2*XB2</span></span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a><span class="st">XC2~~r2*XC2</span></span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a><span class="st">XD2~~s2*XD2</span></span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a><span class="st">#MEANS OF OBSERVED VARIABLES FIXED TO 0 (captured by i and s)</span></span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a><span class="st">XA1 + XB1 + XC1+ XD1~0*1</span></span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a><span class="st">XA2 + XB2 + XC2+ XD2~0*1</span></span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a><span class="st">#CORRELATED CROSS TWINS RESIDUAL ERRORS</span></span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~XA2</span></span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~XB2</span></span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~XC2</span></span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~XD2 </span></span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a><span class="st">#define quantities of interest</span></span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a><span class="st">diffint :=  m1-m2</span></span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a><span class="st">diffslope := n1-n2</span></span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a><span class="st">i16t1 := m1+ 8.5*n1+72.25*v1 #intercept at 16 for twin 1</span></span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a><span class="st">i16t2 := m2+ 8.5*n2+72.25*v2 #intercept at 16 for twin 2</span></span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a><span class="st">diffint16:=i16t1 -i16t2 #difference in intercept at age 16</span></span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a><span class="st">diffdiff:= diffint -diffint16 #difference of the differences, i.e. is the decrease in the distance between twin is significant, be careful to do the proper operation here so that the sign and the magnitude of this difference makes sense, </span></span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb19-153"><a href="#cb19-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-154"><a href="#cb19-154" aria-hidden="true" tabindex="-1"></a>LGFitisqf <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqf, <span class="at">data=</span>mergedtwin,<span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb19-155"><a href="#cb19-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-156"><a href="#cb19-156" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisqf,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb19-157"><a href="#cb19-157" aria-hidden="true" tabindex="-1"></a><span class="co">#bootstrapping estimates</span></span>
<span id="cb19-158"><a href="#cb19-158" aria-hidden="true" tabindex="-1"></a>fit.boot5 <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqf, <span class="at">data =</span> mergedtwin, <span class="at">missing =</span><span class="st">&quot;FIML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb19-159"><a href="#cb19-159" aria-hidden="true" tabindex="-1"></a>conint5<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot5,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">standardized =</span> T) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb19-160"><a href="#cb19-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-161"><a href="#cb19-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-162"><a href="#cb19-162" aria-hidden="true" tabindex="-1"></a>xlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(conint5, <span class="at">file=</span><span class="st">&quot;Total ADHD.xlsx&quot;</span>,<span class="at">sheetName=</span><span class="st">&quot;Sheet1&quot;</span>)</span>
<span id="cb19-163"><a href="#cb19-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-164"><a href="#cb19-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-165"><a href="#cb19-165" aria-hidden="true" tabindex="-1"></a><span class="do">###### Bootstrapped Estimates for Hyperactivity #####</span></span>
<span id="cb19-166"><a href="#cb19-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-167"><a href="#cb19-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-168"><a href="#cb19-168" aria-hidden="true" tabindex="-1"></a>ObsVarTwin1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hconhit1&quot;</span>,<span class="st">&quot;lpconhit1&quot;</span>,<span class="st">&quot;npconhit1&quot;</span>, <span class="st">&quot;ppbhconnimpt1&quot;</span>)</span>
<span id="cb19-169"><a href="#cb19-169" aria-hidden="true" tabindex="-1"></a>ObsVarTwin2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hconhit2&quot;</span>,<span class="st">&quot;lpconhit2&quot;</span>,<span class="st">&quot;npconhit2&quot;</span>, <span class="st">&quot;ppbhconnimpt2&quot;</span>)</span>
<span id="cb19-170"><a href="#cb19-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-171"><a href="#cb19-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-172"><a href="#cb19-172" aria-hidden="true" tabindex="-1"></a>mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XB1&quot;</span>,<span class="st">&quot;XC1&quot;</span>,<span class="st">&quot;XD1&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>; mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XB1&quot;</span>,<span class="st">&quot;XC1&quot;</span>,<span class="st">&quot;XD1&quot;</span>)]<span class="ot">=</span>mergedtwin[,ObsVarTwin1]</span>
<span id="cb19-173"><a href="#cb19-173" aria-hidden="true" tabindex="-1"></a>mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA2&quot;</span>,<span class="st">&quot;XB2&quot;</span>,<span class="st">&quot;XC2&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>; mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA2&quot;</span>,<span class="st">&quot;XB2&quot;</span>,<span class="st">&quot;XC2&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>mergedtwin[,ObsVarTwin2]</span>
<span id="cb19-174"><a href="#cb19-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-175"><a href="#cb19-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-176"><a href="#cb19-176" aria-hidden="true" tabindex="-1"></a><span class="co">#twin 1 is the heavier twin, twin 2 is the lighter twin</span></span>
<span id="cb19-177"><a href="#cb19-177" aria-hidden="true" tabindex="-1"></a>LGModisqf <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb19-178"><a href="#cb19-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-179"><a href="#cb19-179" aria-hidden="true" tabindex="-1"></a><span class="st">#GROWTH Twin 1 and 2</span></span>
<span id="cb19-180"><a href="#cb19-180" aria-hidden="true" tabindex="-1"></a><span class="st">i1 =~ 1*XA1 + 1*XB1 + 1*XC1 + 1*XD1  </span></span>
<span id="cb19-181"><a href="#cb19-181" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ 0*XA1 + 3.4*XB1 + 6.1*XC1 + 8.5*XD1 </span></span>
<span id="cb19-182"><a href="#cb19-182" aria-hidden="true" tabindex="-1"></a><span class="st">q1 =~ 0*XA1 + 11.56*XB1+ 37.21*XC1 + 72.25*XD1   #quadratic component, silenced because it returns NaNs.</span></span>
<span id="cb19-183"><a href="#cb19-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-184"><a href="#cb19-184" aria-hidden="true" tabindex="-1"></a><span class="st">i2 =~ 1*XA2 + 1*XB2 + 1*XC2 + 1*XD2  </span></span>
<span id="cb19-185"><a href="#cb19-185" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ 0*XA2 + 3.4*XB2 + 6.1*XC2 + 8.5*XD2 </span></span>
<span id="cb19-186"><a href="#cb19-186" aria-hidden="true" tabindex="-1"></a><span class="st">q2 =~ 0*XA2 + 11.56*XB2+ 37.21*XC2 + 72.25*XD2  #quadratic component, silenced because it returns NaNs.</span></span>
<span id="cb19-187"><a href="#cb19-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-188"><a href="#cb19-188" aria-hidden="true" tabindex="-1"></a><span class="st"># #MEANS OF LATENT FACTORS/intercepts</span></span>
<span id="cb19-189"><a href="#cb19-189" aria-hidden="true" tabindex="-1"></a><span class="st">i1~m1*1  #twins are different and not random, hence different parameters for i1 amd i2, s1 and s2 etc.</span></span>
<span id="cb19-190"><a href="#cb19-190" aria-hidden="true" tabindex="-1"></a><span class="st">s1~n1*1</span></span>
<span id="cb19-191"><a href="#cb19-191" aria-hidden="true" tabindex="-1"></a><span class="st">q1~v1*1</span></span>
<span id="cb19-192"><a href="#cb19-192" aria-hidden="true" tabindex="-1"></a><span class="st">i2~m2*1</span></span>
<span id="cb19-193"><a href="#cb19-193" aria-hidden="true" tabindex="-1"></a><span class="st">s2~n2*1</span></span>
<span id="cb19-194"><a href="#cb19-194" aria-hidden="true" tabindex="-1"></a><span class="st">q2~v2*1</span></span>
<span id="cb19-195"><a href="#cb19-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-196"><a href="#cb19-196" aria-hidden="true" tabindex="-1"></a><span class="st">#VAR LATENT FACTORS</span></span>
<span id="cb19-197"><a href="#cb19-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-198"><a href="#cb19-198" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~a1*i1 #intercept and slope for each twin</span></span>
<span id="cb19-199"><a href="#cb19-199" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~b1*s1</span></span>
<span id="cb19-200"><a href="#cb19-200" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~a2*i2</span></span>
<span id="cb19-201"><a href="#cb19-201" aria-hidden="true" tabindex="-1"></a><span class="st">s2~~b2*s2</span></span>
<span id="cb19-202"><a href="#cb19-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-203"><a href="#cb19-203" aria-hidden="true" tabindex="-1"></a><span class="st">#COVARIANCES LATENT FACTORS</span></span>
<span id="cb19-204"><a href="#cb19-204" aria-hidden="true" tabindex="-1"></a><span class="st">#intra twin</span></span>
<span id="cb19-205"><a href="#cb19-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-206"><a href="#cb19-206" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~d1*s1 #covariance intercept-slope</span></span>
<span id="cb19-207"><a href="#cb19-207" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~d2*s2</span></span>
<span id="cb19-208"><a href="#cb19-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-209"><a href="#cb19-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-210"><a href="#cb19-210" aria-hidden="true" tabindex="-1"></a><span class="st">#between twin</span></span>
<span id="cb19-211"><a href="#cb19-211" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~g*i2 #between intercepts</span></span>
<span id="cb19-212"><a href="#cb19-212" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~h*s2 #between slopes</span></span>
<span id="cb19-213"><a href="#cb19-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-214"><a href="#cb19-214" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~j*s2 #intercept slope one way</span></span>
<span id="cb19-215"><a href="#cb19-215" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~k*s1 #intercept slope the other way</span></span>
<span id="cb19-216"><a href="#cb19-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-217"><a href="#cb19-217" aria-hidden="true" tabindex="-1"></a><span class="st">#RESIDUAL VARIANCES</span></span>
<span id="cb19-218"><a href="#cb19-218" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~p1*XA1 #residual variances are different for Twin1 and 2 at each time</span></span>
<span id="cb19-219"><a href="#cb19-219" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~q1*XB1</span></span>
<span id="cb19-220"><a href="#cb19-220" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~r1*XC1</span></span>
<span id="cb19-221"><a href="#cb19-221" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~s1*XD1</span></span>
<span id="cb19-222"><a href="#cb19-222" aria-hidden="true" tabindex="-1"></a><span class="st">XA2~~p2*XA2</span></span>
<span id="cb19-223"><a href="#cb19-223" aria-hidden="true" tabindex="-1"></a><span class="st">XB2~~q2*XB2</span></span>
<span id="cb19-224"><a href="#cb19-224" aria-hidden="true" tabindex="-1"></a><span class="st">XC2~~r2*XC2</span></span>
<span id="cb19-225"><a href="#cb19-225" aria-hidden="true" tabindex="-1"></a><span class="st">XD2~~s2*XD2</span></span>
<span id="cb19-226"><a href="#cb19-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-227"><a href="#cb19-227" aria-hidden="true" tabindex="-1"></a><span class="st">#MEANS OF OBSERVED VARIABLES FIXED TO 0 (captured by i and s)</span></span>
<span id="cb19-228"><a href="#cb19-228" aria-hidden="true" tabindex="-1"></a><span class="st">XA1 + XB1 + XC1+ XD1~0*1</span></span>
<span id="cb19-229"><a href="#cb19-229" aria-hidden="true" tabindex="-1"></a><span class="st">XA2 + XB2 + XC2+ XD2~0*1</span></span>
<span id="cb19-230"><a href="#cb19-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-231"><a href="#cb19-231" aria-hidden="true" tabindex="-1"></a><span class="st">#CORRELATED CROSS TWINS RESIDUAL ERRORS</span></span>
<span id="cb19-232"><a href="#cb19-232" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~XA2</span></span>
<span id="cb19-233"><a href="#cb19-233" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~XB2</span></span>
<span id="cb19-234"><a href="#cb19-234" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~XC2</span></span>
<span id="cb19-235"><a href="#cb19-235" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~XD2 </span></span>
<span id="cb19-236"><a href="#cb19-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-237"><a href="#cb19-237" aria-hidden="true" tabindex="-1"></a><span class="st">#define quantities of interest</span></span>
<span id="cb19-238"><a href="#cb19-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-239"><a href="#cb19-239" aria-hidden="true" tabindex="-1"></a><span class="st">diffint :=  m1-m2</span></span>
<span id="cb19-240"><a href="#cb19-240" aria-hidden="true" tabindex="-1"></a><span class="st">diffslope := n1-n2</span></span>
<span id="cb19-241"><a href="#cb19-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-242"><a href="#cb19-242" aria-hidden="true" tabindex="-1"></a><span class="st">i16t1 := m1+ 8.5*n1+72.25*v1 #intercept at 16 for twin 1</span></span>
<span id="cb19-243"><a href="#cb19-243" aria-hidden="true" tabindex="-1"></a><span class="st">i16t2 := m2+ 8.5*n2+72.25*v2 #intercept at 16 for twin 2</span></span>
<span id="cb19-244"><a href="#cb19-244" aria-hidden="true" tabindex="-1"></a><span class="st">diffint16:=i16t1 -i16t2 #difference in intercept at age 16</span></span>
<span id="cb19-245"><a href="#cb19-245" aria-hidden="true" tabindex="-1"></a><span class="st">diffdiff:= diffint -diffint16 #difference of the differences, i.e. is the decrease in the distance between twin is significant, be careful to do the proper operation here so that the sign and the magnitude of this difference makes sense, </span></span>
<span id="cb19-246"><a href="#cb19-246" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb19-247"><a href="#cb19-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-248"><a href="#cb19-248" aria-hidden="true" tabindex="-1"></a>LGFitisqf <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqf, <span class="at">data=</span>mergedtwin,<span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb19-249"><a href="#cb19-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-250"><a href="#cb19-250" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisqf,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb19-251"><a href="#cb19-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-252"><a href="#cb19-252" aria-hidden="true" tabindex="-1"></a>fit.boot5 <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqf, <span class="at">data =</span> mergedtwin, <span class="at">missing =</span><span class="st">&quot;FIML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb19-253"><a href="#cb19-253" aria-hidden="true" tabindex="-1"></a>conint5<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot5,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">standardized =</span> T) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb19-254"><a href="#cb19-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-255"><a href="#cb19-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-256"><a href="#cb19-256" aria-hidden="true" tabindex="-1"></a>xlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(conint5, <span class="at">file=</span><span class="st">&quot;hyperactivity.xlsx&quot;</span>,<span class="at">sheetName=</span><span class="st">&quot;Sheet1&quot;</span>)</span>
<span id="cb19-257"><a href="#cb19-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-258"><a href="#cb19-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-259"><a href="#cb19-259" aria-hidden="true" tabindex="-1"></a><span class="do">###### Bootstrapped Estimates for Inattention ######</span></span>
<span id="cb19-260"><a href="#cb19-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-261"><a href="#cb19-261" aria-hidden="true" tabindex="-1"></a>ObsVarTwin1<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hconint1&quot;</span>,<span class="st">&quot;lpconint1&quot;</span>,<span class="st">&quot;npconint1&quot;</span>,<span class="st">&quot;ppbhconninat1&quot;</span>)<span class="co">#replace by real observed variables</span></span>
<span id="cb19-262"><a href="#cb19-262" aria-hidden="true" tabindex="-1"></a>ObsVarTwin2<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;hconint2&quot;</span>,<span class="st">&quot;lpconint2&quot;</span>,<span class="st">&quot;npconint2&quot;</span>,<span class="st">&quot;ppbhconninat2&quot;</span>)<span class="co">#replace by real observed variables</span></span>
<span id="cb19-263"><a href="#cb19-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-264"><a href="#cb19-264" aria-hidden="true" tabindex="-1"></a>mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XB1&quot;</span>,<span class="st">&quot;XC1&quot;</span>,<span class="st">&quot;XD1&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>; mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XB1&quot;</span>,<span class="st">&quot;XC1&quot;</span>,<span class="st">&quot;XD1&quot;</span>)]<span class="ot">=</span>mergedtwin[,ObsVarTwin1]</span>
<span id="cb19-265"><a href="#cb19-265" aria-hidden="true" tabindex="-1"></a>mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA2&quot;</span>,<span class="st">&quot;XB2&quot;</span>,<span class="st">&quot;XC2&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>; mergedtwin[,<span class="fu">c</span>(<span class="st">&quot;XA2&quot;</span>,<span class="st">&quot;XB2&quot;</span>,<span class="st">&quot;XC2&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>mergedtwin[,ObsVarTwin2]</span>
<span id="cb19-266"><a href="#cb19-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-267"><a href="#cb19-267" aria-hidden="true" tabindex="-1"></a><span class="co">#twin 1 is the heavier twin, twin 2 is the lighter twin</span></span>
<span id="cb19-268"><a href="#cb19-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-269"><a href="#cb19-269" aria-hidden="true" tabindex="-1"></a>LGModisqf <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb19-270"><a href="#cb19-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-271"><a href="#cb19-271" aria-hidden="true" tabindex="-1"></a><span class="st">#GROWTH Twin 1 and 2</span></span>
<span id="cb19-272"><a href="#cb19-272" aria-hidden="true" tabindex="-1"></a><span class="st">i1 =~ 1*XA1 + 1*XB1 + 1*XC1 + 1*XD1  </span></span>
<span id="cb19-273"><a href="#cb19-273" aria-hidden="true" tabindex="-1"></a><span class="st">s1 =~ 0*XA1 + 3.4*XB1 + 6.1*XC1 + 8.5*XD1 </span></span>
<span id="cb19-274"><a href="#cb19-274" aria-hidden="true" tabindex="-1"></a><span class="st">q1 =~ 0*XA1 + 11.56*XB1+ 37.21*XC1 + 72.25*XD1   </span></span>
<span id="cb19-275"><a href="#cb19-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-276"><a href="#cb19-276" aria-hidden="true" tabindex="-1"></a><span class="st">i2 =~ 1*XA2 + 1*XB2 + 1*XC2 + 1*XD2  </span></span>
<span id="cb19-277"><a href="#cb19-277" aria-hidden="true" tabindex="-1"></a><span class="st">s2 =~ 0*XA2 + 3.4*XB2 + 6.1*XC2 + 8.5*XD2 </span></span>
<span id="cb19-278"><a href="#cb19-278" aria-hidden="true" tabindex="-1"></a><span class="st">q2 =~ 0*XA2 + 11.56*XB2+ 37.21*XC2 + 72.25*XD2  </span></span>
<span id="cb19-279"><a href="#cb19-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-280"><a href="#cb19-280" aria-hidden="true" tabindex="-1"></a><span class="st"># #MEANS OF LATENT FACTORS/intercepts</span></span>
<span id="cb19-281"><a href="#cb19-281" aria-hidden="true" tabindex="-1"></a><span class="st">i1~m1*1  #twins are different and not random, hence different parameters for i1 amd i2, s1 and s2 etc.</span></span>
<span id="cb19-282"><a href="#cb19-282" aria-hidden="true" tabindex="-1"></a><span class="st">s1~n1*1</span></span>
<span id="cb19-283"><a href="#cb19-283" aria-hidden="true" tabindex="-1"></a><span class="st">q1~v1*1</span></span>
<span id="cb19-284"><a href="#cb19-284" aria-hidden="true" tabindex="-1"></a><span class="st">i2~m2*1</span></span>
<span id="cb19-285"><a href="#cb19-285" aria-hidden="true" tabindex="-1"></a><span class="st">s2~n2*1</span></span>
<span id="cb19-286"><a href="#cb19-286" aria-hidden="true" tabindex="-1"></a><span class="st">q2~v2*1</span></span>
<span id="cb19-287"><a href="#cb19-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-288"><a href="#cb19-288" aria-hidden="true" tabindex="-1"></a><span class="st">#VAR LATENT FACTORS</span></span>
<span id="cb19-289"><a href="#cb19-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-290"><a href="#cb19-290" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~a1*i1 #intercept and slope for each twin</span></span>
<span id="cb19-291"><a href="#cb19-291" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~b1*s1</span></span>
<span id="cb19-292"><a href="#cb19-292" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~a2*i2</span></span>
<span id="cb19-293"><a href="#cb19-293" aria-hidden="true" tabindex="-1"></a><span class="st">s2~~b2*s2</span></span>
<span id="cb19-294"><a href="#cb19-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-295"><a href="#cb19-295" aria-hidden="true" tabindex="-1"></a><span class="st">#COVARIANCES LATENT FACTORS</span></span>
<span id="cb19-296"><a href="#cb19-296" aria-hidden="true" tabindex="-1"></a><span class="st">#intra twin</span></span>
<span id="cb19-297"><a href="#cb19-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-298"><a href="#cb19-298" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~d1*s1 #covariance intercept-slope</span></span>
<span id="cb19-299"><a href="#cb19-299" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~d2*s2</span></span>
<span id="cb19-300"><a href="#cb19-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-301"><a href="#cb19-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-302"><a href="#cb19-302" aria-hidden="true" tabindex="-1"></a><span class="st">#between twin</span></span>
<span id="cb19-303"><a href="#cb19-303" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~g*i2 #between intercepts</span></span>
<span id="cb19-304"><a href="#cb19-304" aria-hidden="true" tabindex="-1"></a><span class="st">s1~~h*s2 #between slopes</span></span>
<span id="cb19-305"><a href="#cb19-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-306"><a href="#cb19-306" aria-hidden="true" tabindex="-1"></a><span class="st">i1~~j*s2 #intercept slope one way</span></span>
<span id="cb19-307"><a href="#cb19-307" aria-hidden="true" tabindex="-1"></a><span class="st">i2~~k*s1 #intercept slope the other way</span></span>
<span id="cb19-308"><a href="#cb19-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-309"><a href="#cb19-309" aria-hidden="true" tabindex="-1"></a><span class="st">#RESIDUAL VARIANCES</span></span>
<span id="cb19-310"><a href="#cb19-310" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~p1*XA1 #residual variances are different for Twin1 and 2 at each time</span></span>
<span id="cb19-311"><a href="#cb19-311" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~q1*XB1</span></span>
<span id="cb19-312"><a href="#cb19-312" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~r1*XC1</span></span>
<span id="cb19-313"><a href="#cb19-313" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~s1*XD1</span></span>
<span id="cb19-314"><a href="#cb19-314" aria-hidden="true" tabindex="-1"></a><span class="st">XA2~~p2*XA2</span></span>
<span id="cb19-315"><a href="#cb19-315" aria-hidden="true" tabindex="-1"></a><span class="st">XB2~~q2*XB2</span></span>
<span id="cb19-316"><a href="#cb19-316" aria-hidden="true" tabindex="-1"></a><span class="st">XC2~~r2*XC2</span></span>
<span id="cb19-317"><a href="#cb19-317" aria-hidden="true" tabindex="-1"></a><span class="st">XD2~~s2*XD2</span></span>
<span id="cb19-318"><a href="#cb19-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-319"><a href="#cb19-319" aria-hidden="true" tabindex="-1"></a><span class="st">#MEANS OF OBSERVED VARIABLES FIXED TO 0 (captured by i and s)</span></span>
<span id="cb19-320"><a href="#cb19-320" aria-hidden="true" tabindex="-1"></a><span class="st">XA1 + XB1 + XC1+ XD1~0*1</span></span>
<span id="cb19-321"><a href="#cb19-321" aria-hidden="true" tabindex="-1"></a><span class="st">XA2 + XB2 + XC2+ XD2~0*1</span></span>
<span id="cb19-322"><a href="#cb19-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-323"><a href="#cb19-323" aria-hidden="true" tabindex="-1"></a><span class="st">#CORRELATED CROSS TWINS RESIDUAL ERRORS</span></span>
<span id="cb19-324"><a href="#cb19-324" aria-hidden="true" tabindex="-1"></a><span class="st">XA1~~XA2</span></span>
<span id="cb19-325"><a href="#cb19-325" aria-hidden="true" tabindex="-1"></a><span class="st">XB1~~XB2</span></span>
<span id="cb19-326"><a href="#cb19-326" aria-hidden="true" tabindex="-1"></a><span class="st">XC1~~XC2</span></span>
<span id="cb19-327"><a href="#cb19-327" aria-hidden="true" tabindex="-1"></a><span class="st">XD1~~XD2 </span></span>
<span id="cb19-328"><a href="#cb19-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-329"><a href="#cb19-329" aria-hidden="true" tabindex="-1"></a><span class="st">#define quantities of interest</span></span>
<span id="cb19-330"><a href="#cb19-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-331"><a href="#cb19-331" aria-hidden="true" tabindex="-1"></a><span class="st">diffint :=  m1-m2</span></span>
<span id="cb19-332"><a href="#cb19-332" aria-hidden="true" tabindex="-1"></a><span class="st">diffslope := n1-n2</span></span>
<span id="cb19-333"><a href="#cb19-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-334"><a href="#cb19-334" aria-hidden="true" tabindex="-1"></a><span class="st">i16t1 := m1+ 8.5*n1+72.25*v1 #intercept at 16 for twin 1</span></span>
<span id="cb19-335"><a href="#cb19-335" aria-hidden="true" tabindex="-1"></a><span class="st">i16t2 := m2+ 8.5*n2+72.25*v2 #intercept at 16 for twin 2</span></span>
<span id="cb19-336"><a href="#cb19-336" aria-hidden="true" tabindex="-1"></a><span class="st">diffint16:=i16t1 -i16t2 #difference in intercept at age 16</span></span>
<span id="cb19-337"><a href="#cb19-337" aria-hidden="true" tabindex="-1"></a><span class="st">diffdiff:= diffint -diffint16 #difference of the differences, i.e. is the decrease in the distance between twin is significant, be careful to do the proper operation here so that the sign and the magnitude of this difference makes sense, </span></span>
<span id="cb19-338"><a href="#cb19-338" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb19-339"><a href="#cb19-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-340"><a href="#cb19-340" aria-hidden="true" tabindex="-1"></a>LGFitisqf <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqf, <span class="at">data=</span>mergedtwin,<span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>) </span>
<span id="cb19-341"><a href="#cb19-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-342"><a href="#cb19-342" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LGFitisqf,<span class="at">fit.measures=</span>T,<span class="at">standardized=</span>T)</span>
<span id="cb19-343"><a href="#cb19-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-344"><a href="#cb19-344" aria-hidden="true" tabindex="-1"></a>fit.boot5 <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(LGModisqf, <span class="at">data =</span> mergedtwin, <span class="at">missing =</span><span class="st">&quot;FIML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb19-345"><a href="#cb19-345" aria-hidden="true" tabindex="-1"></a>conint5<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot5,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>, <span class="at">standardized =</span> T) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb19-346"><a href="#cb19-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-347"><a href="#cb19-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-348"><a href="#cb19-348" aria-hidden="true" tabindex="-1"></a>xlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(conint5, <span class="at">file=</span><span class="st">&quot;inattention.xlsx&quot;</span>,<span class="at">sheetName=</span><span class="st">&quot;Sheet2&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="sensitivity-analyses" class="section level1">
<h1>Sensitivity analyses</h1>
<div id="satorra-bentler-test" class="section level2">
<h2>Satorra-Bentler Test</h2>
<p>The Satorra-Bentler tests were used to test if the effect of birth weight on inattention and impulsivity/hyperactivity can be constrained to be the same. The results are presented on Table 3 of the paper.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">#########  3.6 ========Satorra-Bentler test for differential effect of BW on different dimension  #########</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#tests the significance of differential effect of BW on impulsivity and inattention at each age. </span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>zygosL<span class="ot">=</span><span class="cn">NA</span>; </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>adhddata<span class="sc">$</span>zygosL <span class="ot">&lt;-</span> <span class="fu">factor</span>(adhddata<span class="sc">$</span>zygos, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;MZ&quot;</span>, <span class="st">&quot;DZ&quot;</span>))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>adhddatal<span class="ot">=</span>adhddata</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>adhddata8<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconhit2) <span class="sc">&amp;</span> </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                        <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>hconint2)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                      <span class="sc">&amp;</span> adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                      <span class="sc">&amp;</span> (adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>adhddata8[,<span class="st">&quot;arkidgr1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata8[,<span class="st">&quot;arkidgr1&quot;</span>]);adhddata8[,<span class="st">&quot;arkidgr2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata8[,<span class="st">&quot;arkidgr2&quot;</span>]);</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>adhddata8[,<span class="st">&quot;hconhit1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata8[,<span class="st">&quot;hconhit1&quot;</span>]);adhddata8[,<span class="st">&quot;hconhit2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata8[,<span class="st">&quot;hconhit2&quot;</span>]) </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>adhddata8[,<span class="st">&quot;hconint1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata8[,<span class="st">&quot;hconint1&quot;</span>]);adhddata8[,<span class="st">&quot;hconint2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata8[,<span class="st">&quot;hconint2&quot;</span>]) </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co">#random -- select only one twin randomly</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>adhddata8<span class="ot">=</span>adhddata8[adhddata8<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">#simple differences</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>adhddata8<span class="sc">$</span>BWdif<span class="ot">=</span><span class="cn">NA</span>;adhddata8<span class="sc">$</span>BWdif<span class="ot">=</span>adhddata8<span class="sc">$</span>arkidgr1<span class="sc">-</span>adhddata8<span class="sc">$</span>arkidgr2 </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>adhddata8<span class="sc">$</span>intdif<span class="ot">=</span><span class="cn">NA</span>;adhddata8<span class="sc">$</span>intdif<span class="ot">=</span>adhddata8<span class="sc">$</span>hconint1<span class="sc">-</span>adhddata8<span class="sc">$</span>hconint2</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>adhddata8<span class="sc">$</span>hypdif<span class="ot">=</span><span class="cn">NA</span>;adhddata8<span class="sc">$</span>hypdif<span class="ot">=</span>adhddata8<span class="sc">$</span>hconhit1<span class="sc">-</span>adhddata8<span class="sc">$</span>hconhit2</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">=</span><span class="st">&#39;hypdif~BWdif </span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~BWdif</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~hypdif</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="st">#hypdif~1  ##JB: add this comment here: intercept is commented out to mimic the lm regression without the intercept</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="st">#intdif~1</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="st">hypdif~~hypdif</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~intdif</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~~BWdif</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~1&#39;</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">=</span><span class="fu">lavaan</span>(model1, <span class="at">data=</span>adhddata8[adhddata8<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">estimator=</span><span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1, <span class="at">standardized=</span>T)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>model2<span class="ot">=</span><span class="st">&#39;hypdif~rc*BWdif </span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~rc*BWdif</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~hypdif</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a><span class="st">#hypdif~1</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a><span class="st">#intdif~1</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a><span class="st">hypdif~~hypdif</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~intdif</span></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~~BWdif</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~1&#39;</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">=</span><span class="fu">lavaan</span>(model2, <span class="at">data=</span>adhddata8[adhddata8<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">estimator=</span><span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2, <span class="at">standardized=</span>T)</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit1, fit2)</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Scaled Chi Square Difference Test (method = &quot;satorra.bentler.2001&quot;)</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Df   AIC   BIC   Chisq Chisq diff Df diff Pr(&gt;Chisq)    </span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a><span class="co"># fit1  2 11344 11384  1.5996                                  </span></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a><span class="co"># fit2  3 11365 11399 24.1389     17.319       1   3.16e-05 ***</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   ---</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a><span class="co">#                                12 years old</span></span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a><span class="co">#select wanted twins</span></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>adhddata12<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconhit2) <span class="sc">&amp;</span> </span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>lpconint2)</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span> adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span> (adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a><span class="co">#scale</span></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>adhddata12[,<span class="st">&quot;arkidgr1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata12[,<span class="st">&quot;arkidgr1&quot;</span>]);adhddata12[,<span class="st">&quot;arkidgr2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata12[,<span class="st">&quot;arkidgr2&quot;</span>]);</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>adhddata12[,<span class="st">&quot;lpconhit1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata12[,<span class="st">&quot;lpconhit1&quot;</span>]);adhddata12[,<span class="st">&quot;lpconhit2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata12[,<span class="st">&quot;lpconhit2&quot;</span>]) </span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>adhddata12[,<span class="st">&quot;lpconint1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata12[,<span class="st">&quot;lpconint1&quot;</span>]);adhddata12[,<span class="st">&quot;lpconint2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata12[,<span class="st">&quot;lpconint2&quot;</span>]) </span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a><span class="co">#select random</span></span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>adhddata12<span class="ot">=</span>adhddata12[adhddata12<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diff</span></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>adhddata12<span class="sc">$</span>BWdif<span class="ot">=</span><span class="cn">NA</span>;adhddata12<span class="sc">$</span>BWdif<span class="ot">=</span>adhddata12<span class="sc">$</span>arkidgr1<span class="sc">-</span>adhddata12<span class="sc">$</span>arkidgr2 </span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>adhddata12<span class="sc">$</span>intdif<span class="ot">=</span><span class="cn">NA</span>;adhddata12<span class="sc">$</span>intdif<span class="ot">=</span>adhddata12<span class="sc">$</span>lpconint1<span class="sc">-</span>adhddata12<span class="sc">$</span>lpconint2</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>adhddata12<span class="sc">$</span>hypdif<span class="ot">=</span><span class="cn">NA</span>;adhddata12<span class="sc">$</span>hypdif<span class="ot">=</span>adhddata12<span class="sc">$</span>lpconhit1<span class="sc">-</span>adhddata12<span class="sc">$</span>lpconhit2</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>model3<span class="ot">=</span><span class="st">&#39;hypdif~BWdif </span></span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~BWdif</span></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~hypdif</span></span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a><span class="st">#hypdif~1</span></span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a><span class="st">#intdif~1</span></span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a><span class="st">hypdif~~hypdif</span></span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~intdif</span></span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~~BWdif</span></span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~1&#39;</span></span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>fit3<span class="ot">=</span><span class="fu">lavaan</span>(model3, <span class="at">data=</span>adhddata12[adhddata12<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">estimator=</span><span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3, <span class="at">standardized=</span>T)</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>model4<span class="ot">=</span><span class="st">&#39;hypdif~rc*BWdif </span></span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~rc*BWdif</span></span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~hypdif</span></span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a><span class="st">#hypdif~1</span></span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a><span class="st">#intdif~1</span></span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a><span class="st">hypdif~~hypdif</span></span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~intdif</span></span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~~BWdif</span></span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~1&#39;</span></span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>fit4<span class="ot">=</span><span class="fu">lavaan</span>(model4, <span class="at">data=</span>adhddata12[adhddata12<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">estimator=</span><span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4, <span class="at">standardized=</span>T)</span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit3, fit4)</span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Scaled Chi Square Difference Test (method = &quot;satorra.bentler.2001&quot;)</span></span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Df   AIC   BIC   Chisq Chisq diff Df diff Pr(&gt;Chisq)    </span></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a><span class="co"># fit3  2 11012 11051  0.0196                                  </span></span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a><span class="co"># fit4  3 11025 11058 14.8974     12.738       1  0.0003583 ***</span></span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a><span class="co">#                               14 years old</span></span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a>adhddata14<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconhit2) <span class="sc">&amp;</span> </span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>npconint2)</span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span> adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span> (adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a><span class="co">#scale</span></span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>adhddata14[,<span class="st">&quot;arkidgr1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata14[,<span class="st">&quot;arkidgr1&quot;</span>]);adhddata14[,<span class="st">&quot;arkidgr2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata14[,<span class="st">&quot;arkidgr2&quot;</span>]);</span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a>adhddata14[,<span class="st">&quot;npconhit1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata14[,<span class="st">&quot;npconhit1&quot;</span>]);adhddata14[,<span class="st">&quot;npconhit2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata14[,<span class="st">&quot;npconhit2&quot;</span>]) </span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a>adhddata14[,<span class="st">&quot;npconint1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata14[,<span class="st">&quot;npconint1&quot;</span>]);adhddata14[,<span class="st">&quot;npconint2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata14[,<span class="st">&quot;npconint2&quot;</span>]) </span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a><span class="co">#select random</span></span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a>adhddata14<span class="ot">=</span>adhddata14[adhddata14<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb20-137"><a href="#cb20-137" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diff</span></span>
<span id="cb20-138"><a href="#cb20-138" aria-hidden="true" tabindex="-1"></a>adhddata14<span class="sc">$</span>BWdif<span class="ot">=</span><span class="cn">NA</span>;adhddata14<span class="sc">$</span>BWdif<span class="ot">=</span>adhddata14<span class="sc">$</span>arkidgr1<span class="sc">-</span>adhddata14<span class="sc">$</span>arkidgr2 </span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a>adhddata14<span class="sc">$</span>intdif<span class="ot">=</span><span class="cn">NA</span>;adhddata14<span class="sc">$</span>intdif<span class="ot">=</span>adhddata14<span class="sc">$</span>npconint1<span class="sc">-</span>adhddata14<span class="sc">$</span>npconint2</span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a>adhddata14<span class="sc">$</span>hypdif<span class="ot">=</span><span class="cn">NA</span>;adhddata14<span class="sc">$</span>hypdif<span class="ot">=</span>adhddata14<span class="sc">$</span>npconhit1<span class="sc">-</span>adhddata14<span class="sc">$</span>npconhit2</span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a>model5<span class="ot">=</span><span class="st">&#39;hypdif~BWdif </span></span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~BWdif</span></span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~hypdif</span></span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a><span class="st">#hypdif~1</span></span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a><span class="st">#intdif~1</span></span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a><span class="st">hypdif~~hypdif</span></span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~intdif</span></span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~~BWdif</span></span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~1&#39;</span></span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a>fit5<span class="ot">=</span><span class="fu">lavaan</span>(model5, <span class="at">data=</span>adhddata14[adhddata14<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">estimator=</span><span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit5, <span class="at">standardized=</span>T)</span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a>model6<span class="ot">=</span><span class="st">&#39;hypdif~rc*BWdif </span></span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~rc*BWdif</span></span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~hypdif</span></span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a><span class="st">#hypdif~1</span></span>
<span id="cb20-160"><a href="#cb20-160" aria-hidden="true" tabindex="-1"></a><span class="st">#intdif~1</span></span>
<span id="cb20-161"><a href="#cb20-161" aria-hidden="true" tabindex="-1"></a><span class="st">hypdif~~hypdif</span></span>
<span id="cb20-162"><a href="#cb20-162" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~intdif</span></span>
<span id="cb20-163"><a href="#cb20-163" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~~BWdif</span></span>
<span id="cb20-164"><a href="#cb20-164" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~1&#39;</span></span>
<span id="cb20-165"><a href="#cb20-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-166"><a href="#cb20-166" aria-hidden="true" tabindex="-1"></a>fit6<span class="ot">=</span><span class="fu">lavaan</span>(model6, <span class="at">data=</span>adhddata14[adhddata14<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">estimator=</span><span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb20-167"><a href="#cb20-167" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit6, <span class="at">standardized=</span>T)</span>
<span id="cb20-168"><a href="#cb20-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-169"><a href="#cb20-169" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit5, fit6)</span>
<span id="cb20-170"><a href="#cb20-170" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-171"><a href="#cb20-171" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-172"><a href="#cb20-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Scaled Chi Square Difference Test (method = &quot;satorra.bentler.2001&quot;)</span></span>
<span id="cb20-173"><a href="#cb20-173" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-174"><a href="#cb20-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Df    AIC    BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)  </span></span>
<span id="cb20-175"><a href="#cb20-175" aria-hidden="true" tabindex="-1"></a><span class="co"># fit5  2 6707.9 6743.7 2.3995                                </span></span>
<span id="cb20-176"><a href="#cb20-176" aria-hidden="true" tabindex="-1"></a><span class="co"># fit6  3 6711.4 6742.1 7.8391     4.4414       1    0.03508 *</span></span>
<span id="cb20-177"><a href="#cb20-177" aria-hidden="true" tabindex="-1"></a><span class="co">#   ---</span></span>
<span id="cb20-178"><a href="#cb20-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-179"><a href="#cb20-179" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 16 years old</span></span>
<span id="cb20-180"><a href="#cb20-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-181"><a href="#cb20-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-182"><a href="#cb20-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-183"><a href="#cb20-183" aria-hidden="true" tabindex="-1"></a>adhddata16<span class="ot">=</span> adhddatal[ <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconnimpt2) <span class="sc">&amp;</span> </span>
<span id="cb20-184"><a href="#cb20-184" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddatal<span class="sc">$</span>ppbhconninat2)</span>
<span id="cb20-185"><a href="#cb20-185" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span> adhddatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb20-186"><a href="#cb20-186" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span> (adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb20-187"><a href="#cb20-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-188"><a href="#cb20-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-189"><a href="#cb20-189" aria-hidden="true" tabindex="-1"></a>adhddata16[,<span class="st">&quot;arkidgr1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata16[,<span class="st">&quot;arkidgr1&quot;</span>]);adhddata16[,<span class="st">&quot;arkidgr2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata16[,<span class="st">&quot;arkidgr2&quot;</span>]);</span>
<span id="cb20-190"><a href="#cb20-190" aria-hidden="true" tabindex="-1"></a>adhddata16[,<span class="st">&quot;ppbhconnimpt1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata16[,<span class="st">&quot;ppbhconnimpt1&quot;</span>]);adhddata16[,<span class="st">&quot;ppbhconnimpt2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata16[,<span class="st">&quot;ppbhconnimpt2&quot;</span>]) </span>
<span id="cb20-191"><a href="#cb20-191" aria-hidden="true" tabindex="-1"></a>adhddata16[,<span class="st">&quot;ppbhconninat1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata16[,<span class="st">&quot;ppbhconninat1&quot;</span>]);adhddata16[,<span class="st">&quot;ppbhconninat2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata16[,<span class="st">&quot;ppbhconninat2&quot;</span>]) </span>
<span id="cb20-192"><a href="#cb20-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-193"><a href="#cb20-193" aria-hidden="true" tabindex="-1"></a><span class="co">#select random</span></span>
<span id="cb20-194"><a href="#cb20-194" aria-hidden="true" tabindex="-1"></a>adhddata16<span class="ot">=</span>adhddata16[adhddata16<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb20-195"><a href="#cb20-195" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diff</span></span>
<span id="cb20-196"><a href="#cb20-196" aria-hidden="true" tabindex="-1"></a>adhddata16<span class="sc">$</span>BWdif<span class="ot">=</span><span class="cn">NA</span>;adhddata16<span class="sc">$</span>BWdif<span class="ot">=</span>adhddata16<span class="sc">$</span>arkidgr1<span class="sc">-</span>adhddata16<span class="sc">$</span>arkidgr2 </span>
<span id="cb20-197"><a href="#cb20-197" aria-hidden="true" tabindex="-1"></a>adhddata16<span class="sc">$</span>intdif<span class="ot">=</span><span class="cn">NA</span>;adhddata16<span class="sc">$</span>intdif<span class="ot">=</span>adhddata16<span class="sc">$</span>ppbhconninat1<span class="sc">-</span>adhddata16<span class="sc">$</span>ppbhconninat2</span>
<span id="cb20-198"><a href="#cb20-198" aria-hidden="true" tabindex="-1"></a>adhddata16<span class="sc">$</span>hypdif<span class="ot">=</span><span class="cn">NA</span>;adhddata16<span class="sc">$</span>hypdif<span class="ot">=</span>adhddata16<span class="sc">$</span>ppbhconnimpt1<span class="sc">-</span>adhddata16<span class="sc">$</span>ppbhconnimpt2</span>
<span id="cb20-199"><a href="#cb20-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-200"><a href="#cb20-200" aria-hidden="true" tabindex="-1"></a>model7<span class="ot">=</span><span class="st">&#39;hypdif~BWdif </span></span>
<span id="cb20-201"><a href="#cb20-201" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~BWdif</span></span>
<span id="cb20-202"><a href="#cb20-202" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~hypdif</span></span>
<span id="cb20-203"><a href="#cb20-203" aria-hidden="true" tabindex="-1"></a><span class="st">#hypdif~1</span></span>
<span id="cb20-204"><a href="#cb20-204" aria-hidden="true" tabindex="-1"></a><span class="st">#intdif~1</span></span>
<span id="cb20-205"><a href="#cb20-205" aria-hidden="true" tabindex="-1"></a><span class="st">hypdif~~hypdif</span></span>
<span id="cb20-206"><a href="#cb20-206" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~intdif</span></span>
<span id="cb20-207"><a href="#cb20-207" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~~BWdif</span></span>
<span id="cb20-208"><a href="#cb20-208" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~1&#39;</span></span>
<span id="cb20-209"><a href="#cb20-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-210"><a href="#cb20-210" aria-hidden="true" tabindex="-1"></a>fit7<span class="ot">=</span><span class="fu">lavaan</span>(model7, <span class="at">data=</span>adhddata16[adhddata16<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">estimator=</span><span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb20-211"><a href="#cb20-211" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit7, <span class="at">standardized=</span>T)</span>
<span id="cb20-212"><a href="#cb20-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-213"><a href="#cb20-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-214"><a href="#cb20-214" aria-hidden="true" tabindex="-1"></a>model8<span class="ot">=</span>model7<span class="ot">=</span><span class="st">&#39;hypdif~rc*BWdif </span></span>
<span id="cb20-215"><a href="#cb20-215" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~rc*BWdif</span></span>
<span id="cb20-216"><a href="#cb20-216" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~hypdif</span></span>
<span id="cb20-217"><a href="#cb20-217" aria-hidden="true" tabindex="-1"></a><span class="st">#hypdif~1</span></span>
<span id="cb20-218"><a href="#cb20-218" aria-hidden="true" tabindex="-1"></a><span class="st">#intdif~1</span></span>
<span id="cb20-219"><a href="#cb20-219" aria-hidden="true" tabindex="-1"></a><span class="st">hypdif~~hypdif</span></span>
<span id="cb20-220"><a href="#cb20-220" aria-hidden="true" tabindex="-1"></a><span class="st">intdif~~intdif</span></span>
<span id="cb20-221"><a href="#cb20-221" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~~BWdif</span></span>
<span id="cb20-222"><a href="#cb20-222" aria-hidden="true" tabindex="-1"></a><span class="st">BWdif~1&#39;</span></span>
<span id="cb20-223"><a href="#cb20-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-224"><a href="#cb20-224" aria-hidden="true" tabindex="-1"></a>fit8<span class="ot">=</span><span class="fu">lavaan</span>(model8, <span class="at">data=</span>adhddata16[adhddata16<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">estimator=</span><span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb20-225"><a href="#cb20-225" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit8, <span class="at">standardized=</span>T)</span>
<span id="cb20-226"><a href="#cb20-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-227"><a href="#cb20-227" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit7, fit8)</span>
<span id="cb20-228"><a href="#cb20-228" aria-hidden="true" tabindex="-1"></a><span class="co"># # </span></span>
<span id="cb20-229"><a href="#cb20-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Scaled Chi Square Difference Test (method = &quot;satorra.bentler.2001&quot;)</span></span>
<span id="cb20-230"><a href="#cb20-230" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-231"><a href="#cb20-231" aria-hidden="true" tabindex="-1"></a><span class="co"># Df   AIC   BIC   Chisq Chisq diff Df diff Pr(&gt;Chisq)   </span></span>
<span id="cb20-232"><a href="#cb20-232" aria-hidden="true" tabindex="-1"></a><span class="co"># fit7  2 10120 10158  0.6933                                 </span></span>
<span id="cb20-233"><a href="#cb20-233" aria-hidden="true" tabindex="-1"></a><span class="co"># fit8  3 10130 10163 12.8629     8.8394       1   0.002948 **</span></span>
<span id="cb20-234"><a href="#cb20-234" aria-hidden="true" tabindex="-1"></a><span class="co">#   ---</span></span>
<span id="cb20-235"><a href="#cb20-235" aria-hidden="true" tabindex="-1"></a><span class="co">#   Signif. codes:  0 ?**?0.001 ?*?0.01 ??0.05 ??0.1 ??1</span></span></code></pre></div>
</div>
<div id="sex-moderation-analyses" class="section level2">
<h2>Sex moderation analyses</h2>
<p>As requested by reviewers, we checked if there was moderating effect of sex, by using chi-square tests to compare a model with sex interaction, and a model without. You may find it odd that we only used the avona() function for male_int and male_sex models to get the chi-square statistics, but from what I remember for female_sex and female_int models we will get the same results too, since the only difference was the coding of sex (1 or 0). We coded both males and females as 1 in separate models to get the beta estimates in Table S5.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  ##  </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do">   </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> ##    ####  </span><span class="al">###</span><span class="do"> ####  ##</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="do">###### 4.2 Sex-moderation - run geeglm codes to obtain chi-square differences     ######</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  ##  </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do">   </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> </span><span class="al">###</span><span class="do"> ##    ####  </span><span class="al">###</span><span class="do"> ####  ##</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(VecOutcomes_all),<span class="at">ncol=</span><span class="dv">8</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#use the following line of syntax instead if want to compare p-values of interaction terms with those of chi-square tests</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes_all),<span class="at">by=</span><span class="dv">2</span>))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  TOYDATA5<span class="ot">=</span>adhddata</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  TOYDATA5[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XA2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  TOYDATA5[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XA2&quot;</span>)]<span class="ot">=</span>TOYDATA5[,<span class="fu">c</span>(<span class="st">&quot;arkidgr1&quot;</span>,<span class="st">&quot;arkidgr2&quot;</span>)]</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  TOYDATA5[,<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  TOYDATA5[,<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>TOYDATA5[,<span class="fu">c</span>(VecOutcomes_all[i],VecOutcomes_all[i<span class="sc">+</span><span class="dv">1</span>])]</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  TOYDATAl5<span class="ot">=</span>TOYDATA5 </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#choose same sex twins so that when standardise, we don&#39;t standardise MZ twins only</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc5<span class="ot">=</span> TOYDATAl5[ <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAl5<span class="sc">$</span>XA1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(TOYDATAl5<span class="sc">$</span>XA2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAl5<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAl5<span class="sc">$</span>XD2)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> TOYDATAl5<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (TOYDATAl5<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>TOYDATAl5<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>TOYDATAl5<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>TOYDATAl5<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span>),]</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#standardize</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc5[,<span class="st">&quot;XA1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(TOYDATAlc5[,<span class="st">&quot;XA1&quot;</span>]);TOYDATAlc5[,<span class="st">&quot;XA2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(TOYDATAlc5[,<span class="st">&quot;XA2&quot;</span>]);TOYDATAlc5[,<span class="st">&quot;XD1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(TOYDATAlc5[,<span class="st">&quot;XD1&quot;</span>]);TOYDATAlc5[,<span class="st">&quot;XD2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(TOYDATAlc5[,<span class="st">&quot;XD2&quot;</span>])</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select MZ twins only</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc5 <span class="ot">=</span> TOYDATAlc5[ <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAlc5<span class="sc">$</span>XA1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(TOYDATAlc5<span class="sc">$</span>XA2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAlc5<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAlc5<span class="sc">$</span>XD2)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">&amp;</span> TOYDATAlc5<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">&amp;</span> (TOYDATAlc5<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>TOYDATAlc5<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span>),]</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc5<span class="sc">$</span>XAmean<span class="ot">=</span><span class="cn">NA</span>; TOYDATAlc5<span class="sc">$</span>XAmean<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">cbind</span>(TOYDATAlc5<span class="sc">$</span>XA1,TOYDATAlc5<span class="sc">$</span>XA2))</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc5<span class="sc">$</span>XAdifM<span class="ot">=</span><span class="cn">NA</span> ;TOYDATAlc5<span class="sc">$</span>XAdifM<span class="ot">=</span>TOYDATAlc5<span class="sc">$</span>XA1<span class="sc">-</span>TOYDATAlc5<span class="sc">$</span>XAmean </span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  male<span class="ot">=</span>TOYDATAlc5</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  female<span class="ot">=</span>TOYDATAlc5</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>  male<span class="sc">$</span>sex_fac[male<span class="sc">$</span>sex1<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0:male&quot;</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>  male<span class="sc">$</span>sex_fac[male<span class="sc">$</span>sex1<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1:female&quot;</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  male<span class="sc">$</span>sex_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(male<span class="sc">$</span>sex_fac)</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>  female<span class="sc">$</span>sex_fac[female<span class="sc">$</span>sex1<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1:male&quot;</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>  female<span class="sc">$</span>sex_fac[female<span class="sc">$</span>sex1<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0:female&quot;</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>  female<span class="sc">$</span>sex_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(female<span class="sc">$</span>sex_fac)</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#male models</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>  male_int<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">*</span>sex_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>male);</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(male_int)</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>  male_sex<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">+</span>sex_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>male);</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(male_sex)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">anova</span>(male_int,male_sex))</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># male model 95% CI</span></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>  seR.male<span class="ot">=</span><span class="fu">summary</span>(male_int)<span class="sc">$</span>coef[,<span class="dv">2</span>]; (ci.male <span class="ot">&lt;-</span><span class="fu">coef</span>(male_int) <span class="sc">+</span> seR.male <span class="sc">%o%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span>)); <span class="co">#robust</span></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>  <span class="co">#female models</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  female_int<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">*</span>sex_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>female);</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(female_int)</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>  female_sex<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">+</span>sex_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>female);</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(female_sex)</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># female model 95% CI</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>  seR.female<span class="ot">=</span><span class="fu">summary</span>(female_int)<span class="sc">$</span>coef[,<span class="dv">2</span>]; (ci.female <span class="ot">&lt;-</span><span class="fu">coef</span>(female_int) <span class="sc">+</span> seR.female <span class="sc">%o%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span>)); <span class="co">#robust</span></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">anova</span>(female_int,female_sex))</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># model differences - chi square and p-values = same as female models</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>  results<span class="ot">=</span><span class="fu">anova</span>(male_int,male_sex)</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>  chidiff<span class="ot">=</span>results<span class="sc">$</span>X2</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>  p.value<span class="ot">=</span>results<span class="sc">$</span><span class="st">`</span><span class="at">P(&gt;|Chi|)</span><span class="st">`</span></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>  maleEst<span class="ot">=</span><span class="fu">summary</span>(male_int)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>];</span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>  male.ci<span class="ot">=</span><span class="fu">c</span>(ci.male[<span class="dv">2</span>,<span class="dv">1</span>],ci.male[<span class="dv">2</span>,<span class="dv">2</span>]) </span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>  femaleEst<span class="ot">=</span><span class="fu">summary</span>(female_int)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>  female.ci<span class="ot">=</span><span class="fu">c</span>(ci.female[<span class="dv">2</span>,<span class="dv">1</span>],ci.female[<span class="dv">2</span>,<span class="dv">2</span>]) </span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>  <span class="co">#p-value of interaction term</span></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>  VecRes<span class="ot">=</span><span class="fu">c</span>(maleEst, male.ci, femaleEst, female.ci, chidiff, p.value)</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>  <span class="co">#1st pvalue is the chi-square difference p-value, the second one is the p value of interaction terms. </span></span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>  ResultsLoop[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]<span class="ot">=</span>VecRes</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ResultsLoop)<span class="ot">=</span>VecOutcomes_all</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ResultsLoop)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;male estimate&quot;</span>,<span class="st">&quot;male lo.ci&quot;</span>,<span class="st">&quot;male up.ci&quot;</span>,<span class="st">&quot;female estimate&quot;</span>,<span class="st">&quot;female lo.ci&quot;</span>,<span class="st">&quot;female up.ci&quot;</span>, <span class="st">&quot;chidif&quot;</span>,<span class="st">&quot;p-value&quot;</span>)</span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">round</span>(ResultsLoop[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes_all),<span class="at">by=</span><span class="dv">2</span>),],<span class="dv">4</span>)</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">as.data.frame</span>(ResultsLoop)</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>number_models_all <span class="ot">=</span> <span class="fu">length</span>(ResultsLoop<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>)</span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="sc">$</span>pw_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(ResultsLoop<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">&quot;fdr&quot;</span>, <span class="at">n =</span> number_models_all)</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>xlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(ResultsLoop,<span class="st">&quot;geeglm sex moderation effect with interaction estimates.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="gestational-age-moderation" class="section level2">
<h2>Gestational age moderation</h2>
<p>As requested by reviewers, we checked in there was moderating effect of short gestational age (being born when gestational age is &lt;37 weeks). It is similar to the sex moderation model. Results of gestational age moderation analyses are in Table S6.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">##------------------------------------------------------------------------------------------##</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">#### 4.3 Gestational age moderation- using geeglm for gestational age as a categorical variable ####</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">##------------------------------------------------------------------------------------------##</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#adhddata[,&quot;argestagR&quot;]=recode(adhddata[,&quot;argestag&quot;],&quot;lo:36=0; 37:hi=1;else=NA&quot;)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 = short gestational age, 27-36 weeks</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 = long gestational age, 37-43 weeks</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#change ncol to 9 if we want to compare p-values of interaction terms with chi-square diff p-values</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#ResultsLoop=matrix(nrow = length(VecOutcomes_all),ncol=9)</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(VecOutcomes_all),<span class="at">ncol=</span><span class="dv">8</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes_all),<span class="at">by=</span><span class="dv">2</span>))</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  TOYDATA7<span class="ot">=</span>adhddata</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  TOYDATA7[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XA2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  TOYDATA7[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XA2&quot;</span>)]<span class="ot">=</span>TOYDATA7[,<span class="fu">c</span>(<span class="st">&quot;arkidgr1&quot;</span>,<span class="st">&quot;arkidgr2&quot;</span>)]</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  TOYDATA7[,<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  TOYDATA7[,<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>TOYDATA7[,<span class="fu">c</span>(VecOutcomes_all[i],VecOutcomes_all[i<span class="sc">+</span><span class="dv">1</span>])]</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  TOYDATAl7<span class="ot">=</span>TOYDATA7 </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#choose same sex twins so that when standardise, we don&#39;t standardise MZ twins only</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc7<span class="ot">=</span> TOYDATAl7[ <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAl7<span class="sc">$</span>XA1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(TOYDATAl7<span class="sc">$</span>XA2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAl7<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAl7<span class="sc">$</span>XD2)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> TOYDATAl7<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  <span class="sc">&amp;!</span><span class="fu">is.na</span>(TOYDATAl7<span class="sc">$</span>argestagR)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (TOYDATAl7<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>TOYDATAl7<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>TOYDATAl7<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>TOYDATAl7<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span>),]</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#standardize</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc7[,<span class="st">&quot;XA1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(TOYDATAlc7[,<span class="st">&quot;XA1&quot;</span>]);TOYDATAlc7[,<span class="st">&quot;XA2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(TOYDATAlc7[,<span class="st">&quot;XA2&quot;</span>]);TOYDATAlc7[,<span class="st">&quot;XD1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(TOYDATAlc7[,<span class="st">&quot;XD1&quot;</span>]);TOYDATAlc7[,<span class="st">&quot;XD2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(TOYDATAlc7[,<span class="st">&quot;XD2&quot;</span>])</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select MZ twins only</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc7 <span class="ot">=</span> TOYDATAlc7[ <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAlc7<span class="sc">$</span>XA1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(TOYDATAlc7<span class="sc">$</span>XA2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAlc7<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(TOYDATAlc7<span class="sc">$</span>XD2)</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">&amp;</span> TOYDATAlc7<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">&amp;</span> (TOYDATAlc7<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>TOYDATAlc7<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span>),]</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc7<span class="sc">$</span>XAmean<span class="ot">=</span><span class="cn">NA</span>; TOYDATAlc7<span class="sc">$</span>XAmean<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">cbind</span>(TOYDATAlc7<span class="sc">$</span>XA1,TOYDATAlc7<span class="sc">$</span>XA2))</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>  TOYDATAlc7<span class="sc">$</span>XAdifM<span class="ot">=</span><span class="cn">NA</span> ;TOYDATAlc7<span class="sc">$</span>XAdifM<span class="ot">=</span>TOYDATAlc7<span class="sc">$</span>XA1<span class="sc">-</span>TOYDATAlc7<span class="sc">$</span>XAmean </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>  hiage<span class="ot">=</span>TOYDATAlc7</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>  lowage<span class="ot">=</span>TOYDATAlc7</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>  <span class="co">#recode differently for hiage and lowage</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>  hiage<span class="sc">$</span>argestagR[hiage<span class="sc">$</span>argestagR<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0:hi age&quot;</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>  hiage<span class="sc">$</span>argestagR[hiage<span class="sc">$</span>argestagR<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1:low age&quot;</span></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>  hiage<span class="sc">$</span>age_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(hiage<span class="sc">$</span>argestagR)</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>  lowage<span class="sc">$</span>argestagR[lowage<span class="sc">$</span>argestagR<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1:hi age&quot;</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>  lowage<span class="sc">$</span>argestagR[lowage<span class="sc">$</span>argestagR<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0:low age&quot;</span></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>  lowage<span class="sc">$</span>age_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(lowage<span class="sc">$</span>argestagR)</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>  <span class="co">#high age models</span></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>  hiage_int<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">*</span>age_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>hiage);</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(hiage_int)</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>  hiagemodel<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">+</span>age_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>hiage);</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(hiagemodel)</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">anova</span>(hiage_int,hiagemodel))</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>  <span class="co">#high age model 95% CI</span></span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>  seR.hiage<span class="ot">=</span><span class="fu">summary</span>(hiage_int)<span class="sc">$</span>coef[,<span class="dv">2</span>]; (ci.hiage <span class="ot">&lt;-</span><span class="fu">coef</span>(hiage_int) <span class="sc">+</span> seR.hiage <span class="sc">%o%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span>)); <span class="co">#robust</span></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">#low age models</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>  lowage_int<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">*</span>age_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>lowage);</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(lowage_int)</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>  lowagemodel<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">+</span>age_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>lowage);</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(lowagemodel)</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># low age model 95% CI</span></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>  seR.lowage<span class="ot">=</span><span class="fu">summary</span>(lowage_int)<span class="sc">$</span>coef[,<span class="dv">2</span>]; (ci.lowage <span class="ot">&lt;-</span><span class="fu">coef</span>(lowage_int) <span class="sc">+</span> seR.lowage <span class="sc">%o%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span>)); <span class="co">#robust</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">anova</span>(lowage_int,lowagemodel))</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># model differences - chi square and p-values = same as low age models</span></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>  results<span class="ot">=</span><span class="fu">anova</span>(hiage_int,hiagemodel)</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>  chidiff<span class="ot">=</span>results<span class="sc">$</span>X2</span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>  p.value<span class="ot">=</span>results<span class="sc">$</span><span class="st">`</span><span class="at">P(&gt;|Chi|)</span><span class="st">`</span></span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>  HiAgeEst<span class="ot">=</span><span class="fu">summary</span>(hiage_int)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>];</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>  HiAge.ci<span class="ot">=</span><span class="fu">c</span>(ci.hiage[<span class="dv">2</span>,<span class="dv">1</span>],ci.hiage[<span class="dv">2</span>,<span class="dv">2</span>]) </span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>  LowAgeEst<span class="ot">=</span><span class="fu">summary</span>(lowage_int)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>  LowAge.ci<span class="ot">=</span><span class="fu">c</span>(ci.lowage[<span class="dv">2</span>,<span class="dv">1</span>],ci.lowage[<span class="dv">2</span>,<span class="dv">2</span>]) </span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>  VecRes<span class="ot">=</span><span class="fu">c</span>(HiAgeEst, HiAge.ci, LowAgeEst, LowAge.ci,chidiff, p.value)</span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a>  ResultsLoop[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]<span class="ot">=</span>VecRes</span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ResultsLoop)<span class="ot">=</span>VecOutcomes_all</span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ResultsLoop)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;High Gestational Age estimate&quot;</span>,<span class="st">&quot;hi age lo.ci&quot;</span>,<span class="st">&quot;hi age up.ci&quot;</span>,<span class="st">&quot;Low Gestational Age estimate&quot;</span>,<span class="st">&quot;low age lo.ci&quot;</span>,<span class="st">&quot;low age up.ci&quot;</span>,<span class="st">&quot;chidif&quot;</span>,<span class="st">&quot;p-value&quot;</span>)</span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">round</span>(ResultsLoop[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes_all),<span class="at">by=</span><span class="dv">2</span>),],<span class="dv">4</span>)</span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">as.data.frame</span>(ResultsLoop)</span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>number_models_all <span class="ot">=</span> <span class="fu">length</span>(ResultsLoop<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>)</span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="sc">$</span>pw_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(ResultsLoop<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">&quot;fdr&quot;</span>, <span class="at">n =</span> number_models_all)</span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a>xlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(ResultsLoop,<span class="st">&quot;geeglm gestational age with interaction terms- categorical.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="lbw-moderation" class="section level2">
<h2>LBW moderation</h2>
<p>We also checked if being born with low birth weight (LBW, &lt;2500 grams) moderated the effect. The results are in Table S7.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>      <span class="do">## ==========================================================##</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="do">#######               4.4 Birth weight Moderation             ######</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>      <span class="do">## ==========================================================##</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(VecOutcomes_all),<span class="at">ncol=</span><span class="dv">8</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes_all),<span class="at">by=</span><span class="dv">2</span>))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  BWdata<span class="ot">=</span>adhddata</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  BWdata[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XA2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  BWdata[,<span class="fu">c</span>(<span class="st">&quot;XA1&quot;</span>,<span class="st">&quot;XA2&quot;</span>)]<span class="ot">=</span>BWdata[,<span class="fu">c</span>(<span class="st">&quot;arkidgr1&quot;</span>,<span class="st">&quot;arkidgr2&quot;</span>)]</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  BWdata[,<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  BWdata[,<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>BWdata[,<span class="fu">c</span>(VecOutcomes_all[i],VecOutcomes_all[i<span class="sc">+</span><span class="dv">1</span>])]</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  BWdatal<span class="ot">=</span>BWdata </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#choose same sex twins so that when standardise, we don&#39;t standardise MZ twins only</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  BWdatalc<span class="ot">=</span> BWdatal[ <span class="sc">!</span><span class="fu">is.na</span>(BWdatal<span class="sc">$</span>XA1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(BWdatal<span class="sc">$</span>XA2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(BWdatal<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(BWdatal<span class="sc">$</span>XD2)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">&amp;</span> BWdatal<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">&amp;</span> (BWdatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>BWdatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>BWdatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>BWdatal<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span>),]</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#standardize</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  BWdatalc[,<span class="st">&quot;XA1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(BWdatalc[,<span class="st">&quot;XA1&quot;</span>]);BWdatalc[,<span class="st">&quot;XA2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(BWdatalc[,<span class="st">&quot;XA2&quot;</span>]);BWdatalc[,<span class="st">&quot;XD1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(BWdatalc[,<span class="st">&quot;XD1&quot;</span>]);BWdatalc[,<span class="st">&quot;XD2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(BWdatalc[,<span class="st">&quot;XD2&quot;</span>])</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select MZ twins only</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>  BWdatalc <span class="ot">=</span> BWdatalc[ <span class="sc">!</span><span class="fu">is.na</span>(BWdatalc<span class="sc">$</span>XA1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(BWdatalc<span class="sc">$</span>XA2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(BWdatalc<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(BWdatalc<span class="sc">$</span>XD2)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span> BWdatalc<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">&amp;</span> (BWdatalc<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>BWdatalc<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span>),]</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  BWdatalc<span class="sc">$</span>XAmean<span class="ot">=</span><span class="cn">NA</span>; BWdatalc<span class="sc">$</span>XAmean<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">cbind</span>(BWdatalc<span class="sc">$</span>XA1,BWdatalc<span class="sc">$</span>XA2))</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>  BWdatalc<span class="sc">$</span>XAdifM<span class="ot">=</span><span class="cn">NA</span> ;BWdatalc<span class="sc">$</span>XAdifM<span class="ot">=</span>BWdatalc<span class="sc">$</span>XA1<span class="sc">-</span>BWdatalc<span class="sc">$</span>XAmean </span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#In any twin pair, if there is any twin with BW&lt;2500g, that twin pair will be deemed as Low BW pair. </span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>  <span class="co">#If both twins have BW &gt; 2500g, then only the twin pair is a High BW twin pair. </span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>  BWdatalc<span class="sc">$</span>BW_fac<span class="ot">=</span><span class="cn">NA</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>  BWdatalc<span class="sc">$</span>BW_fac[BWdatalc<span class="sc">$</span>arkidgr1<span class="sc">&lt;=</span><span class="dv">2500</span><span class="sc">|</span>BWdatalc<span class="sc">$</span>arkidgr2<span class="sc">&lt;=</span><span class="dv">2500</span>]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>  BWdatalc<span class="sc">$</span>BW_fac[BWdatalc<span class="sc">$</span>arkidgr1<span class="sc">&gt;</span><span class="dv">2500</span> <span class="sc">&amp;</span> BWdatalc<span class="sc">$</span>arkidgr2<span class="sc">&gt;</span><span class="dv">2500</span>]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(BWdatalc<span class="sc">$</span>BW_fac)</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>  hiBW<span class="ot">=</span>BWdatalc</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>  lowBW<span class="ot">=</span>BWdatalc</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a><span class="co">#recode and reverse the coding for LBW and HBW</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>  hiBW<span class="sc">$</span>BW_fac[hiBW<span class="sc">$</span>BW_fac<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1:LBW&quot;</span> </span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>  hiBW<span class="sc">$</span>BW_fac[hiBW<span class="sc">$</span>BW_fac<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0:HBW&quot;</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>  hiBW<span class="sc">$</span>BW_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(hiBW<span class="sc">$</span>BW_fac)</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>  lowBW<span class="sc">$</span>BW_fac[lowBW<span class="sc">$</span>BW_fac<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="st">&quot;0:LBW&quot;</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>  lowBW<span class="sc">$</span>BW_fac[lowBW<span class="sc">$</span>BW_fac<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;1:HBW&quot;</span></span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>  lowBW<span class="sc">$</span>BW_fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(lowBW<span class="sc">$</span>BW_fac)</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">#high BW models</span></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>  hiBW_int<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">*</span>BW_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>hiBW);</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(hiBW_int)</span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>  hiBWmodel<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">+</span>BW_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>hiBW);</span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(hiBWmodel)</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">anova</span>(hiBW_int,hiBWmodel))</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>  <span class="co">#high BW model 95% CI</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>  seR.hiBW<span class="ot">=</span><span class="fu">summary</span>(hiBW_int)<span class="sc">$</span>coef[,<span class="dv">2</span>]; (ci.hiBW <span class="ot">&lt;-</span><span class="fu">coef</span>(hiBW_int) <span class="sc">+</span> seR.hiBW <span class="sc">%o%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span>)); <span class="co">#robust</span></span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>  <span class="co">#low BW models</span></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>  lowBW_int<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">*</span>BW_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>lowBW);</span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(lowBW_int)</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>  lowBWmodel<span class="ot">=</span><span class="fu">geeglm</span>(XD1<span class="sc">~</span>XAdifM<span class="sc">+</span>BW_fac <span class="sc">+</span> XAmean, <span class="at">na.action=</span>na.omit, <span class="at">id =</span> id_fam,<span class="at">corstr=</span><span class="st">&quot;ex&quot;</span>,<span class="at">data=</span>lowBW);</span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(lowBWmodel)</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># low BW model 95% CI</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>  seR.lowBW<span class="ot">=</span><span class="fu">summary</span>(lowBW_int)<span class="sc">$</span>coef[,<span class="dv">2</span>]; (ci.lowBW <span class="ot">&lt;-</span><span class="fu">coef</span>(lowBW_int) <span class="sc">+</span> seR.lowBW <span class="sc">%o%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span>)); <span class="co">#robust</span></span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">anova</span>(lowBW_int,lowBWmodel))</span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>  <span class="co"># model differences - chi square and p-values = same as low BW models</span></span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>  results<span class="ot">=</span><span class="fu">anova</span>(hiBW_int,hiBWmodel)</span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>  chidiff<span class="ot">=</span>results<span class="sc">$</span>X2</span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>  p.value<span class="ot">=</span>results<span class="sc">$</span><span class="st">`</span><span class="at">P(&gt;|Chi|)</span><span class="st">`</span></span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>  HiBWEst<span class="ot">=</span><span class="fu">summary</span>(hiBW_int)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>];</span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>  HiBW.ci<span class="ot">=</span><span class="fu">c</span>(ci.hiBW[<span class="dv">2</span>,<span class="dv">1</span>],ci.hiBW[<span class="dv">2</span>,<span class="dv">2</span>]) </span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>  LowBWEst<span class="ot">=</span><span class="fu">summary</span>(lowBW_int)<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>  LowBW.ci<span class="ot">=</span><span class="fu">c</span>(ci.lowBW[<span class="dv">2</span>,<span class="dv">1</span>],ci.lowBW[<span class="dv">2</span>,<span class="dv">2</span>]) </span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>  VecRes<span class="ot">=</span><span class="fu">c</span>(HiBWEst, HiBW.ci, LowBWEst, LowBW.ci, chidiff, p.value)</span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>  ResultsLoop[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]<span class="ot">=</span>VecRes</span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ResultsLoop)<span class="ot">=</span>VecOutcomes_all</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ResultsLoop)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;High BW estimate&quot;</span>,<span class="st">&quot;hi BW lo.ci&quot;</span>,<span class="st">&quot;hi BW up.ci&quot;</span>,<span class="st">&quot;Low BW estimate&quot;</span>,<span class="st">&quot;low BW lo.ci&quot;</span>,<span class="st">&quot;low BW up.ci&quot;</span>,<span class="st">&quot;chidif&quot;</span>,<span class="st">&quot;p-value&quot;</span>)</span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">round</span>(ResultsLoop[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes_all),<span class="at">by=</span><span class="dv">2</span>),],<span class="dv">4</span>)</span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">as.data.frame</span>(ResultsLoop)</span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>number_models_all <span class="ot">=</span> <span class="fu">length</span>(ResultsLoop<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>)</span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="sc">$</span>pw_adjusted <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(ResultsLoop<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>, <span class="at">method =</span> <span class="st">&quot;fdr&quot;</span>, <span class="at">n =</span> number_models_all)</span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-111"><a href="#cb23-111" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb23-112"><a href="#cb23-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-113"><a href="#cb23-113" aria-hidden="true" tabindex="-1"></a>xlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(ResultsLoop,<span class="st">&quot;geeglm BW moderation effect with interaction terms - categorical.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="vlbw-exclusion" class="section level2">
<h2>VLBW exclusion</h2>
<p>As requested by reviewers, we ran a sensitivity analysis to obtain the estimates after excluding twins with very low birth weight (&lt;1500 grams). Results are in Table S9.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ==========================================================##</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="do">###### &gt;&gt;&gt;&gt;&gt;&gt;&gt; 5.0 running new analyses using less than 1500g twins (as required by reviewers) #####</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="do">## =======  ======    ========    ========    ========    ##</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, data, indices) {</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices,] <span class="co"># allows boot to select sample</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data=</span>d) <span class="co">#type of formula, but formula itself is left to the boot call, which is better as we can used this generic boostrapp</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">coef</span>(fit))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">length</span>(VecOutcomes_all),<span class="at">ncol=</span><span class="dv">9</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes_all),<span class="at">by=</span><span class="dv">2</span>))</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  adhddata2<span class="ot">=</span>adhddata</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#define outcomes</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  adhddata2[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span><span class="cn">NA</span>;</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  adhddata2[<span class="fu">c</span>(<span class="st">&quot;XD1&quot;</span>,<span class="st">&quot;XD2&quot;</span>)]<span class="ot">=</span>adhddata2[,<span class="fu">c</span>(VecOutcomes_all[i],VecOutcomes_all[i<span class="sc">+</span><span class="dv">1</span>])]</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for phenotypic estimate, inlcude opposite sex twins!</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  adhddata2c<span class="ot">=</span> adhddata2[ <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD2)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> adhddata2<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  <span class="sc">&amp;</span> (adhddata2<span class="sc">$</span>arkidgr1<span class="sc">&gt;</span><span class="dv">1500</span> <span class="sc">&amp;</span> adhddata2<span class="sc">$</span>arkidgr2<span class="sc">&gt;</span><span class="dv">1500</span>)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;5&quot;</span>),]</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>  adhddata2c[,<span class="st">&quot;arkidgr1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata2c[,<span class="st">&quot;arkidgr1&quot;</span>]);adhddata2c[,<span class="st">&quot;arkidgr2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata2c[,<span class="st">&quot;arkidgr2&quot;</span>]);</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  adhddata2c[,<span class="st">&quot;XD1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata2c[,<span class="st">&quot;XD1&quot;</span>]);adhddata2c[,<span class="st">&quot;XD2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata2c[,<span class="st">&quot;XD2&quot;</span>]) </span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select random</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  adhddata2rc<span class="ot">=</span>adhddata2c[adhddata2c<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for phenotypic estimates</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>  modelCorrelatedRegression<span class="ot">=</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;XD1~rc*arkidgr1 #regression coeff for twin 1</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="st">  XD2~rc*arkidgr2 #equal for twin 2 because twin selected at random</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="st">  arkidgr1~~pv*arkidgr1 #predictor variance, same for twin 1 and 2, produces warning in lavaan but ok and enables the standardized estimates of rv to be the same</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="st">  arkidgr2~~pv*arkidgr2 #</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="st">  XD1~~rv*XD1 #residual var for twin 1</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="st">  XD2~~rv*XD2 #same twin 2</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="st">  XD1+XD2~id*1    # intercept</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="st">  arkidgr1+arkidgr2~ia*1    # intercept</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="st">  XD1~~XD2 #correlated residual variance, try comment out to see what it does when we omit it: i.e. increase in estimate</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="st">  &#39;</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>  modelCorrelatedRegressionFit<span class="ot">=</span> <span class="fu">sem</span>(modelCorrelatedRegression, <span class="at">data=</span>adhddata2rc, <span class="at">missing=</span><span class="st">&quot;fiml&quot;</span>)</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>  Estimates<span class="ot">=</span><span class="fu">parameterEstimates</span>(modelCorrelatedRegressionFit,<span class="at">standardized=</span>T);Estimates</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>  fit.boot <span class="ot">&lt;-</span> <span class="fu">lavaan</span>(modelCorrelatedRegression, <span class="at">data =</span> adhddata2rc,<span class="at">estimator =</span><span class="st">&quot;ML&quot;</span>, <span class="at">se=</span><span class="st">&quot;boot&quot;</span>,<span class="at">bootstrap=</span><span class="dv">10000</span>)</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>   conint<span class="ot">=</span><span class="fu">parameterEstimates</span>(fit.boot,<span class="at">boot.ci.type=</span><span class="st">&quot;bca.simple&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>) <span class="co">#95% CI from a boostrapped model</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>   lower.ci<span class="ot">=</span>conint<span class="sc">$</span>ci.lower[<span class="dv">1</span>]</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>   upper.ci<span class="ot">=</span>conint<span class="sc">$</span>ci.upper[<span class="dv">1</span>]</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>  Phe_est<span class="ot">=</span>Estimates<span class="sc">$</span>est[<span class="dv">1</span>]</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select same sex twins</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>  adhddata3c<span class="ot">=</span> adhddata2[ <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>arkidgr1) <span class="sc">&amp;!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>arkidgr2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(adhddata2<span class="sc">$</span>XD2)</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> adhddata2<span class="sc">$</span>exclude<span class="sc">==</span><span class="st">&quot;0&quot;</span>  </span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">&amp;</span> (adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;1&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;2&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;3&quot;</span><span class="sc">|</span>adhddata2<span class="sc">$</span>sexzyg<span class="sc">==</span><span class="st">&quot;4&quot;</span>),]</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>  adhddata3c[,<span class="st">&quot;arkidgr1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata3c[,<span class="st">&quot;arkidgr1&quot;</span>]);adhddata3c[,<span class="st">&quot;arkidgr2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata3c[,<span class="st">&quot;arkidgr2&quot;</span>]);</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>  adhddata3c[,<span class="st">&quot;XD1&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata3c[,<span class="st">&quot;XD1&quot;</span>]);adhddata3c[,<span class="st">&quot;XD2&quot;</span>]<span class="ot">=</span><span class="fu">scale</span>(adhddata3c[,<span class="st">&quot;XD2&quot;</span>])</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select random</span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>  adhddata3rc<span class="ot">=</span>adhddata3c[adhddata3c<span class="sc">$</span>random<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>  <span class="co">#simple differences</span></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>  adhddata3rc<span class="sc">$</span>BWdif<span class="ot">=</span><span class="cn">NA</span>;adhddata3rc<span class="sc">$</span>BWdif<span class="ot">=</span>adhddata3rc<span class="sc">$</span>arkidgr1<span class="sc">-</span>adhddata3rc<span class="sc">$</span>arkidgr2 </span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>  adhddata3rc<span class="sc">$</span>XDdif<span class="ot">=</span><span class="cn">NA</span>;adhddata3rc<span class="sc">$</span>XDdif<span class="ot">=</span>adhddata3rc<span class="sc">$</span>XD1<span class="sc">-</span>adhddata3rc<span class="sc">$</span>XD2</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>  <span class="co">#DZ</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for DZ estimates OLS through origin</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>  modelWIDZ<span class="ot">=</span><span class="fu">lm</span>(XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif,<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;DZ&quot;</span>,]) </span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>  <span class="co">#MZ</span></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for MZ estimates, OLS through origin</span></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>  modelWIMZ<span class="ot">=</span><span class="fu">lm</span>(XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif,<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,]) </span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>  <span class="co">#bootstrapping with 10000 replications (even with 10000 replications there is still some variation in the results, so maybe worth doing more if very close to 0)</span></span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>  resultsMZ <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;MZ&quot;</span>,], <span class="at">statistic=</span>bs,<span class="at">R=</span><span class="dv">10000</span>, <span class="at">formula=</span>XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif) <span class="co">#if the number of repetition is too small, i.e. 1000, might fail</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>  (<span class="at">CIresMZ=</span><span class="fu">boot.ci</span>(resultsMZ, <span class="at">type=</span><span class="st">&quot;bca&quot;</span>, <span class="at">index=</span><span class="dv">1</span>)) <span class="co"># bias corrected CI, index is 1 because there is no intercept so first coeff is the regression coef</span></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>  CIMZ<span class="ot">=</span>CIresMZ<span class="sc">$</span>bca[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)]</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>  resultsDZ <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>adhddata3rc[adhddata3rc<span class="sc">$</span>zygosL<span class="sc">==</span><span class="st">&quot;DZ&quot;</span>,], <span class="at">statistic=</span>bs,<span class="at">R=</span><span class="dv">10000</span>, <span class="at">formula=</span>XDdif<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>BWdif) <span class="co">#if the number of repetition is too small, i.e. 1000, might fail</span></span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>  (<span class="at">CIresDZ=</span><span class="fu">boot.ci</span>(resultsDZ, <span class="at">type=</span><span class="st">&quot;bca&quot;</span>, <span class="at">index=</span><span class="dv">1</span>)) <span class="co"># bias corrected CI, index is 1 because there is no intercept so first coeff is the regression coef</span></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>  CIDZ<span class="ot">=</span>CIresDZ<span class="sc">$</span>bca[,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)]</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>  VecRes<span class="ot">=</span><span class="fu">c</span>(Phe_est, lower.ci, upper.ci, <span class="fu">coef</span>(modelWIDZ),CIDZ,<span class="fu">coef</span>(modelWIMZ),CIMZ)</span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>  ResultsLoop[i,<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]<span class="ot">=</span>VecRes</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ResultsLoop)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;PheEst&quot;</span>,<span class="st">&quot;Plow.ci&quot;</span>,<span class="st">&quot;Pup.ci&quot;</span>,<span class="st">&quot;DZest&quot;</span>,<span class="st">&quot;DZlow.ci&quot;</span>,<span class="st">&quot;DZup.ci&quot;</span>,<span class="st">&quot;MZest&quot;</span>,<span class="st">&quot;MZlow.ci&quot;</span>,<span class="st">&quot;MZup.ci&quot;</span>)</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ResultsLoop)<span class="ot">=</span>VecOutcomes_all</span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>ResultsLoop<span class="ot">=</span><span class="fu">round</span>(ResultsLoop[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="fu">length</span>(VecOutcomes_all),<span class="at">by=</span><span class="dv">2</span>),],<span class="dv">4</span>)</span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>ResultsLoop</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>xlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(ResultsLoop,<span class="st">&quot;less than 1500g twins excluded no bootstraping.xlsx&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
